$.fn.countdown=function(b){$.fn.countdown.defaultVal={eAttr:"data-etime",sAttr:"data-stime",sysTime:new Date().getTime(),wTime:500,stpl:"%H%:%M%:%S%",etpl:"%H%:%M%:%S%",otpl:"已结束",callback:function(){}};var e=$.extend({},$.fn.countdown.defaultVal,b),d=$(this),c=e.sysTime;var a=function(f){c+=f?f:0;d.each(function(){var h=$(this),m=1,g=parseInt(h.attr(e.sAttr)),k=parseInt(h.attr(e.eAttr)),j=isNaN(g)?0:g-c,l=isNaN(k)?0:k-c;var i=function(n,r){var q=Math.round((n%60000)/e.wTime);q=dateNum(Math.min(Math.floor(q/1000*e.wTime),59));var o=dateNum(Math.floor((n%3600000)/60000));var p=dateNum(Math.floor((n%86400000)/3600000));var s=dateNum(Math.floor(n/86400000));h.html(r.replace(/%S%/,q).replace(/%M%/,o).replace(/%H%/,p).replace(/%D%/,s))};if(j>0){m=1;i(j,e.stpl)}else{if(l>0){m=2;i(l,e.etpl)}else{m=3;h.html(e.otpl)}}e.callback&&e.callback(m)})};a();setInterval(function(){a(e.wTime)},e.wTime)};