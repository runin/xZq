/**
 * @license
 * pixi.js - v2.1.0
 * Copyright (c) 2012-2014, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2014-12-23
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(){var b=this;var g=g||{};g.WEBGL_RENDERER=0;g.CANVAS_RENDERER=1;g.VERSION="v2.1.0";g.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16};g.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1};g._UID=0;if(typeof(Float32Array)!="undefined"){g.Float32Array=Float32Array;g.Uint16Array=Uint16Array}else{g.Float32Array=Array;g.Uint16Array=Array}g.INTERACTION_FREQUENCY=30;g.AUTO_PREVENT_DEFAULT=true;g.PI_2=Math.PI*2;g.RAD_TO_DEG=180/Math.PI;g.DEG_TO_RAD=Math.PI/180;g.RETINA_PREFIX="@2x";g.dontSayHello=false;g.defaultRenderOptions={view:null,transparent:false,antialias:false,preserveDrawingBuffer:false,resolution:1,clearBeforeRender:true,autoResize:false};g.sayHello=function(i){if(g.dontSayHello){return}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var h=["%c %c %c Pixi.js "+g.VERSION+" - "+i+"  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,h)}else{if(window.console){console.log("Pixi.js "+g.VERSION+" - http://www.pixijs.com/")}}g.dontSayHello=true};g.Point=function(h,i){this.x=h||0;this.y=i||0};g.Point.prototype.clone=function(){return new g.Point(this.x,this.y)};g.Point.prototype.set=function(h,i){this.x=h||0;this.y=i||((i!==0)?this.x:0)};g.Point.prototype.constructor=g.Point;g.Rectangle=function(i,k,j,h){this.x=i||0;this.y=k||0;this.width=j||0;this.height=h||0};g.Rectangle.prototype.clone=function(){return new g.Rectangle(this.x,this.y,this.width,this.height)};g.Rectangle.prototype.contains=function(h,k){if(this.width<=0||this.height<=0){return false}var i=this.x;if(h>=i&&h<=i+this.width){var j=this.y;if(k>=j&&k<=j+this.height){return true}}return false};g.Rectangle.prototype.constructor=g.Rectangle;g.EmptyRectangle=new g.Rectangle(0,0,0,0);g.Polygon=function(k){if(!(k instanceof Array)){k=Array.prototype.slice.call(arguments)}if(k[0] instanceof g.Point){var l=[];for(var j=0,h=k.length;j<h;j++){l.push(k[j].x,k[j].y)}k=l}this.closed=true;this.points=k};g.Polygon.prototype.clone=function(){var h=this.points.slice();return new g.Polygon(h)};g.Polygon.prototype.contains=function(t,s){var m=false;var h=this.points.length/2;for(var p=0,o=h-1;p<h;o=p++){var r=this.points[p*2],n=this.points[p*2+1],q=this.points[o*2],l=this.points[o*2+1],k=((n>s)!==(l>s))&&(t<(q-r)*(s-n)/(l-n)+r);if(k){m=!m}}return m};g.Polygon.prototype.constructor=g.Polygon;g.Circle=function(i,j,h){this.x=i||0;this.y=j||0;this.radius=h||0};g.Circle.prototype.clone=function(){return new g.Circle(this.x,this.y,this.radius)};g.Circle.prototype.contains=function(h,l){if(this.radius<=0){return false}var k=(this.x-h),j=(this.y-l),i=this.radius*this.radius;k*=k;j*=j;return(k+j<=i)};g.Circle.prototype.getBounds=function(){return new g.Rectangle(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)};g.Circle.prototype.constructor=g.Circle;g.Ellipse=function(i,k,j,h){this.x=i||0;this.y=k||0;this.width=j||0;this.height=h||0};g.Ellipse.prototype.clone=function(){return new g.Ellipse(this.x,this.y,this.width,this.height)};g.Ellipse.prototype.contains=function(i,k){if(this.width<=0||this.height<=0){return false}var j=((i-this.x)/this.width),h=((k-this.y)/this.height);j*=j;h*=h;return(j+h<=1)};g.Ellipse.prototype.getBounds=function(){return new g.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)};g.Ellipse.prototype.constructor=g.Ellipse;g.RoundedRectangle=function(j,l,k,i,h){this.x=j||0;this.y=l||0;this.width=k||0;this.height=i||0;this.radius=h||20};g.RoundedRectangle.prototype.clone=function(){return new g.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)};g.RoundedRectangle.prototype.contains=function(h,k){if(this.width<=0||this.height<=0){return false}var i=this.x;if(h>=i&&h<=i+this.width){var j=this.y;if(k>=j&&k<=j+this.height){return true}}return false};g.RoundedRectangle.prototype.constructor=g.RoundedRectangle;g.Matrix=function(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0};g.Matrix.prototype.fromArray=function(h){this.a=h[0];this.b=h[1];this.c=h[3];this.d=h[4];this.tx=h[2];this.ty=h[5]};g.Matrix.prototype.toArray=function(h){if(!this.array){this.array=new g.Float32Array(9)}var i=this.array;if(h){i[0]=this.a;i[1]=this.b;i[2]=0;i[3]=this.c;i[4]=this.d;i[5]=0;i[6]=this.tx;i[7]=this.ty;i[8]=1}else{i[0]=this.a;i[1]=this.c;i[2]=this.tx;i[3]=this.b;i[4]=this.d;i[5]=this.ty;i[6]=0;i[7]=0;i[8]=1}return i};g.Matrix.prototype.apply=function(i,h){h=h||new g.Point();h.x=this.a*i.x+this.c*i.y+this.tx;h.y=this.b*i.x+this.d*i.y+this.ty;return h};g.Matrix.prototype.applyInverse=function(j,h){h=h||new g.Point();var i=1/(this.a*this.d+this.c*-this.b);h.x=this.d*i*j.x+-this.c*i*j.y+(this.ty*this.c-this.tx*this.d)*i;h.y=this.a*i*j.y+-this.b*i*j.x+(-this.ty*this.a+this.tx*this.b)*i;return h};g.Matrix.prototype.translate=function(h,i){this.tx+=h;this.ty+=i;return this};g.Matrix.prototype.scale=function(h,i){this.a*=h;this.d*=i;this.c*=h;this.b*=i;this.tx*=h;this.ty*=i;return this};g.Matrix.prototype.rotate=function(m){var l=Math.cos(m);var j=Math.sin(m);var i=this.a;var k=this.c;var h=this.tx;this.a=i*l-this.b*j;this.b=i*j+this.b*l;this.c=k*l-this.d*j;this.d=k*j+this.d*l;this.tx=h*l-this.ty*j;this.ty=h*j+this.ty*l;return this};g.Matrix.prototype.append=function(i){var h=this.a;var j=this.b;var k=this.c;var l=this.d;this.a=i.a*h+i.b*k;this.b=i.a*j+i.b*l;this.c=i.c*h+i.d*k;this.d=i.c*j+i.d*l;this.tx=i.tx*h+i.ty*k+this.tx;this.ty=i.tx*j+i.ty*l+this.ty;return this};g.Matrix.prototype.identity=function(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;return this};g.identityMatrix=new g.Matrix();g.DisplayObject=function(){this.position=new g.Point();this.scale=new g.Point(1,1);this.pivot=new g.Point(0,0);this.rotation=0;this.alpha=1;this.visible=true;this.hitArea=null;this.buttonMode=false;this.renderable=false;this.parent=null;this.stage=null;this.worldAlpha=1;this._interactive=false;this.defaultCursor="pointer";this.worldTransform=new g.Matrix();this._sr=0;this._cr=1;this.filterArea=null;this._bounds=new g.Rectangle(0,0,1,1);this._currentBounds=null;this._mask=null;this._cacheAsBitmap=false;this._cacheIsDirty=false};g.DisplayObject.prototype.constructor=g.DisplayObject;Object.defineProperty(g.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(h){this._interactive=h;if(this.stage){this.stage.dirty=true}}});Object.defineProperty(g.DisplayObject.prototype,"worldVisible",{get:function(){var h=this;do{if(!h.visible){return false}h=h.parent}while(h);return true}});Object.defineProperty(g.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(h){if(this._mask){this._mask.isMask=false}this._mask=h;if(this._mask){this._mask.isMask=true}}});Object.defineProperty(g.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(m){if(m){var l=[];for(var k=0;k<m.length;k++){var n=m[k].passes;for(var h=0;h<n.length;h++){l.push(n[h])}}this._filterBlock={target:this,filterPasses:l}}this._filters=m}});Object.defineProperty(g.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(h){if(this._cacheAsBitmap===h){return}if(h){this._generateCachedSprite()}else{this._destroyCachedSprite()}this._cacheAsBitmap=h}});g.DisplayObject.prototype.updateTransform=function(){var m=this.parent.worldTransform;var j=this.worldTransform;var l,i,o,n,k,h;if(this.rotation%g.PI_2){if(this.rotation!==this.rotationCache){this.rotationCache=this.rotation;this._sr=Math.sin(this.rotation);this._cr=Math.cos(this.rotation)}l=this._cr*this.scale.x;i=this._sr*this.scale.x;o=-this._sr*this.scale.y;n=this._cr*this.scale.y;k=this.position.x;h=this.position.y;if(this.pivot.x||this.pivot.y){k-=this.pivot.x*l+this.pivot.y*o;h-=this.pivot.x*i+this.pivot.y*n}j.a=l*m.a+i*m.c;j.b=l*m.b+i*m.d;j.c=o*m.a+n*m.c;j.d=o*m.b+n*m.d;j.tx=k*m.a+h*m.c+m.tx;j.ty=k*m.b+h*m.d+m.ty}else{l=this.scale.x;n=this.scale.y;k=this.position.x-this.pivot.x*l;h=this.position.y-this.pivot.y*n;j.a=l*m.a;j.b=l*m.b;j.c=n*m.c;j.d=n*m.d;j.tx=k*m.a+h*m.c+m.tx;j.ty=k*m.b+h*m.d+m.ty}this.worldAlpha=this.alpha*this.parent.worldAlpha};g.DisplayObject.prototype.displayObjectUpdateTransform=g.DisplayObject.prototype.updateTransform;g.DisplayObject.prototype.getBounds=function(h){h=h;return g.EmptyRectangle};g.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(g.identityMatrix)};g.DisplayObject.prototype.setStageReference=function(h){this.stage=h;if(this._interactive){this.stage.dirty=true}};g.DisplayObject.prototype.generateTexture=function(i,j,l){var k=this.getLocalBounds();var h=new g.RenderTexture(k.width|0,k.height|0,l,j,i);g.DisplayObject._tempMatrix.tx=-k.x;g.DisplayObject._tempMatrix.ty=-k.y;h.render(this,g.DisplayObject._tempMatrix);return h};g.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()};g.DisplayObject.prototype.toGlobal=function(h){this.updateTransform();return this.worldTransform.apply(h)};g.DisplayObject.prototype.toLocal=function(h,i){if(i){h=i.toGlobal(h)}this.updateTransform();return this.worldTransform.applyInverse(h)};g.DisplayObject.prototype._renderCachedSprite=function(h){this._cachedSprite.worldAlpha=this.worldAlpha;if(h.gl){g.Sprite.prototype._renderWebGL.call(this._cachedSprite,h)}else{g.Sprite.prototype._renderCanvas.call(this._cachedSprite,h)}};g.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=false;var j=this.getLocalBounds();if(!this._cachedSprite){var h=new g.RenderTexture(j.width|0,j.height|0);this._cachedSprite=new g.Sprite(h);this._cachedSprite.worldTransform=this.worldTransform}else{this._cachedSprite.texture.resize(j.width|0,j.height|0)}var i=this._filters;this._filters=null;this._cachedSprite.filters=i;g.DisplayObject._tempMatrix.tx=-j.x;g.DisplayObject._tempMatrix.ty=-j.y;this._cachedSprite.texture.render(this,g.DisplayObject._tempMatrix);this._cachedSprite.anchor.x=-(j.x/j.width);this._cachedSprite.anchor.y=-(j.y/j.height);this._filters=i;this._cacheAsBitmap=true};g.DisplayObject.prototype._destroyCachedSprite=function(){if(!this._cachedSprite){return}this._cachedSprite.texture.destroy(true);this._cachedSprite=null};g.DisplayObject.prototype._renderWebGL=function(h){h=h};g.DisplayObject.prototype._renderCanvas=function(h){h=h};g.DisplayObject._tempMatrix=new g.Matrix();Object.defineProperty(g.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(h){this.position.x=h}});Object.defineProperty(g.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(h){this.position.y=h}});g.DisplayObjectContainer=function(){g.DisplayObject.call(this);this.children=[]};g.DisplayObjectContainer.prototype=Object.create(g.DisplayObject.prototype);g.DisplayObjectContainer.prototype.constructor=g.DisplayObjectContainer;Object.defineProperty(g.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(i){var h=this.getLocalBounds().width;if(h!==0){this.scale.x=i/h}else{this.scale.x=1}this._width=i}});Object.defineProperty(g.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(i){var h=this.getLocalBounds().height;if(h!==0){this.scale.y=i/h}else{this.scale.y=1}this._height=i}});g.DisplayObjectContainer.prototype.addChild=function(h){return this.addChildAt(h,this.children.length)};g.DisplayObjectContainer.prototype.addChildAt=function(i,h){if(h>=0&&h<=this.children.length){if(i.parent){i.parent.removeChild(i)}i.parent=this;this.children.splice(h,0,i);if(this.stage){i.setStageReference(this.stage)}return i}else{throw new Error(i+"addChildAt: The index "+h+" supplied is out of bounds "+this.children.length)}};g.DisplayObjectContainer.prototype.swapChildren=function(k,h){if(k===h){return}var j=this.getChildIndex(k);var i=this.getChildIndex(h);if(j<0||i<0){throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.")}this.children[j]=h;this.children[i]=k};g.DisplayObjectContainer.prototype.getChildIndex=function(i){var h=this.children.indexOf(i);if(h===-1){throw new Error("The supplied DisplayObject must be a child of the caller")}return h};g.DisplayObjectContainer.prototype.setChildIndex=function(j,i){if(i<0||i>=this.children.length){throw new Error("The supplied index is out of bounds")}var h=this.getChildIndex(j);this.children.splice(h,1);this.children.splice(i,0,j)};g.DisplayObjectContainer.prototype.getChildAt=function(h){if(h<0||h>=this.children.length){throw new Error("getChildAt: Supplied index "+h+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller")}return this.children[h]};g.DisplayObjectContainer.prototype.removeChild=function(i){var h=this.children.indexOf(i);if(h===-1){return}return this.removeChildAt(h)};g.DisplayObjectContainer.prototype.removeChildAt=function(h){var i=this.getChildAt(h);if(this.stage){i.removeStageReference()}i.parent=undefined;this.children.splice(h,1);return i};g.DisplayObjectContainer.prototype.removeChildren=function(m,n){var l=m||0;var h=typeof n==="number"?n:this.children.length;var j=h-l;if(j>0&&j<=h){var o=this.children.splice(l,j);for(var k=0;k<o.length;k++){var p=o[k];if(this.stage){p.removeStageReference()}p.parent=undefined}return o}else{if(j===0&&this.children.length===0){return[]}else{throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")}}};g.DisplayObjectContainer.prototype.updateTransform=function(){if(!this.visible){return}this.displayObjectUpdateTransform();if(this._cacheAsBitmap){return}for(var k=0,h=this.children.length;k<h;k++){this.children[k].updateTransform()}};g.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=g.DisplayObjectContainer.prototype.updateTransform;g.DisplayObjectContainer.prototype.getBounds=function(){if(this.children.length===0){return g.EmptyRectangle}var p=Infinity;var o=Infinity;var l=-Infinity;var k=-Infinity;var q;var u;var t;var m=false;for(var s=0,r=this.children.length;s<r;s++){var n=this.children[s];if(!n.visible){continue}m=true;q=this.children[s].getBounds();p=p<q.x?p:q.x;o=o<q.y?o:q.y;u=q.width+q.x;t=q.height+q.y;l=l>u?l:u;k=k>t?k:t}if(!m){return g.EmptyRectangle}var h=this._bounds;h.x=p;h.y=o;h.width=l-p;h.height=k-o;return h};g.DisplayObjectContainer.prototype.getLocalBounds=function(){var h=this.worldTransform;this.worldTransform=g.identityMatrix;for(var l=0,k=this.children.length;l<k;l++){this.children[l].updateTransform()}var m=this.getBounds();this.worldTransform=h;return m};g.DisplayObjectContainer.prototype.setStageReference=function(k){this.stage=k;if(this._interactive){this.stage.dirty=true}for(var l=0,h=this.children.length;l<h;l++){var m=this.children[l];m.setStageReference(k)}};g.DisplayObjectContainer.prototype.removeStageReference=function(){for(var k=0,h=this.children.length;k<h;k++){var l=this.children[k];l.removeStageReference()}if(this._interactive){this.stage.dirty=true}this.stage=null};g.DisplayObjectContainer.prototype._renderWebGL=function(l){if(!this.visible||this.alpha<=0){return}if(this._cacheAsBitmap){this._renderCachedSprite(l);return}var k,h;if(this._mask||this._filters){if(this._filters){l.spriteBatch.flush();l.filterManager.pushFilter(this._filterBlock)}if(this._mask){l.spriteBatch.stop();l.maskManager.pushMask(this.mask,l);l.spriteBatch.start()}for(k=0,h=this.children.length;k<h;k++){this.children[k]._renderWebGL(l)}l.spriteBatch.stop();if(this._mask){l.maskManager.popMask(this._mask,l)}if(this._filters){l.filterManager.popFilter()}l.spriteBatch.start()}else{for(k=0,h=this.children.length;k<h;k++){this.children[k]._renderWebGL(l)}}};g.DisplayObjectContainer.prototype._renderCanvas=function(l){if(this.visible===false||this.alpha===0){return}if(this._cacheAsBitmap){this._renderCachedSprite(l);return}if(this._mask){l.maskManager.pushMask(this._mask,l)}for(var k=0,h=this.children.length;k<h;k++){var m=this.children[k];m._renderCanvas(l)}if(this._mask){l.maskManager.popMask(l)}};g.Sprite=function(h){g.DisplayObjectContainer.call(this);this.anchor=new g.Point();this.texture=h;this._width=0;this._height=0;this.tint=16777215;this.blendMode=g.blendModes.NORMAL;this.shader=null;if(h.baseTexture.hasLoaded){this.onTextureUpdate()}else{this.texture.on("update",this.onTextureUpdate.bind(this))}this.renderable=true};g.Sprite.prototype=Object.create(g.DisplayObjectContainer.prototype);g.Sprite.prototype.constructor=g.Sprite;Object.defineProperty(g.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(h){this.scale.x=h/this.texture.frame.width;this._width=h}});Object.defineProperty(g.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(h){this.scale.y=h/this.texture.frame.height;this._height=h}});g.Sprite.prototype.setTexture=function(h){this.texture=h;this.cachedTint=16777215};g.Sprite.prototype.onTextureUpdate=function(){if(this._width){this.scale.x=this._width/this.texture.frame.width}if(this._height){this.scale.y=this._height/this.texture.frame.height}};g.Sprite.prototype.getBounds=function(u){var r=this.texture.frame.width;var q=this.texture.frame.height;var p=r*(1-this.anchor.x);var o=r*-this.anchor.x;var n=q*(1-this.anchor.y);var m=q*-this.anchor.y;var s=u||this.worldTransform;var G=s.a;var E=s.b;var D=s.c;var B=s.d;var H=s.tx;var F=s.ty;var x=G*o+D*m+H;var k=B*m+E*o+F;var w=G*p+D*m+H;var j=B*m+E*p+F;var v=G*p+D*n+H;var i=B*n+E*p+F;var t=G*o+D*n+H;var h=B*n+E*o+F;var A=-Infinity;var y=-Infinity;var C=Infinity;var z=Infinity;C=x<C?x:C;C=w<C?w:C;C=v<C?v:C;C=t<C?t:C;z=k<z?k:z;z=j<z?j:z;z=i<z?i:z;z=h<z?h:z;A=x>A?x:A;A=w>A?w:A;A=v>A?v:A;A=t>A?t:A;y=k>y?k:y;y=j>y?j:y;y=i>y?i:y;y=h>y?h:y;var l=this._bounds;l.x=C;l.width=A-C;l.y=z;l.height=y-z;this._currentBounds=l;return l};g.Sprite.prototype._renderWebGL=function(m){if(!this.visible||this.alpha<=0){return}var l,k;if(this._mask||this._filters){var h=m.spriteBatch;if(this._filters){h.flush();m.filterManager.pushFilter(this._filterBlock)}if(this._mask){h.stop();m.maskManager.pushMask(this.mask,m);h.start()}h.render(this);for(l=0,k=this.children.length;l<k;l++){this.children[l]._renderWebGL(m)}h.stop();if(this._mask){m.maskManager.popMask(this._mask,m)}if(this._filters){m.filterManager.popFilter()}h.start()}else{m.spriteBatch.render(this);for(l=0,k=this.children.length;l<k;l++){this.children[l]._renderWebGL(m)}}};g.Sprite.prototype._renderCanvas=function(o){if(this.visible===false||this.alpha===0||this.texture.crop.width<=0||this.texture.crop.height<=0){return}if(this.blendMode!==o.currentBlendMode){o.currentBlendMode=this.blendMode;o.context.globalCompositeOperation=g.blendModesCanvas[o.currentBlendMode]}if(this._mask){o.maskManager.pushMask(this._mask,o)}if(this.texture.valid){var m=this.texture.baseTexture.resolution/o.resolution;o.context.globalAlpha=this.worldAlpha;if(o.roundPixels){o.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,(this.worldTransform.tx*o.resolution)|0,(this.worldTransform.ty*o.resolution)|0)}else{o.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*o.resolution,this.worldTransform.ty*o.resolution)}if(o.smoothProperty&&o.scaleMode!==this.texture.baseTexture.scaleMode){o.scaleMode=this.texture.baseTexture.scaleMode;o.context[o.smoothProperty]=(o.scaleMode===g.scaleModes.LINEAR)}var k=(this.texture.trim)?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width;var h=(this.texture.trim)?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;if(this.tint!==16777215){if(this.cachedTint!==this.tint){this.cachedTint=this.tint;this.tintedTexture=g.CanvasTinter.getTintedTexture(this,this.tint)}o.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,k/m,h/m,this.texture.crop.width/m,this.texture.crop.height/m)}else{o.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,k/m,h/m,this.texture.crop.width/m,this.texture.crop.height/m)}}for(var n=0,l=this.children.length;n<l;n++){this.children[n]._renderCanvas(o)}if(this._mask){o.maskManager.popMask(o)}};g.Sprite.fromFrame=function(i){var h=g.TextureCache[i];if(!h){throw new Error('The frameId "'+i+'" does not exist in the texture cache'+this)}return new g.Sprite(h)};g.Sprite.fromImage=function(i,h,j){var k=g.Texture.fromImage(i,h,j);return new g.Sprite(k)};g.SpriteBatch=function(h){g.DisplayObjectContainer.call(this);this.textureThing=h;this.ready=false};g.SpriteBatch.prototype=Object.create(g.DisplayObjectContainer.prototype);g.SpriteBatch.prototype.constructor=g.SpriteBatch;g.SpriteBatch.prototype.initWebGL=function(h){this.fastSpriteBatch=new g.WebGLFastSpriteBatch(h);this.ready=true};g.SpriteBatch.prototype.updateTransform=function(){g.DisplayObject.prototype.updateTransform.call(this)};g.SpriteBatch.prototype._renderWebGL=function(h){if(!this.visible||this.alpha<=0||!this.children.length){return}if(!this.ready){this.initWebGL(h.gl)}h.spriteBatch.stop();h.shaderManager.setShader(h.shaderManager.fastShader);this.fastSpriteBatch.begin(this,h);this.fastSpriteBatch.render(this);h.spriteBatch.start()};g.SpriteBatch.prototype._renderCanvas=function(q){if(!this.visible||this.alpha<=0||!this.children.length){return}var h=q.context;h.globalAlpha=this.worldAlpha;g.DisplayObject.prototype.updateTransform.call(this);var l=this.worldTransform;var p=true;for(var m=0;m<this.children.length;m++){var j=this.children[m];if(!j.visible){continue}var o=j.texture;var k=o.frame;h.globalAlpha=this.worldAlpha*j.alpha;if(j.rotation%(Math.PI*2)===0){if(p){h.setTransform(l.a,l.b,l.c,l.d,l.tx,l.ty);p=false}h.drawImage(o.baseTexture.source,k.x,k.y,k.width,k.height,((j.anchor.x)*(-k.width*j.scale.x)+j.position.x+0.5)|0,((j.anchor.y)*(-k.height*j.scale.y)+j.position.y+0.5)|0,k.width*j.scale.x,k.height*j.scale.y)}else{if(!p){p=true}g.DisplayObject.prototype.updateTransform.call(j);var n=j.worldTransform;if(q.roundPixels){h.setTransform(n.a,n.b,n.c,n.d,n.tx|0,n.ty|0)}else{h.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty)}h.drawImage(o.baseTexture.source,k.x,k.y,k.width,k.height,((j.anchor.x)*(-k.width)+0.5)|0,((j.anchor.y)*(-k.height)+0.5)|0,k.width,k.height)}}};g.MovieClip=function(h){g.Sprite.call(this,h[0]);this.textures=h;this.animationSpeed=1;this.loop=true;this.onComplete=null;this.currentFrame=0;this.playing=false};g.MovieClip.prototype=Object.create(g.Sprite.prototype);g.MovieClip.prototype.constructor=g.MovieClip;Object.defineProperty(g.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}});g.MovieClip.prototype.stop=function(){this.playing=false};g.MovieClip.prototype.play=function(){this.playing=true};g.MovieClip.prototype.gotoAndStop=function(i){this.playing=false;this.currentFrame=i;var h=(this.currentFrame+0.5)|0;this.setTexture(this.textures[h%this.textures.length])};g.MovieClip.prototype.gotoAndPlay=function(h){this.currentFrame=h;this.playing=true};g.MovieClip.prototype.updateTransform=function(){g.Sprite.prototype.updateTransform.call(this);if(!this.playing){return}this.currentFrame+=this.animationSpeed;var h=(this.currentFrame+0.5)|0;this.currentFrame=this.currentFrame%this.textures.length;if(this.loop||h<this.textures.length){this.setTexture(this.textures[h%this.textures.length])}else{if(h>=this.textures.length){this.gotoAndStop(this.textures.length-1);if(this.onComplete){this.onComplete()}}}};g.MovieClip.fromFrames=function(k){var h=[];for(var j=0;j<k.length;j++){h.push(new g.Texture.fromFrame(k[j]))}return new g.MovieClip(h)};g.MovieClip.fromImages=function(j){var h=[];for(var k=0;k<j.length;k++){h.push(new g.Texture.fromImage(j[k]))}return new g.MovieClip(h)};g.FilterBlock=function(){this.visible=true;this.renderable=true};g.FilterBlock.prototype.constructor=g.FilterBlock;g.Text=function(i,h){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=1;g.Sprite.call(this,g.Texture.fromCanvas(this.canvas));this.setText(i);this.setStyle(h)};g.Text.prototype=Object.create(g.Sprite.prototype);g.Text.prototype.constructor=g.Text;Object.defineProperty(g.Text.prototype,"width",{get:function(){if(this.dirty){this.updateText();this.dirty=false}return this.scale.x*this.texture.frame.width},set:function(h){this.scale.x=h/this.texture.frame.width;this._width=h}});Object.defineProperty(g.Text.prototype,"height",{get:function(){if(this.dirty){this.updateText();this.dirty=false}return this.scale.y*this.texture.frame.height},set:function(h){this.scale.y=h/this.texture.frame.height;this._height=h}});g.Text.prototype.setStyle=function(h){h=h||{};h.font=h.font||"bold 20pt Arial";h.fill=h.fill||"black";h.lineHeight=h.lineHeight||0;h.align=h.align||"left";h.stroke=h.stroke||"black";h.strokeThickness=h.strokeThickness||0;h.wordWrap=h.wordWrap||false;h.wordWrapWidth=h.wordWrapWidth||100;h.dropShadow=h.dropShadow||false;h.dropShadowAngle=h.dropShadowAngle||Math.PI/6;h.dropShadowDistance=h.dropShadowDistance||4;h.dropShadowColor=h.dropShadowColor||"black";this.style=h;this.dirty=true};g.Text.prototype.setText=function(h){this.text=h.toString()||" ";this.dirty=true};g.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution;this.context.font=this.style.font;var o=this.text;if(this.style.wordWrap){o=this.wordWrap(this.text)}var u=o.split(/(?:\r\n|\r|\n)/);var n=[];var v=0;var k=this.determineFontProperties(this.style.font);for(var p=0;p<u.length;p++){var q=this.context.measureText(u[p]).width;n[p]=q;v=Math.max(v,q)}var l=v+this.style.strokeThickness;if(this.style.dropShadow){l+=this.style.dropShadowDistance}this.canvas.width=(l+this.context.lineWidth)*this.resolution;var s=k.fontSize+this.style.strokeThickness+this.style.lineHeight;var t=s*u.length+15;if(this.style.dropShadow){t+=this.style.dropShadowDistance}this.canvas.height=t*this.resolution;this.context.scale(this.resolution,this.resolution);if(navigator.isCocoonJS){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.lineWidth=this.style.strokeThickness;this.context.textBaseline="middle";var m;var j;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var r=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance;var h=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(p=0;p<u.length;p++){m=this.style.strokeThickness/2;j=(this.style.strokeThickness/2+p*s)+k.ascent;if(this.style.align==="right"){m+=v-n[p]}else{if(this.style.align==="center"){m+=(v-n[p])/2}}if(this.style.fill){this.context.fillText(u[p],m+r,j+h)}}}this.context.fillStyle=this.style.fill;for(p=0;p<u.length;p++){m=this.style.strokeThickness/2;j=(this.style.strokeThickness/2+p*s)+k.ascent;if(this.style.align==="right"){m+=v-n[p]}else{if(this.style.align==="center"){m+=(v-n[p])/2}}if(this.style.stroke&&this.style.strokeThickness){this.context.strokeText(u[p],m,j)}if(this.style.fill){this.context.fillText(u[p],m,j)}}this.updateTexture()};g.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width;this.texture.baseTexture.height=this.canvas.height;this.texture.crop.width=this.texture.frame.width=this.canvas.width;this.texture.crop.height=this.texture.frame.height=this.canvas.height;this._width=this.canvas.width;this._height=this.canvas.height;this.texture.baseTexture.dirty()};g.Text.prototype._renderWebGL=function(h){if(this.dirty){this.resolution=h.resolution;this.updateText();this.dirty=false}g.Sprite.prototype._renderWebGL.call(this,h)};g.Text.prototype._renderCanvas=function(h){if(this.dirty){this.resolution=h.resolution;this.updateText();this.dirty=false}g.Sprite.prototype._renderCanvas.call(this,h)};g.Text.prototype.determineFontProperties=function(o){var r=g.Text.fontPropertiesCache[o];if(!r){r={};var l=g.Text.fontPropertiesCanvas;var k=g.Text.fontPropertiesContext;k.font=o;var h=Math.ceil(k.measureText("|Mq").width);var q=Math.ceil(k.measureText("M").width);var v=2*q;q=q*1.4|0;l.width=h;l.height=v;k.fillStyle="#f00";k.fillRect(0,0,h,v);k.font=o;k.textBaseline="alphabetic";k.fillStyle="#000";k.fillText("|Mq",0,q);var s=k.getImageData(0,0,h,v).data;var m=s.length;var w=h*4;var p,n;var u=0;var t=false;for(p=0;p<q;p++){for(n=0;n<w;n+=4){if(s[u+n]!==255){t=true;break}}if(!t){u+=w}else{break}}r.ascent=q-p;u=m-w;t=false;for(p=v;p>q;p--){for(n=0;n<w;n+=4){if(s[u+n]!==255){t=true;break}}if(!t){u-=w}else{break}}r.descent=p-q;r.fontSize=r.ascent+r.descent;g.Text.fontPropertiesCache[o]=r}return r};g.Text.prototype.wordWrap=function(o){var r="";var q=o.split("\n");for(var l=0;l<q.length;l++){var k=this.style.wordWrapWidth;var n=q[l].split(" ");for(var h=0;h<n.length;h++){var p=this.context.measureText(n[h]).width;var m=p+this.context.measureText(" ").width;if(h===0||m>k){if(h>0){r+="\n"}r+=n[h];k=this.style.wordWrapWidth-p}else{k-=m;r+=" "+n[h]}}if(l<q.length-1){r+="\n"}}return r};g.Text.prototype.getBounds=function(h){if(this.dirty){this.updateText();this.dirty=false}return g.Sprite.prototype.getBounds.call(this,h)};g.Text.prototype.destroy=function(h){this.context=null;this.canvas=null;this.texture.destroy(h===undefined?true:h)};g.Text.fontPropertiesCache={};g.Text.fontPropertiesCanvas=document.createElement("canvas");g.Text.fontPropertiesContext=g.Text.fontPropertiesCanvas.getContext("2d");g.BitmapText=function(i,h){g.DisplayObjectContainer.call(this);this.textWidth=0;this.textHeight=0;this._pool=[];this.setText(i);this.setStyle(h);this.updateText();this.dirty=false};g.BitmapText.prototype=Object.create(g.DisplayObjectContainer.prototype);g.BitmapText.prototype.constructor=g.BitmapText;g.BitmapText.prototype.setText=function(h){this.text=h||" ";this.dirty=true};g.BitmapText.prototype.setStyle=function(i){i=i||{};i.align=i.align||"left";this.style=i;var h=i.font.split(" ");this.fontName=h[h.length-1];this.fontSize=h.length>=2?parseInt(h[h.length-2],10):g.BitmapText.fonts[this.fontName].size;this.dirty=true;this.tint=i.tint};g.BitmapText.prototype.updateText=function(){var w=g.BitmapText.fonts[this.fontName];var n=new g.Point();var o=null;var r=[];var s=0;var z=[];var q=0;var x=this.fontSize/w.size;for(var u=0;u<this.text.length;u++){var j=this.text.charCodeAt(u);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(u))){z.push(n.x);s=Math.max(s,n.x);q++;n.x=0;n.y+=w.lineHeight;o=null;continue}var h=w.chars[j];if(!h){continue}if(o&&h.kerning[o]){n.x+=h.kerning[o]}r.push({texture:h.texture,line:q,charCode:j,position:new g.Point(n.x+h.xOffset,n.y+h.yOffset)});n.x+=h.xAdvance;o=j}z.push(n.x);s=Math.max(s,n.x);var t=[];for(u=0;u<=q;u++){var y=0;if(this.style.align==="right"){y=s-z[u]}else{if(this.style.align==="center"){y=(s-z[u])/2}}t.push(y)}var k=this.children.length;var l=r.length;var p=this.tint||16777215;for(u=0;u<l;u++){var v=u<k?this.children[u]:this._pool.pop();if(v){v.setTexture(r[u].texture)}else{v=new g.Sprite(r[u].texture)}v.position.x=(r[u].position.x+t[r[u].line])*x;v.position.y=r[u].position.y*x;v.scale.x=v.scale.y=x;v.tint=p;if(!v.parent){this.addChild(v)}}while(this.children.length>l){var m=this.getChildAt(this.children.length-1);this._pool.push(m);this.removeChild(m)}this.textWidth=s*x;this.textHeight=(n.y+w.lineHeight)*x};g.BitmapText.prototype.updateTransform=function(){if(this.dirty){this.updateText();this.dirty=false}g.DisplayObjectContainer.prototype.updateTransform.call(this)};g.BitmapText.fonts={};g.InteractionData=function(){this.global=new g.Point();this.target=null;this.originalEvent=null};g.InteractionData.prototype.getLocalPosition=function(n,o){var h=n.worldTransform;var j=this.global;var m=h.a,l=h.c,k=h.tx,r=h.b,q=h.d,p=h.ty,i=1/(m*q+l*-r);o=o||new g.Point();o.x=q*i*j.x+-l*i*j.y+(p*l-k*q)*i;o.y=m*i*j.y+-r*i*j.x+(-p*m+k*r)*i;return o};g.InteractionData.prototype.constructor=g.InteractionData;g.InteractionManager=function(h){this.stage=h;this.mouse=new g.InteractionData();this.touches={};this.tempPoint=new g.Point();this.mouseoverEnabled=true;this.pool=[];this.interactiveItems=[];this.interactionDOMElement=null;this.onMouseMove=this.onMouseMove.bind(this);this.onMouseDown=this.onMouseDown.bind(this);this.onMouseOut=this.onMouseOut.bind(this);this.onMouseUp=this.onMouseUp.bind(this);this.onTouchStart=this.onTouchStart.bind(this);this.onTouchEnd=this.onTouchEnd.bind(this);this.onTouchMove=this.onTouchMove.bind(this);this.last=0;this.currentCursorStyle="inherit";this.mouseOut=false;this.resolution=1};g.InteractionManager.prototype.constructor=g.InteractionManager;g.InteractionManager.prototype.collectInteractiveSprite=function(m,h){var k=m.children;var l=k.length;for(var j=l-1;j>=0;j--){var n=k[j];if(n._interactive){h.interactiveChildren=true;this.interactiveItems.push(n);if(n.children.length>0){this.collectInteractiveSprite(n,n)}}else{n.__iParent=null;if(n.children.length>0){this.collectInteractiveSprite(n,h)}}}};g.InteractionManager.prototype.setTarget=function(h){this.target=h;this.resolution=h.resolution;if(this.interactionDOMElement!==null){return}this.setTargetDomElement(h.view)};g.InteractionManager.prototype.setTargetDomElement=function(h){this.removeEvents();if(window.navigator.msPointerEnabled){h.style["-ms-content-zooming"]="none";h.style["-ms-touch-action"]="none"}this.interactionDOMElement=h;h.addEventListener("mousemove",this.onMouseMove,true);h.addEventListener("mousedown",this.onMouseDown,true);h.addEventListener("mouseout",this.onMouseOut,true);h.addEventListener("touchstart",this.onTouchStart,true);h.addEventListener("touchend",this.onTouchEnd,true);h.addEventListener("touchmove",this.onTouchMove,true);window.addEventListener("mouseup",this.onMouseUp,true)};g.InteractionManager.prototype.removeEvents=function(){if(!this.interactionDOMElement){return}this.interactionDOMElement.style["-ms-content-zooming"]="";this.interactionDOMElement.style["-ms-touch-action"]="";this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,true);this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,true);this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,true);this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,true);this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,true);this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,true);this.interactionDOMElement=null;window.removeEventListener("mouseup",this.onMouseUp,true)};g.InteractionManager.prototype.update=function(){if(!this.target){return}var h=Date.now();var n=h-this.last;n=(n*g.INTERACTION_FREQUENCY)/1000;if(n<1){return}this.last=h;var j=0;if(this.dirty){this.rebuildInteractiveGraph()}var l=this.interactiveItems.length;var o="inherit";var m=false;for(j=0;j<l;j++){var k=this.interactiveItems[j];k.__hit=this.hitTest(k,this.mouse);this.mouse.target=k;if(k.__hit&&!m){if(k.buttonMode){o=k.defaultCursor}if(!k.interactiveChildren){m=true}if(!k.__isOver){if(k.mouseover){k.mouseover(this.mouse)}k.__isOver=true}}else{if(k.__isOver){if(k.mouseout){k.mouseout(this.mouse)}k.__isOver=false}}}if(this.currentCursorStyle!==o){this.currentCursorStyle=o;this.interactionDOMElement.style.cursor=o}};g.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=false;var h=this.interactiveItems.length;for(var j=0;j<h;j++){this.interactiveItems[j].interactiveChildren=false}this.interactiveItems=[];if(this.stage.interactive){this.interactiveItems.push(this.stage)}this.collectInteractiveSprite(this.stage,this.stage)};g.InteractionManager.prototype.onMouseMove=function(m){if(this.dirty){this.rebuildInteractiveGraph()}this.mouse.originalEvent=m;var l=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(m.clientX-l.left)*(this.target.width/l.width)/this.resolution;this.mouse.global.y=(m.clientY-l.top)*(this.target.height/l.height)/this.resolution;var k=this.interactiveItems.length;for(var h=0;h<k;h++){var j=this.interactiveItems[h];if(j.mousemove){j.mousemove(this.mouse)}}};g.InteractionManager.prototype.onMouseDown=function(h){if(this.dirty){this.rebuildInteractiveGraph()}this.mouse.originalEvent=h;if(g.AUTO_PREVENT_DEFAULT){this.mouse.originalEvent.preventDefault()}var k=this.interactiveItems.length;var q=this.mouse.originalEvent;var m=q.button===2||q.which===3;var l=m?"rightdown":"mousedown";var j=m?"rightclick":"click";var n=m?"__rightIsDown":"__mouseIsDown";var p=m?"__isRightDown":"__isDown";for(var o=0;o<k;o++){var r=this.interactiveItems[o];if(r[l]||r[j]){r[n]=true;r.__hit=this.hitTest(r,this.mouse);if(r.__hit){if(r[l]){r[l](this.mouse)}r[p]=true;if(!r.interactiveChildren){break}}}}};g.InteractionManager.prototype.onMouseOut=function(l){if(this.dirty){this.rebuildInteractiveGraph()}this.mouse.originalEvent=l;var k=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var h=0;h<k;h++){var j=this.interactiveItems[h];if(j.__isOver){this.mouse.target=j;if(j.mouseout){j.mouseout(this.mouse)}j.__isOver=false}}this.mouseOut=true;this.mouse.global.x=-10000;this.mouse.global.y=-10000};g.InteractionManager.prototype.onMouseUp=function(h){if(this.dirty){this.rebuildInteractiveGraph()}this.mouse.originalEvent=h;var k=this.interactiveItems.length;var o=false;var p=this.mouse.originalEvent;var l=p.button===2||p.which===3;var q=l?"rightup":"mouseup";var j=l?"rightclick":"click";var s=l?"rightupoutside":"mouseupoutside";var n=l?"__isRightDown":"__isDown";for(var m=0;m<k;m++){var r=this.interactiveItems[m];if(r[j]||r[q]||r[s]){r.__hit=this.hitTest(r,this.mouse);if(r.__hit&&!o){if(r[q]){r[q](this.mouse)}if(r[n]){if(r[j]){r[j](this.mouse)}}if(!r.interactiveChildren){o=true}}else{if(r[n]){if(r[s]){r[s](this.mouse)}}}r[n]=false}}};g.InteractionManager.prototype.hitTest=function(w,t){var q=t.global;if(!w.worldVisible){return false}var r=w.worldTransform,s,D=r.a,B=r.b,A=r.c,E=r.tx,z=r.d,C=r.ty,o=1/(D*z+A*-B),l=z*o*q.x+-A*o*q.y+(C*A-E*z)*o,k=D*o*q.y+-B*o*q.x+(-C*D+E*B)*o;t.target=w;if(w.hitArea&&w.hitArea.contains){if(w.hitArea.contains(l,k)){t.target=w;return true}return false}else{if(w instanceof g.Sprite){var p=w.texture.frame.width;var n=w.texture.frame.height;var v=-p*w.anchor.x;var h;if(l>v&&l<v+p){h=-n*w.anchor.y;if(k>h&&k<h+n){t.target=w;return true}}}else{if(w instanceof g.Graphics){var m=w.graphicsData;for(s=0;s<m.length;s++){var G=m[s];if(!G.fill){continue}if(G.shape){if(G.shape.contains(l,k)){t.target=w;return true}}}}}}var j=w.children.length;for(s=0;s<j;s++){var F=w.children[s];var u=this.hitTest(F,t);if(u){t.target=w;return true}}return false};g.InteractionManager.prototype.onTouchMove=function(q){if(this.dirty){this.rebuildInteractiveGraph()}var p=this.interactionDOMElement.getBoundingClientRect();var n=q.changedTouches;var m;var l=0;for(l=0;l<n.length;l++){var h=n[l];m=this.touches[h.identifier];if(!m){continue}m.originalEvent=q;m.global.x=((h.clientX-p.left)*(this.target.width/p.width))/this.resolution;m.global.y=((h.clientY-p.top)*(this.target.height/p.height))/this.resolution;if(navigator.isCocoonJS&&!p.left&&!p.top&&!q.target.style.width&&!q.target.style.height){m.global.x=h.clientX;m.global.y=h.clientY}for(var k=0;k<this.interactiveItems.length;k++){var o=this.interactiveItems[k];if(o.touchmove&&o.__touchData&&o.__touchData[h.identifier]){o.touchmove(m)}}}};g.InteractionManager.prototype.onTouchStart=function(h){if(this.dirty){this.rebuildInteractiveGraph()}var o=this.interactionDOMElement.getBoundingClientRect();if(g.AUTO_PREVENT_DEFAULT){h.preventDefault()}var p=h.changedTouches;for(var n=0;n<p.length;n++){var l=p[n];var q=this.pool.pop();if(!q){q=new g.InteractionData()}q.originalEvent=h;this.touches[l.identifier]=q;q.global.x=((l.clientX-o.left)*(this.target.width/o.width))/this.resolution;q.global.y=((l.clientY-o.top)*(this.target.height/o.height))/this.resolution;if(navigator.isCocoonJS&&!o.left&&!o.top&&!h.target.style.width&&!h.target.style.height){q.global.x=l.clientX;q.global.y=l.clientY}var k=this.interactiveItems.length;for(var m=0;m<k;m++){var r=this.interactiveItems[m];if(r.touchstart||r.tap){r.__hit=this.hitTest(r,q);if(r.__hit){if(r.touchstart){r.touchstart(q)}r.__isDown=true;r.__touchData=r.__touchData||{};r.__touchData[l.identifier]=q;if(!r.interactiveChildren){break}}}}}};g.InteractionManager.prototype.onTouchEnd=function(h){if(this.dirty){this.rebuildInteractiveGraph()}var p=this.interactionDOMElement.getBoundingClientRect();var q=h.changedTouches;for(var n=0;n<q.length;n++){var l=q[n];var r=this.touches[l.identifier];if(!r){continue}var o=false;r.global.x=((l.clientX-p.left)*(this.target.width/p.width))/this.resolution;r.global.y=((l.clientY-p.top)*(this.target.height/p.height))/this.resolution;if(navigator.isCocoonJS&&!p.left&&!p.top&&!h.target.style.width&&!h.target.style.height){r.global.x=l.clientX;r.global.y=l.clientY}var k=this.interactiveItems.length;for(var m=0;m<k;m++){var s=this.interactiveItems[m];if(s.__touchData&&s.__touchData[l.identifier]){s.__hit=this.hitTest(s,s.__touchData[l.identifier]);r.originalEvent=h;if(s.touchend||s.tap){if(s.__hit&&!o){if(s.touchend){s.touchend(r)}if(s.__isDown&&s.tap){s.tap(r)}if(!s.interactiveChildren){o=true}}else{if(s.__isDown&&s.touchendoutside){s.touchendoutside(r)}}s.__isDown=false}s.__touchData[l.identifier]=null}}this.pool.push(r);this.touches[l.identifier]=null}};g.Stage=function(h){g.DisplayObjectContainer.call(this);this.worldTransform=new g.Matrix();this.interactive=true;this.interactionManager=new g.InteractionManager(this);this.dirty=true;this.stage=this;this.stage.hitArea=new g.Rectangle(0,0,100000,100000);this.setBackgroundColor(h)};g.Stage.prototype=Object.create(g.DisplayObjectContainer.prototype);g.Stage.prototype.constructor=g.Stage;g.Stage.prototype.setInteractionDelegate=function(h){this.interactionManager.setTargetDomElement(h)};g.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var k=0,h=this.children.length;k<h;k++){this.children[k].updateTransform()}if(this.dirty){this.dirty=false;this.interactionManager.dirty=true}if(this.interactive){this.interactionManager.update()}};g.Stage.prototype.setBackgroundColor=function(h){this.backgroundColor=h||0;this.backgroundColorSplit=g.hex2rgb(this.backgroundColor);var i=this.backgroundColor.toString(16);i="000000".substr(0,6-i.length)+i;this.backgroundColorString="#"+i};g.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};(function(i){var j=0;var k=["ms","moz","webkit","o"];for(var h=0;h<k.length&&!i.requestAnimationFrame;++h){i.requestAnimationFrame=i[k[h]+"RequestAnimationFrame"];i.cancelAnimationFrame=i[k[h]+"CancelAnimationFrame"]||i[k[h]+"CancelRequestAnimationFrame"]}if(!i.requestAnimationFrame||navigator.userAgent.indexOf("Android 4.4.2")>0){i.requestAnimationFrame=function(o){var l=new Date().getTime();var m=Math.max(0,16-(l-j));var n=i.setTimeout(function(){o(l+m)},m);j=l+m;return n}}if(!i.cancelAnimationFrame){i.cancelAnimationFrame=function(l){clearTimeout(l)}}i.requestAnimFrame=i.requestAnimationFrame})(this);g.hex2rgb=function(h){return[(h>>16&255)/255,(h>>8&255)/255,(h&255)/255]};g.rgb2hex=function(h){return((h[0]*255<<16)+(h[1]*255<<8)+h[2]*255)};if(typeof Function.prototype.bind!=="function"){Function.prototype.bind=(function(){return function(h){var m=this,j=arguments.length-1,n=[];if(j>0){n.length=j;while(j--){n[j]=arguments[j+1]}}if(typeof m!=="function"){throw new TypeError()}function k(){var p=arguments.length,o=new Array(p);while(p--){o[p]=arguments[p]}o=n.concat(o);return m.apply(this instanceof k?this:h,o)}k.prototype=(function l(i){if(i){l.prototype=i}if(!(this instanceof l)){return new l()}})(m.prototype);return k}})()}g.AjaxRequest=function(){var h=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(window.ActiveXObject){for(var j=0;j<h.length;j++){try{return new window.ActiveXObject(h[j])}catch(k){}}}else{if(window.XMLHttpRequest){return new window.XMLHttpRequest()}else{return false}}};g.canUseNewCanvasBlendModes=function(){if(typeof document==="undefined"){return false}var h=document.createElement("canvas");h.width=1;h.height=1;var i=h.getContext("2d");i.fillStyle="#000";i.fillRect(0,0,1,1);i.globalCompositeOperation="multiply";i.fillStyle="#fff";i.fillRect(0,0,1,1);return i.getImageData(0,0,1,1).data[0]===0};g.getNextPowerOfTwo=function(i){if(i>0&&(i&(i-1))===0){return i}else{var h=1;while(h<i){h<<=1}return h}};g.EventTarget={call:function e(h){if(h){h=h.prototype||h;g.EventTarget.mixin(h)}},mixin:function c(m){m.listeners=function l(o){this._listeners=this._listeners||{};return this._listeners[o]?this._listeners[o].slice():[]};m.emit=m.dispatchEvent=function i(o,t){this._listeners=this._listeners||{};if(typeof o==="object"){t=o;o=o.type}if(!t||t.__isEventObject!==true){t=new g.Event(this,o,t)}if(this._listeners&&this._listeners[o]){var r=this._listeners[o].slice(0),s=r.length,q=r[0],p;for(p=0;p<s;q=r[++p]){q.call(this,t);if(t.stoppedImmediate){return this}}if(t.stopped){return this}}if(this.parent&&this.parent.emit){this.parent.emit.call(this.parent,o,t)}return this};m.on=m.addEventListener=function h(o,p){this._listeners=this._listeners||{};(this._listeners[o]=this._listeners[o]||[]).push(p);return this};m.once=function k(p,r){this._listeners=this._listeners||{};var o=this;function q(){r.apply(o.off(p,q),arguments)}q._originalHandler=r;return this.on(p,q)};m.off=m.removeEventListener=function n(o,q){this._listeners=this._listeners||{};if(!this._listeners[o]){return this}var r=this._listeners[o],p=q?r.length:0;while(p-->0){if(r[p]===q||r[p]._originalHandler===q){r.splice(p,1)}}if(r.length===0){delete this._listeners[o]}return this};m.removeAllListeners=function j(o){this._listeners=this._listeners||{};if(!this._listeners[o]){return this}delete this._listeners[o];return this}}};g.Event=function(j,h,i){this.__isEventObject=true;this.stopped=false;this.stoppedImmediate=false;this.target=j;this.type=h;this.data=i;this.content=i;this.timeStamp=Date.now()};g.Event.prototype.stopPropagation=function a(){this.stopped=true};g.Event.prototype.stopImmediatePropagation=function d(){this.stoppedImmediate=true};g.autoDetectRenderer=function(j,h,i){if(!j){j=800}if(!h){h=600}var k=(function(){try{var l=document.createElement("canvas");return !!window.WebGLRenderingContext&&(l.getContext("webgl")||l.getContext("experimental-webgl"))}catch(m){return false}})();if(k){return new g.WebGLRenderer(j,h,i)}return new g.CanvasRenderer(j,h,i)};g.autoDetectRecommendedRenderer=function(k,h,i){if(!k){k=800}if(!h){h=600}var l=(function(){try{var m=document.createElement("canvas");return !!window.WebGLRenderingContext&&(m.getContext("webgl")||m.getContext("experimental-webgl"))}catch(n){return false}})();var j=/Android/i.test(navigator.userAgent);if(l&&!j){return new g.WebGLRenderer(k,h,i)}return new g.CanvasRenderer(k,h,i)};g.PolyK={};g.PolyK.Triangulate=function(r){var D=true;var s=r.length>>1;if(s<3){return[]}var A=[];var q=[];for(var y=0;y<s;y++){q.push(y)}y=0;var v=s;while(v>3){var w=q[(y+0)%v];var u=q[(y+1)%v];var t=q[(y+2)%v];var o=r[2*w],l=r[2*w+1];var B=r[2*u],z=r[2*u+1];var k=r[2*t],h=r[2*t+1];var m=false;if(g.PolyK._convex(o,l,B,z,k,h,D)){m=true;for(var x=0;x<v;x++){var C=q[x];if(C===w||C===u||C===t){continue}if(g.PolyK._PointInTriangle(r[2*C],r[2*C+1],o,l,B,z,k,h)){m=false;break}}}if(m){A.push(w,u,t);q.splice((y+1)%v,1);v--;y=0}else{if(y++>3*v){if(D){A=[];q=[];for(y=0;y<s;y++){q.push(y)}y=0;v=s;D=false}else{return null}}}}A.push(q[0],q[1],q[2]);return A};g.PolyK._PointInTriangle=function(x,w,r,q,E,D,n,l){var k=n-r;var j=l-q;var p=E-r;var o=D-q;var C=x-r;var A=w-q;var B=k*k+j*j;var z=k*p+j*o;var y=k*C+j*A;var i=p*p+o*o;var h=p*C+o*A;var m=1/(B*i-z*z);var t=(i*y-z*h)*m;var s=(B*h-z*y)*m;return(t>=0)&&(s>=0)&&(t+s<1)};g.PolyK._convex=function(k,j,m,l,h,n,i){return((j-l)*(h-m)+(m-k)*(n-l)>=0)===i};g.initDefaultShaders=function(){};g.CompileVertexShader=function(i,h){return g._CompileShader(i,h,i.VERTEX_SHADER)};g.CompileFragmentShader=function(i,h){return g._CompileShader(i,h,i.FRAGMENT_SHADER)};g._CompileShader=function(l,k,j){var i=k.join("\n");var h=l.createShader(j);l.shaderSource(h,i);l.compileShader(h);if(!l.getShaderParameter(h,l.COMPILE_STATUS)){window.console.log(l.getShaderInfoLog(h));return null}return h};g.compileProgram=function(l,h,j){var i=g.CompileFragmentShader(l,j);var k=g.CompileVertexShader(l,h);var m=l.createProgram();l.attachShader(m,k);l.attachShader(m,i);l.linkProgram(m);if(!l.getProgramParameter(m,l.LINK_STATUS)){window.console.log("Could not initialise shaders")}return m};g.PixiShader=function(h){this._UID=g._UID++;this.gl=h;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.textureCount=0;this.firstRun=true;this.dirty=true;this.attributes=[];this.init()};g.PixiShader.prototype.constructor=g.PixiShader;g.PixiShader.prototype.init=function(){var j=this.gl;var h=g.compileProgram(j,this.vertexSrc||g.PixiShader.defaultVertexSrc,this.fragmentSrc);j.useProgram(h);this.uSampler=j.getUniformLocation(h,"uSampler");this.projectionVector=j.getUniformLocation(h,"projectionVector");this.offsetVector=j.getUniformLocation(h,"offsetVector");this.dimensions=j.getUniformLocation(h,"dimensions");this.aVertexPosition=j.getAttribLocation(h,"aVertexPosition");this.aTextureCoord=j.getAttribLocation(h,"aTextureCoord");this.colorAttribute=j.getAttribLocation(h,"aColor");if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var i in this.uniforms){this.uniforms[i].uniformLocation=j.getUniformLocation(h,i)}this.initUniforms();this.program=h};g.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var k=this.gl;var h;for(var i in this.uniforms){h=this.uniforms[i];var j=h.type;if(j==="sampler2D"){h._init=false;if(h.value!==null){this.initSampler2D(h)}}else{if(j==="mat2"||j==="mat3"||j==="mat4"){h.glMatrix=true;h.glValueLength=1;if(j==="mat2"){h.glFunc=k.uniformMatrix2fv}else{if(j==="mat3"){h.glFunc=k.uniformMatrix3fv}else{if(j==="mat4"){h.glFunc=k.uniformMatrix4fv}}}}else{h.glFunc=k["uniform"+j];if(j==="2f"||j==="2i"){h.glValueLength=2}else{if(j==="3f"||j==="3i"){h.glValueLength=3}else{if(j==="4f"||j==="4i"){h.glValueLength=4}else{h.glValueLength=1}}}}}}};g.PixiShader.prototype.initSampler2D=function(j){if(!j.value||!j.value.baseTexture||!j.value.baseTexture.hasLoaded){return}var o=this.gl;o.activeTexture(o["TEXTURE"+this.textureCount]);o.bindTexture(o.TEXTURE_2D,j.value.baseTexture._glTextures[o.id]);if(j.textureData){var m=j.textureData;var q=(m.magFilter)?m.magFilter:o.LINEAR;var i=(m.minFilter)?m.minFilter:o.LINEAR;var n=(m.wrapS)?m.wrapS:o.CLAMP_TO_EDGE;var l=(m.wrapT)?m.wrapT:o.CLAMP_TO_EDGE;var p=(m.luminance)?o.LUMINANCE:o.RGBA;if(m.repeat){n=o.REPEAT;l=o.REPEAT}o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!!m.flipY);if(m.width){var h=(m.width)?m.width:512;var r=(m.height)?m.height:2;var k=(m.border)?m.border:0;o.texImage2D(o.TEXTURE_2D,0,p,h,r,k,p,o.UNSIGNED_BYTE,null)}else{o.texImage2D(o.TEXTURE_2D,0,p,o.RGBA,o.UNSIGNED_BYTE,j.value.baseTexture.source)}o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,q);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,i);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,n);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,l)}o.uniform1i(j.uniformLocation,this.textureCount);j._init=true;this.textureCount++};g.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var h;var j=this.gl;for(var i in this.uniforms){h=this.uniforms[i];if(h.glValueLength===1){if(h.glMatrix===true){h.glFunc.call(j,h.uniformLocation,h.transpose,h.value)}else{h.glFunc.call(j,h.uniformLocation,h.value)}}else{if(h.glValueLength===2){h.glFunc.call(j,h.uniformLocation,h.value.x,h.value.y)}else{if(h.glValueLength===3){h.glFunc.call(j,h.uniformLocation,h.value.x,h.value.y,h.value.z)}else{if(h.glValueLength===4){h.glFunc.call(j,h.uniformLocation,h.value.x,h.value.y,h.value.z,h.value.w)}else{if(h.type==="sampler2D"){if(h._init){j.activeTexture(j["TEXTURE"+this.textureCount]);if(h.value.baseTexture._dirty[j.id]){g.instances[j.id].updateTexture(h.value.baseTexture)}else{j.bindTexture(j.TEXTURE_2D,h.value.baseTexture._glTextures[j.id])}j.uniform1i(h.uniformLocation,this.textureCount);this.textureCount++}else{this.initSampler2D(h)}}}}}}}};g.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};g.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"];g.PixiFastShader=function(h){this._UID=g._UID++;this.gl=h;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"];this.textureCount=0;this.init()};g.PixiFastShader.prototype.constructor=g.PixiFastShader;g.PixiFastShader.prototype.init=function(){var i=this.gl;var h=g.compileProgram(i,this.vertexSrc,this.fragmentSrc);i.useProgram(h);this.uSampler=i.getUniformLocation(h,"uSampler");this.projectionVector=i.getUniformLocation(h,"projectionVector");this.offsetVector=i.getUniformLocation(h,"offsetVector");this.dimensions=i.getUniformLocation(h,"dimensions");this.uMatrix=i.getUniformLocation(h,"uMatrix");this.aVertexPosition=i.getAttribLocation(h,"aVertexPosition");this.aPositionCoord=i.getAttribLocation(h,"aPositionCoord");this.aScale=i.getAttribLocation(h,"aScale");this.aRotation=i.getAttribLocation(h,"aRotation");this.aTextureCoord=i.getAttribLocation(h,"aTextureCoord");this.colorAttribute=i.getAttribLocation(h,"aColor");if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute];this.program=h};g.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};g.StripShader=function(h){this._UID=g._UID++;this.gl=h;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"];this.init()};g.StripShader.prototype.constructor=g.StripShader;g.StripShader.prototype.init=function(){var i=this.gl;var h=g.compileProgram(i,this.vertexSrc,this.fragmentSrc);i.useProgram(h);this.uSampler=i.getUniformLocation(h,"uSampler");this.projectionVector=i.getUniformLocation(h,"projectionVector");this.offsetVector=i.getUniformLocation(h,"offsetVector");this.colorAttribute=i.getAttribLocation(h,"aColor");this.aVertexPosition=i.getAttribLocation(h,"aVertexPosition");this.aTextureCoord=i.getAttribLocation(h,"aTextureCoord");this.attributes=[this.aVertexPosition,this.aTextureCoord];this.translationMatrix=i.getUniformLocation(h,"translationMatrix");this.alpha=i.getUniformLocation(h,"alpha");this.program=h};g.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};g.PrimitiveShader=function(h){this._UID=g._UID++;this.gl=h;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};g.PrimitiveShader.prototype.constructor=g.PrimitiveShader;g.PrimitiveShader.prototype.init=function(){var i=this.gl;var h=g.compileProgram(i,this.vertexSrc,this.fragmentSrc);i.useProgram(h);this.projectionVector=i.getUniformLocation(h,"projectionVector");this.offsetVector=i.getUniformLocation(h,"offsetVector");this.tintColor=i.getUniformLocation(h,"tint");this.aVertexPosition=i.getAttribLocation(h,"aVertexPosition");this.colorAttribute=i.getAttribLocation(h,"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=i.getUniformLocation(h,"translationMatrix");this.alpha=i.getUniformLocation(h,"alpha");this.program=h};g.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};g.ComplexPrimitiveShader=function(h){this._UID=g._UID++;this.gl=h;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"];this.init()};g.ComplexPrimitiveShader.prototype.constructor=g.ComplexPrimitiveShader;g.ComplexPrimitiveShader.prototype.init=function(){var i=this.gl;var h=g.compileProgram(i,this.vertexSrc,this.fragmentSrc);i.useProgram(h);this.projectionVector=i.getUniformLocation(h,"projectionVector");this.offsetVector=i.getUniformLocation(h,"offsetVector");this.tintColor=i.getUniformLocation(h,"tint");this.color=i.getUniformLocation(h,"color");this.aVertexPosition=i.getAttribLocation(h,"aVertexPosition");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=i.getUniformLocation(h,"translationMatrix");this.alpha=i.getUniformLocation(h,"alpha");this.program=h};g.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};g.WebGLGraphics=function(){};g.WebGLGraphics.renderGraphics=function(p,q){var k=q.gl;var n=q.projection,h=q.offset,m=q.shaderManager.primitiveShader,l;if(p.dirty){g.WebGLGraphics.updateGraphics(p,k)}var o=p._webGL[k.id];for(var j=0;j<o.data.length;j++){if(o.data[j].mode===1){l=o.data[j];q.stencilManager.pushStencil(p,l,q);k.drawElements(k.TRIANGLE_FAN,4,k.UNSIGNED_SHORT,(l.indices.length-4)*2);q.stencilManager.popStencil(p,l,q)}else{l=o.data[j];q.shaderManager.setShader(m);m=q.shaderManager.primitiveShader;k.uniformMatrix3fv(m.translationMatrix,false,p.worldTransform.toArray(true));k.uniform2f(m.projectionVector,n.x,-n.y);k.uniform2f(m.offsetVector,-h.x,-h.y);k.uniform3fv(m.tintColor,g.hex2rgb(p.tint));k.uniform1f(m.alpha,p.worldAlpha);k.bindBuffer(k.ARRAY_BUFFER,l.buffer);k.vertexAttribPointer(m.aVertexPosition,2,k.FLOAT,false,4*6,0);k.vertexAttribPointer(m.colorAttribute,4,k.FLOAT,false,4*6,2*4);k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,l.indexBuffer);k.drawElements(k.TRIANGLE_STRIP,l.indices.length,k.UNSIGNED_SHORT,0)}}};g.WebGLGraphics.updateGraphics=function(h,o){var m=h._webGL[o.id];if(!m){m=h._webGL[o.id]={lastIndex:0,data:[],gl:o}}h.dirty=false;var j;if(h.clearDirty){h.clearDirty=false;for(j=0;j<m.data.length;j++){var p=m.data[j];p.reset();g.WebGLGraphics.graphicsDataPool.push(p)}m.data=[];m.lastIndex=0}var n;for(j=m.lastIndex;j<h.graphicsData.length;j++){var l=h.graphicsData[j];if(l.type===g.Graphics.POLY){l.points=l.shape.points.slice();if(l.shape.closed){if(l.points[0]!==l.points[l.points.length-2]&&l.points[1]!==l.points[l.points.length-1]){l.points.push(l.points[0],l.points[1])}}if(l.fill){if(l.points.length>=6){if(l.points.length<6*2){n=g.WebGLGraphics.switchMode(m,0);var k=g.WebGLGraphics.buildPoly(l,n);if(!k){n=g.WebGLGraphics.switchMode(m,1);g.WebGLGraphics.buildComplexPoly(l,n)}}else{n=g.WebGLGraphics.switchMode(m,1);g.WebGLGraphics.buildComplexPoly(l,n)}}}if(l.lineWidth>0){n=g.WebGLGraphics.switchMode(m,0);g.WebGLGraphics.buildLine(l,n)}}else{n=g.WebGLGraphics.switchMode(m,0);if(l.type===g.Graphics.RECT){g.WebGLGraphics.buildRectangle(l,n)}else{if(l.type===g.Graphics.CIRC||l.type===g.Graphics.ELIP){g.WebGLGraphics.buildCircle(l,n)}else{if(l.type===g.Graphics.RREC){g.WebGLGraphics.buildRoundedRectangle(l,n)}}}}m.lastIndex++}for(j=0;j<m.data.length;j++){n=m.data[j];if(n.dirty){n.upload()}}};g.WebGLGraphics.switchMode=function(i,h){var j;if(!i.data.length){j=g.WebGLGraphics.graphicsDataPool.pop()||new g.WebGLGraphicsData(i.gl);j.mode=h;i.data.push(j)}else{j=i.data[i.data.length-1];if(j.mode!==h||h===1){j=g.WebGLGraphics.graphicsDataPool.pop()||new g.WebGLGraphicsData(i.gl);j.mode=h;i.data.push(j)}}j.dirty=true;return j};g.WebGLGraphics.buildRectangle=function(z,m){var k=z.shape;var t=k.x;var s=k.y;var i=k.width;var w=k.height;if(z.fill){var l=g.hex2rgb(z.fillColor);var j=z.fillAlpha;var h=l[0]*j;var n=l[1]*j;var q=l[2]*j;var u=m.points;var v=m.indices;var p=u.length/6;u.push(t,s);u.push(h,n,q,j);u.push(t+i,s);u.push(h,n,q,j);u.push(t,s+w);u.push(h,n,q,j);u.push(t+i,s+w);u.push(h,n,q,j);v.push(p,p,p+1,p+2,p+3,p+3)}if(z.lineWidth){var o=z.points;z.points=[t,s,t+i,s,t+i,s+w,t,s+w,t,s];g.WebGLGraphics.buildLine(z,m);z.points=o}};g.WebGLGraphics.buildRoundedRectangle=function(q,E){var h=q.shape;var p=h.x;var o=h.y;var v=h.width;var u=h.height;var k=h.radius;var s=[];s.push(p,o+k);s=s.concat(g.WebGLGraphics.quadraticBezierCurve(p,o+u-k,p,o+u,p+k,o+u));s=s.concat(g.WebGLGraphics.quadraticBezierCurve(p+v-k,o+u,p+v,o+u,p+v,o+u-k));s=s.concat(g.WebGLGraphics.quadraticBezierCurve(p+v,o+k,p+v,o,p+v-k,o));s=s.concat(g.WebGLGraphics.quadraticBezierCurve(p+k,o,p,o,p,o+k));if(q.fill){var z=g.hex2rgb(q.fillColor);var l=q.fillAlpha;var t=z[0]*l;var B=z[1]*l;var C=z[2]*l;var D=E.points;var m=E.indices;var j=D.length/6;var w=g.PolyK.Triangulate(s);var A=0;for(A=0;A<w.length;A+=3){m.push(w[A]+j);m.push(w[A]+j);m.push(w[A+1]+j);m.push(w[A+2]+j);m.push(w[A+2]+j)}for(A=0;A<s.length;A++){D.push(s[A],s[++A],t,B,C,l)}}if(q.lineWidth){var n=q.points;q.points=s;g.WebGLGraphics.buildLine(q,E);q.points=n}};g.WebGLGraphics.quadraticBezierCurve=function(z,t,v,q,A,u){var k,r,C,p,w,s,l=20,B=[];function h(n,j,i){var x=j-n;return n+(x*i)}var m=0;for(var o=0;o<=l;o++){m=o/l;k=h(z,v,m);r=h(t,q,m);C=h(v,A,m);p=h(q,u,m);w=h(k,C,m);s=h(r,p,m);B.push(w,s)}return B};g.WebGLGraphics.buildCircle=function(o,D){var z=o.shape;var n=z.x;var m=z.y;var t;var s;if(o.type===g.Graphics.CIRC){t=z.radius;s=z.radius}else{t=z.width;s=z.height}var p=40;var A=(Math.PI*2)/p;var v=0;if(o.fill){var u=g.hex2rgb(o.fillColor);var j=o.fillAlpha;var q=u[0]*j;var w=u[1]*j;var B=u[2]*j;var C=D.points;var k=D.indices;var h=C.length/6;k.push(h);for(v=0;v<p+1;v++){C.push(n,m,q,w,B,j);C.push(n+Math.sin(A*v)*t,m+Math.cos(A*v)*s,q,w,B,j);k.push(h++,h++)}k.push(h-1)}if(o.lineWidth){var l=o.points;o.points=[];for(v=0;v<p+1;v++){o.points.push(n+Math.sin(A*v)*t,m+Math.cos(A*v)*s)}g.WebGLGraphics.buildLine(o,D);o.points=l}};g.WebGLGraphics.buildLine=function(W,G){var S=0;var J=W.points;if(J.length===0){return}if(W.lineWidth%2){for(S=0;S<J.length;S++){J[S]+=0.5}}var x=new g.Point(J[0],J[1]);var p=new g.Point(J[J.length-2],J[J.length-1]);if(x.x===p.x&&x.y===p.y){J=J.slice();J.pop();J.pop();p=new g.Point(J[J.length-2],J[J.length-1]);var z=p.x+(x.x-p.x)*0.5;var w=p.y+(x.y-p.y)*0.5;J.unshift(z,w);J.push(z,w)}var T=G.points;var n=G.indices;var y=J.length/2;var v=J.length;var V=T.length/6;var h=W.lineWidth/2;var I=g.hex2rgb(W.lineColor);var R=W.lineAlpha;var O=I[0]*R;var U=I[1]*R;var X=I[2]*R;var u,t,L,K,D,C,m,l;var N,M,B,A,k,j;var Q,H,s,P,F,q;var Y,E,o;L=J[0];K=J[1];D=J[2];C=J[3];N=-(K-C);M=L-D;o=Math.sqrt(N*N+M*M);N/=o;M/=o;N*=h;M*=h;T.push(L-N,K-M,O,U,X,R);T.push(L+N,K+M,O,U,X,R);for(S=1;S<y-1;S++){L=J[(S-1)*2];K=J[(S-1)*2+1];D=J[(S)*2];C=J[(S)*2+1];m=J[(S+1)*2];l=J[(S+1)*2+1];N=-(K-C);M=L-D;o=Math.sqrt(N*N+M*M);N/=o;M/=o;N*=h;M*=h;B=-(C-l);A=D-m;o=Math.sqrt(B*B+A*A);B/=o;A/=o;B*=h;A*=h;Q=(-M+K)-(-M+C);H=(-N+D)-(-N+L);s=(-N+L)*(-M+C)-(-N+D)*(-M+K);P=(-A+l)-(-A+C);F=(-B+D)-(-B+m);q=(-B+m)*(-A+C)-(-B+D)*(-A+l);Y=Q*F-P*H;if(Math.abs(Y)<0.1){Y+=10.1;T.push(D-N,C-M,O,U,X,R);T.push(D+N,C+M,O,U,X,R);continue}u=(H*q-F*s)/Y;t=(P*s-Q*q)/Y;E=(u-D)*(u-D)+(t-C)+(t-C);if(E>140*140){k=N-B;j=M-A;o=Math.sqrt(k*k+j*j);k/=o;j/=o;k*=h;j*=h;T.push(D-k,C-j);T.push(O,U,X,R);T.push(D+k,C+j);T.push(O,U,X,R);T.push(D-k,C-j);T.push(O,U,X,R);v++}else{T.push(u,t);T.push(O,U,X,R);T.push(D-(u-D),C-(t-C));T.push(O,U,X,R)}}L=J[(y-2)*2];K=J[(y-2)*2+1];D=J[(y-1)*2];C=J[(y-1)*2+1];N=-(K-C);M=L-D;o=Math.sqrt(N*N+M*M);N/=o;M/=o;N*=h;M*=h;T.push(D-N,C-M);T.push(O,U,X,R);T.push(D+N,C+M);T.push(O,U,X,R);n.push(V);for(S=0;S<v;S++){n.push(V++)}n.push(V-1)};g.WebGLGraphics.buildComplexPoly=function(t,o){var r=t.points.slice();if(r.length<6){return}var s=o.indices;o.points=r;o.alpha=t.fillAlpha;o.color=g.hex2rgb(t.fillColor);var m=Infinity;var j=-Infinity;var l=Infinity;var h=-Infinity;var q,p;for(var n=0;n<r.length;n+=2){q=r[n];p=r[n+1];m=q<m?q:m;j=q>j?q:j;l=p<l?p:l;h=p>h?p:h}r.push(m,l,j,l,j,h,m,h);var k=r.length/2;for(n=0;n<k;n++){s.push(n)}};g.WebGLGraphics.buildPoly=function(w,o){var u=w.points;if(u.length<6){return}var t=o.points;var v=o.indices;var j=u.length/2;var m=g.hex2rgb(w.fillColor);var l=w.fillAlpha;var h=m[0]*l;var p=m[1]*l;var s=m[2]*l;var k=g.PolyK.Triangulate(u);if(!k){return false}var q=t.length/6;var n=0;for(n=0;n<k.length;n+=3){v.push(k[n]+q);v.push(k[n]+q);v.push(k[n+1]+q);v.push(k[n+2]+q);v.push(k[n+2]+q)}for(n=0;n<j;n++){t.push(u[n*2],u[n*2+1],h,p,s,l)}return true};g.WebGLGraphics.graphicsDataPool=[];g.WebGLGraphicsData=function(h){this.gl=h;this.color=[0,0,0];this.points=[];this.indices=[];this.lastIndex=0;this.buffer=h.createBuffer();this.indexBuffer=h.createBuffer();this.mode=1;this.alpha=1;this.dirty=true};g.WebGLGraphicsData.prototype.reset=function(){this.points=[];this.indices=[];this.lastIndex=0};g.WebGLGraphicsData.prototype.upload=function(){var h=this.gl;this.glPoints=new g.Float32Array(this.points);h.bindBuffer(h.ARRAY_BUFFER,this.buffer);h.bufferData(h.ARRAY_BUFFER,this.glPoints,h.STATIC_DRAW);this.glIndicies=new g.Uint16Array(this.indices);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.indexBuffer);h.bufferData(h.ELEMENT_ARRAY_BUFFER,this.glIndicies,h.STATIC_DRAW);this.dirty=false};g.glContexts=[];g.instances=[];g.WebGLRenderer=function(l,h,j){if(j){for(var k in g.defaultRenderOptions){if(typeof j[k]==="undefined"){j[k]=g.defaultRenderOptions[k]}}}else{j=g.defaultRenderOptions}if(!g.defaultRenderer){g.sayHello("webGL");g.defaultRenderer=this}this.type=g.WEBGL_RENDERER;this.resolution=j.resolution;this.transparent=j.transparent;this.autoResize=j.autoResize||false;this.preserveDrawingBuffer=j.preserveDrawingBuffer;this.clearBeforeRender=j.clearBeforeRender;this.width=l||800;this.height=h||600;this.view=j.view||document.createElement("canvas");this.contextLostBound=this.handleContextLost.bind(this);this.contextRestoredBound=this.handleContextRestored.bind(this);this.view.addEventListener("webglcontextlost",this.contextLostBound,false);this.view.addEventListener("webglcontextrestored",this.contextRestoredBound,false);this._contextOptions={alpha:this.transparent,antialias:j.antialias,premultipliedAlpha:this.transparent&&this.transparent!=="notMultiplied",stencil:true,preserveDrawingBuffer:j.preserveDrawingBuffer};this._contextOptions_bk={alpha:this.transparent,antialias:j.antialias,premultipliedAlpha:this.transparent&&this.transparent!=="notMultiplied",stencil:false,preserveDrawingBuffer:j.preserveDrawingBuffer};this.projection=new g.Point();this.offset=new g.Point(0,0);this.shaderManager=new g.WebGLShaderManager();this.spriteBatch=new g.WebGLSpriteBatch();this.maskManager=new g.WebGLMaskManager();this.filterManager=new g.WebGLFilterManager();this.stencilManager=new g.WebGLStencilManager();this.blendModeManager=new g.WebGLBlendModeManager();this.renderSession={};this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;this.initContext();this.mapBlendModes()};g.WebGLRenderer.prototype.constructor=g.WebGLRenderer;g.WebGLRenderer.prototype.initContext=function(){var h=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);this.gl=h;if(!h){h=this.view.getContext("webgl",this._contextOptions_bk)||this.view.getContext("experimental-webgl",this._contextOptions_bk);if(!h){throw new Error("This browser does not support webGL. Try using the canvas renderer")}else{this.gl=h}}this.glContextId=h.id=g.WebGLRenderer.glContextId++;g.glContexts[this.glContextId]=h;g.instances[this.glContextId]=this;h.disable(h.DEPTH_TEST);h.disable(h.CULL_FACE);h.enable(h.BLEND);this.shaderManager.setContext(h);this.spriteBatch.setContext(h);this.maskManager.setContext(h);this.filterManager.setContext(h);this.blendModeManager.setContext(h);this.stencilManager.setContext(h);this.renderSession.gl=this.gl;this.resize(this.width,this.height)};g.WebGLRenderer.prototype.render=function(h){if(this.contextLost){return}if(this.__stage!==h){if(h.interactive){h.interactionManager.removeEvents()}this.__stage=h}h.updateTransform();var i=this.gl;if(h._interactive){if(!h._interactiveEventsAdded){h._interactiveEventsAdded=true;h.interactionManager.setTarget(this)}}else{if(h._interactiveEventsAdded){h._interactiveEventsAdded=false;h.interactionManager.setTarget(this)}}i.viewport(0,0,this.width,this.height);i.bindFramebuffer(i.FRAMEBUFFER,null);if(this.clearBeforeRender){if(this.transparent){i.clearColor(0,0,0,0)}else{i.clearColor(h.backgroundColorSplit[0],h.backgroundColorSplit[1],h.backgroundColorSplit[2],1)}i.clear(i.COLOR_BUFFER_BIT)}this.renderDisplayObject(h,this.projection)};g.WebGLRenderer.prototype.renderDisplayObject=function(j,h,i){this.renderSession.blendModeManager.setBlendMode(g.blendModes.NORMAL);this.renderSession.drawCount=0;this.renderSession.projection=h;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,i);j._renderWebGL(this.renderSession);this.spriteBatch.end()};g.WebGLRenderer.prototype.resize=function(i,h){this.width=i*this.resolution;this.height=h*this.resolution;this.view.width=this.width;this.view.height=this.height;if(this.autoResize){this.view.style.width=this.width/this.resolution+"px";this.view.style.height=this.height/this.resolution+"px"}this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};g.WebGLRenderer.prototype.updateTexture=function(h){if(!h.hasLoaded){return}var i=this.gl;if(!h._glTextures[i.id]){h._glTextures[i.id]=i.createTexture()}i.bindTexture(i.TEXTURE_2D,h._glTextures[i.id]);i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h.premultipliedAlpha);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,h.source);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,h.scaleMode===g.scaleModes.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,h.scaleMode===g.scaleModes.LINEAR?i.LINEAR:i.NEAREST);if(!h._powerOf2){i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)}else{i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)}h._dirty[i.id]=false;return h._glTextures[i.id]};g.WebGLRenderer.prototype.handleContextLost=function(h){h.preventDefault();this.contextLost=true};g.WebGLRenderer.prototype.handleContextRestored=function(){this.initContext();for(var h in g.TextureCache){var i=g.TextureCache[h].baseTexture;i._glTextures=[]}this.contextLost=false};g.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLostBound);this.view.removeEventListener("webglcontextrestored",this.contextRestoredBound);g.glContexts[this.glContextId]=null;this.projection=null;this.offset=null;this.shaderManager.destroy();this.spriteBatch.destroy();this.maskManager.destroy();this.filterManager.destroy();this.shaderManager=null;this.spriteBatch=null;this.maskManager=null;this.filterManager=null;this.gl=null;this.renderSession=null};g.WebGLRenderer.prototype.mapBlendModes=function(){var h=this.gl;if(!g.blendModesWebGL){g.blendModesWebGL=[];g.blendModesWebGL[g.blendModes.NORMAL]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.ADD]=[h.SRC_ALPHA,h.DST_ALPHA];g.blendModesWebGL[g.blendModes.MULTIPLY]=[h.DST_COLOR,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.SCREEN]=[h.SRC_ALPHA,h.ONE];g.blendModesWebGL[g.blendModes.OVERLAY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.DARKEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.LIGHTEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.COLOR_DODGE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.COLOR_BURN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.HARD_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.SOFT_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.DIFFERENCE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.EXCLUSION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.HUE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.SATURATION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.COLOR]=[h.ONE,h.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL[g.blendModes.LUMINOSITY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA]}};g.WebGLRenderer.glContextId=0;g.WebGLBlendModeManager=function(){this.currentBlendMode=99999};g.WebGLBlendModeManager.prototype.constructor=g.WebGLBlendModeManager;g.WebGLBlendModeManager.prototype.setContext=function(h){this.gl=h};g.WebGLBlendModeManager.prototype.setBlendMode=function(h){if(this.currentBlendMode===h){return false}this.currentBlendMode=h;var i=g.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(i[0],i[1]);return true};g.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};g.WebGLMaskManager=function(){};g.WebGLMaskManager.prototype.constructor=g.WebGLMaskManager;g.WebGLMaskManager.prototype.setContext=function(h){this.gl=h};g.WebGLMaskManager.prototype.pushMask=function(i,h){var j=h.gl;if(i.dirty){g.WebGLGraphics.updateGraphics(i,j)}if(!i._webGL[j.id].data.length){return}h.stencilManager.pushStencil(i,i._webGL[j.id].data[0],h)};g.WebGLMaskManager.prototype.popMask=function(i,h){var j=this.gl;h.stencilManager.popStencil(i,i._webGL[j.id].data[0],h)};g.WebGLMaskManager.prototype.destroy=function(){this.gl=null};g.WebGLStencilManager=function(){this.stencilStack=[];this.reverse=true;this.count=0};g.WebGLStencilManager.prototype.setContext=function(h){this.gl=h};g.WebGLStencilManager.prototype.pushStencil=function(h,k,i){var j=this.gl;this.bindGraphics(h,k,i);if(this.stencilStack.length===0){j.enable(j.STENCIL_TEST);j.clear(j.STENCIL_BUFFER_BIT);this.reverse=true;this.count=0}this.stencilStack.push(k);var l=this.count;j.colorMask(false,false,false,false);j.stencilFunc(j.ALWAYS,0,255);j.stencilOp(j.KEEP,j.KEEP,j.INVERT);if(k.mode===1){j.drawElements(j.TRIANGLE_FAN,k.indices.length-4,j.UNSIGNED_SHORT,0);if(this.reverse){j.stencilFunc(j.EQUAL,255-l,255);j.stencilOp(j.KEEP,j.KEEP,j.DECR)}else{j.stencilFunc(j.EQUAL,l,255);j.stencilOp(j.KEEP,j.KEEP,j.INCR)}j.drawElements(j.TRIANGLE_FAN,4,j.UNSIGNED_SHORT,(k.indices.length-4)*2);if(this.reverse){j.stencilFunc(j.EQUAL,255-(l+1),255)}else{j.stencilFunc(j.EQUAL,l+1,255)}this.reverse=!this.reverse}else{if(!this.reverse){j.stencilFunc(j.EQUAL,255-l,255);j.stencilOp(j.KEEP,j.KEEP,j.DECR)}else{j.stencilFunc(j.EQUAL,l,255);j.stencilOp(j.KEEP,j.KEEP,j.INCR)}j.drawElements(j.TRIANGLE_STRIP,k.indices.length,j.UNSIGNED_SHORT,0);if(!this.reverse){j.stencilFunc(j.EQUAL,255-(l+1),255)}else{j.stencilFunc(j.EQUAL,l+1,255)}}j.colorMask(true,true,true,true);j.stencilOp(j.KEEP,j.KEEP,j.KEEP);this.count++};g.WebGLStencilManager.prototype.bindGraphics=function(i,n,k){this._currentGraphics=i;var m=this.gl;var h=k.projection,l=k.offset,j;if(n.mode===1){j=k.shaderManager.complexPrimitiveShader;k.shaderManager.setShader(j);m.uniformMatrix3fv(j.translationMatrix,false,i.worldTransform.toArray(true));m.uniform2f(j.projectionVector,h.x,-h.y);m.uniform2f(j.offsetVector,-l.x,-l.y);m.uniform3fv(j.tintColor,g.hex2rgb(i.tint));m.uniform3fv(j.color,n.color);m.uniform1f(j.alpha,i.worldAlpha*n.alpha);m.bindBuffer(m.ARRAY_BUFFER,n.buffer);m.vertexAttribPointer(j.aVertexPosition,2,m.FLOAT,false,4*2,0);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,n.indexBuffer)}else{j=k.shaderManager.primitiveShader;k.shaderManager.setShader(j);m.uniformMatrix3fv(j.translationMatrix,false,i.worldTransform.toArray(true));m.uniform2f(j.projectionVector,h.x,-h.y);m.uniform2f(j.offsetVector,-l.x,-l.y);m.uniform3fv(j.tintColor,g.hex2rgb(i.tint));m.uniform1f(j.alpha,i.worldAlpha);m.bindBuffer(m.ARRAY_BUFFER,n.buffer);m.vertexAttribPointer(j.aVertexPosition,2,m.FLOAT,false,4*6,0);m.vertexAttribPointer(j.colorAttribute,4,m.FLOAT,false,4*6,2*4);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,n.indexBuffer)}};g.WebGLStencilManager.prototype.popStencil=function(h,k,i){var j=this.gl;this.stencilStack.pop();this.count--;if(this.stencilStack.length===0){j.disable(j.STENCIL_TEST)}else{var l=this.count;this.bindGraphics(h,k,i);j.colorMask(false,false,false,false);if(k.mode===1){this.reverse=!this.reverse;if(this.reverse){j.stencilFunc(j.EQUAL,255-(l+1),255);j.stencilOp(j.KEEP,j.KEEP,j.INCR)}else{j.stencilFunc(j.EQUAL,l+1,255);j.stencilOp(j.KEEP,j.KEEP,j.DECR)}j.drawElements(j.TRIANGLE_FAN,4,j.UNSIGNED_SHORT,(k.indices.length-4)*2);j.stencilFunc(j.ALWAYS,0,255);j.stencilOp(j.KEEP,j.KEEP,j.INVERT);j.drawElements(j.TRIANGLE_FAN,k.indices.length-4,j.UNSIGNED_SHORT,0);if(!this.reverse){j.stencilFunc(j.EQUAL,255-(l),255)}else{j.stencilFunc(j.EQUAL,l,255)}}else{if(!this.reverse){j.stencilFunc(j.EQUAL,255-(l+1),255);j.stencilOp(j.KEEP,j.KEEP,j.INCR)}else{j.stencilFunc(j.EQUAL,l+1,255);j.stencilOp(j.KEEP,j.KEEP,j.DECR)}j.drawElements(j.TRIANGLE_STRIP,k.indices.length,j.UNSIGNED_SHORT,0);if(!this.reverse){j.stencilFunc(j.EQUAL,255-(l),255)}else{j.stencilFunc(j.EQUAL,l,255)}}j.colorMask(true,true,true,true);j.stencilOp(j.KEEP,j.KEEP,j.KEEP)}};g.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null;this.gl=null};g.WebGLShaderManager=function(){this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var h=0;h<this.maxAttibs;h++){this.attribState[h]=false}this.stack=[]};g.WebGLShaderManager.prototype.constructor=g.WebGLShaderManager;g.WebGLShaderManager.prototype.setContext=function(h){this.gl=h;this.primitiveShader=new g.PrimitiveShader(h);this.complexPrimitiveShader=new g.ComplexPrimitiveShader(h);this.defaultShader=new g.PixiShader(h);this.fastShader=new g.PixiFastShader(h);this.stripShader=new g.StripShader(h);this.setShader(this.defaultShader)};g.WebGLShaderManager.prototype.setAttribs=function(l){var j;for(j=0;j<this.tempAttribState.length;j++){this.tempAttribState[j]=false}for(j=0;j<l.length;j++){var h=l[j];this.tempAttribState[h]=true}var k=this.gl;for(j=0;j<this.attribState.length;j++){if(this.attribState[j]!==this.tempAttribState[j]){this.attribState[j]=this.tempAttribState[j];if(this.tempAttribState[j]){k.enableVertexAttribArray(j)}else{k.disableVertexAttribArray(j)}}}};g.WebGLShaderManager.prototype.setShader=function(h){if(this._currentId===h._UID){return false}this._currentId=h._UID;this.currentShader=h;this.gl.useProgram(h.program);this.setAttribs(h.attributes);return true};g.WebGLShaderManager.prototype.destroy=function(){this.attribState=null;this.tempAttribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();this.gl=null};g.WebGLSpriteBatch=function(){this.vertSize=6;this.size=2000;var h=this.size*4*this.vertSize;var m=this.size*6;this.vertices=new g.Float32Array(h);this.indices=new g.Uint16Array(m);this.lastIndexCount=0;for(var l=0,k=0;l<m;l+=6,k+=4){this.indices[l+0]=k+0;this.indices[l+1]=k+1;this.indices[l+2]=k+2;this.indices[l+3]=k+0;this.indices[l+4]=k+2;this.indices[l+5]=k+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.dirty=true;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.defaultShader=new g.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])};g.WebGLSpriteBatch.prototype.setContext=function(i){this.gl=i;this.vertexBuffer=i.createBuffer();this.indexBuffer=i.createBuffer();i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer);i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.indices,i.STATIC_DRAW);i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer);i.bufferData(i.ARRAY_BUFFER,this.vertices,i.DYNAMIC_DRAW);this.currentBlendMode=99999;var h=new g.PixiShader(i);h.fragmentSrc=this.defaultShader.fragmentSrc;h.uniforms={};h.init();this.defaultShader.shaders[i.id]=h};g.WebGLSpriteBatch.prototype.begin=function(h){this.renderSession=h;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};g.WebGLSpriteBatch.prototype.end=function(){this.flush()};g.WebGLSpriteBatch.prototype.render=function(t){var s=t.texture;if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=s.baseTexture}var p=s._uvs;if(!p){return}var k=t.worldAlpha;var m=t.tint;var i=this.vertices;var j=t.anchor.x;var h=t.anchor.y;var r,q,o,n;if(s.trim){var w=s.trim;q=w.x-j*w.width;r=q+s.crop.width;n=w.y-h*w.height;o=n+s.crop.height}else{r=(s.frame.width)*(1-j);q=(s.frame.width)*-j;o=s.frame.height*(1-h);n=s.frame.height*-h}var l=this.currentBatchSize*4*this.vertSize;var u=s.baseTexture.resolution;var v=t.worldTransform;var C=v.a/u;var A=v.b/u;var y=v.c/u;var x=v.d/u;var B=v.tx;var z=v.ty;i[l++]=C*q+y*n+B;i[l++]=x*n+A*q+z;i[l++]=p.x0;i[l++]=p.y0;i[l++]=k;i[l++]=m;i[l++]=C*r+y*n+B;i[l++]=x*n+A*r+z;i[l++]=p.x1;i[l++]=p.y1;i[l++]=k;i[l++]=m;i[l++]=C*r+y*o+B;i[l++]=x*o+A*r+z;i[l++]=p.x2;i[l++]=p.y2;i[l++]=k;i[l++]=m;i[l++]=C*q+y*o+B;i[l++]=x*o+A*q+z;i[l++]=p.x3;i[l++]=p.y3;i[l++]=k;i[l++]=m;this.sprites[this.currentBatchSize++]=t};g.WebGLSpriteBatch.prototype.renderTilingSprite=function(j){var t=j.tilingTexture;if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=t.baseTexture}if(!j._uvs){j._uvs=new g.TextureUvs()}var q=j._uvs;j.tilePosition.x%=t.baseTexture.width*j.tileScaleOffset.x;j.tilePosition.y%=t.baseTexture.height*j.tileScaleOffset.y;var z=j.tilePosition.x/(t.baseTexture.width*j.tileScaleOffset.x);var y=j.tilePosition.y/(t.baseTexture.height*j.tileScaleOffset.y);var F=(j.width/t.baseTexture.width)/(j.tileScale.x*j.tileScaleOffset.x);var C=(j.height/t.baseTexture.height)/(j.tileScale.y*j.tileScaleOffset.y);q.x0=0-z;q.y0=0-y;q.x1=(1*F)-z;q.y1=0-y;q.x2=(1*F)-z;q.y2=(1*C)-y;q.x3=0-z;q.y3=(1*C)-y;var l=j.worldAlpha;var n=j.tint;var i=this.vertices;var v=j.width;var u=j.height;var k=j.anchor.x;var h=j.anchor.y;var s=v*(1-k);var r=v*-k;var p=u*(1-h);var o=u*-h;var m=this.currentBatchSize*4*this.vertSize;var w=t.baseTexture.resolution;var x=j.worldTransform;var H=x.a/w;var E=x.b/w;var B=x.c/w;var A=x.d/w;var G=x.tx;var D=x.ty;i[m++]=H*r+B*o+G;i[m++]=A*o+E*r+D;i[m++]=q.x0;i[m++]=q.y0;i[m++]=l;i[m++]=n;i[m++]=(H*s+B*o+G);i[m++]=A*o+E*s+D;i[m++]=q.x1;i[m++]=q.y1;i[m++]=l;i[m++]=n;i[m++]=H*s+B*p+G;i[m++]=A*p+E*s+D;i[m++]=q.x2;i[m++]=q.y2;i[m++]=l;i[m++]=n;i[m++]=H*r+B*p+G;i[m++]=A*p+E*r+D;i[m++]=q.x3;i[m++]=q.y3;i[m++]=l;i[m++]=n;this.sprites[this.currentBatchSize++]=j};g.WebGLSpriteBatch.prototype.flush=function(){if(this.currentBatchSize===0){return}var x=this.gl;var h;if(this.dirty){this.dirty=false;x.activeTexture(x.TEXTURE0);x.bindBuffer(x.ARRAY_BUFFER,this.vertexBuffer);x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,this.indexBuffer);h=this.defaultShader.shaders[x.id];var s=this.vertSize*4;x.vertexAttribPointer(h.aVertexPosition,2,x.FLOAT,false,s,0);x.vertexAttribPointer(h.aTextureCoord,2,x.FLOAT,false,s,2*4);x.vertexAttribPointer(h.colorAttribute,2,x.FLOAT,false,s,4*4)}if(this.currentBatchSize>(this.size*0.5)){x.bufferSubData(x.ARRAY_BUFFER,0,this.vertices)}else{var p=this.vertices.subarray(0,this.currentBatchSize*4*this.vertSize);x.bufferSubData(x.ARRAY_BUFFER,0,p)}var v,A,o;var t=0;var n=0;var z=null;var q=this.renderSession.blendModeManager.currentBlendMode;var k=null;var m=false;var l=false;var r;for(var y=0,w=this.currentBatchSize;y<w;y++){r=this.sprites[y];v=r.texture.baseTexture;A=r.blendMode;o=r.shader||this.defaultShader;m=q!==A;l=k!==o;if(z!==v||m||l){this.renderBatch(z,t,n);n=y;t=0;z=v;if(m){q=A;this.renderSession.blendModeManager.setBlendMode(q)}if(l){k=o;h=k.shaders[x.id];if(!h){h=new g.PixiShader(x);h.fragmentSrc=k.fragmentSrc;h.uniforms=k.uniforms;h.init();k.shaders[x.id]=h}this.renderSession.shaderManager.setShader(h);if(h.dirty){h.syncUniforms()}var B=this.renderSession.projection;x.uniform2f(h.projectionVector,B.x,B.y);var u=this.renderSession.offset;x.uniform2f(h.offsetVector,u.x,u.y)}}t++}this.renderBatch(z,t,n);this.currentBatchSize=0};g.WebGLSpriteBatch.prototype.renderBatch=function(i,h,k){if(h===0){return}var j=this.gl;if(i._dirty[j.id]){this.renderSession.renderer.updateTexture(i)}else{j.bindTexture(j.TEXTURE_2D,i._glTextures[j.id])}j.drawElements(j.TRIANGLES,h*6,j.UNSIGNED_SHORT,k*6*2);this.renderSession.drawCount++};g.WebGLSpriteBatch.prototype.stop=function(){this.flush();this.dirty=true};g.WebGLSpriteBatch.prototype.start=function(){this.dirty=true};g.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null;this.indices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.currentBaseTexture=null;this.gl=null};g.WebGLFastSpriteBatch=function(n){this.vertSize=10;this.maxSize=6000;this.size=this.maxSize;var h=this.size*4*this.vertSize;var m=this.maxSize*6;this.vertices=new g.Float32Array(h);this.indices=new g.Uint16Array(m);this.vertexBuffer=null;this.indexBuffer=null;this.lastIndexCount=0;for(var l=0,k=0;l<m;l+=6,k+=4){this.indices[l+0]=k+0;this.indices[l+1]=k+1;this.indices[l+2]=k+2;this.indices[l+3]=k+0;this.indices[l+4]=k+2;this.indices[l+5]=k+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=0;this.renderSession=null;this.shader=null;this.matrix=null;this.setContext(n)};g.WebGLFastSpriteBatch.prototype.constructor=g.WebGLFastSpriteBatch;g.WebGLFastSpriteBatch.prototype.setContext=function(h){this.gl=h;this.vertexBuffer=h.createBuffer();this.indexBuffer=h.createBuffer();h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.indexBuffer);h.bufferData(h.ELEMENT_ARRAY_BUFFER,this.indices,h.STATIC_DRAW);h.bindBuffer(h.ARRAY_BUFFER,this.vertexBuffer);h.bufferData(h.ARRAY_BUFFER,this.vertices,h.DYNAMIC_DRAW)};g.WebGLFastSpriteBatch.prototype.begin=function(h,i){this.renderSession=i;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=h.worldTransform.toArray(true);this.start()};g.WebGLFastSpriteBatch.prototype.end=function(){this.flush()};g.WebGLFastSpriteBatch.prototype.render=function(h){var n=h.children;var m=n[0];if(!m.texture._uvs){return}this.currentBaseTexture=m.texture.baseTexture;if(m.blendMode!==this.renderSession.blendModeManager.currentBlendMode){this.flush();this.renderSession.blendModeManager.setBlendMode(m.blendMode)}for(var l=0,k=n.length;l<k;l++){this.renderSprite(n[l])}this.flush()};g.WebGLFastSpriteBatch.prototype.renderSprite=function(q){if(!q.visible){return}if(q.texture.baseTexture!==this.currentBaseTexture){this.flush();this.currentBaseTexture=q.texture.baseTexture;if(!q.texture._uvs){return}}var k,i=this.vertices,h,r,m,l,p,o,n;k=q.texture._uvs;h=q.texture.frame.width;r=q.texture.frame.height;if(q.texture.trim){var j=q.texture.trim;l=j.x-q.anchor.x*j.width;m=l+q.texture.crop.width;o=j.y-q.anchor.y*j.height;p=o+q.texture.crop.height}else{m=(q.texture.frame.width)*(1-q.anchor.x);l=(q.texture.frame.width)*-q.anchor.x;p=q.texture.frame.height*(1-q.anchor.y);o=q.texture.frame.height*-q.anchor.y}n=this.currentBatchSize*4*this.vertSize;i[n++]=l;i[n++]=o;i[n++]=q.position.x;i[n++]=q.position.y;i[n++]=q.scale.x;i[n++]=q.scale.y;i[n++]=q.rotation;i[n++]=k.x0;i[n++]=k.y1;i[n++]=q.alpha;i[n++]=m;i[n++]=o;i[n++]=q.position.x;i[n++]=q.position.y;i[n++]=q.scale.x;i[n++]=q.scale.y;i[n++]=q.rotation;i[n++]=k.x1;i[n++]=k.y1;i[n++]=q.alpha;i[n++]=m;i[n++]=p;i[n++]=q.position.x;i[n++]=q.position.y;i[n++]=q.scale.x;i[n++]=q.scale.y;i[n++]=q.rotation;i[n++]=k.x2;i[n++]=k.y2;i[n++]=q.alpha;i[n++]=l;i[n++]=p;i[n++]=q.position.x;i[n++]=q.position.y;i[n++]=q.scale.x;i[n++]=q.scale.y;i[n++]=q.rotation;i[n++]=k.x3;i[n++]=k.y3;i[n++]=q.alpha;this.currentBatchSize++;if(this.currentBatchSize>=this.size){this.flush()}};g.WebGLFastSpriteBatch.prototype.flush=function(){if(this.currentBatchSize===0){return}var i=this.gl;if(!this.currentBaseTexture._glTextures[i.id]){this.renderSession.renderer.updateTexture(this.currentBaseTexture,i)}i.bindTexture(i.TEXTURE_2D,this.currentBaseTexture._glTextures[i.id]);if(this.currentBatchSize>(this.size*0.5)){i.bufferSubData(i.ARRAY_BUFFER,0,this.vertices)}else{var h=this.vertices.subarray(0,this.currentBatchSize*4*this.vertSize);i.bufferSubData(i.ARRAY_BUFFER,0,h)}i.drawElements(i.TRIANGLES,this.currentBatchSize*6,i.UNSIGNED_SHORT,0);this.currentBatchSize=0;this.renderSession.drawCount++};g.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};g.WebGLFastSpriteBatch.prototype.start=function(){var j=this.gl;j.activeTexture(j.TEXTURE0);j.bindBuffer(j.ARRAY_BUFFER,this.vertexBuffer);j.bindBuffer(j.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var h=this.renderSession.projection;j.uniform2f(this.shader.projectionVector,h.x,h.y);j.uniformMatrix3fv(this.shader.uMatrix,false,this.matrix);var i=this.vertSize*4;j.vertexAttribPointer(this.shader.aVertexPosition,2,j.FLOAT,false,i,0);j.vertexAttribPointer(this.shader.aPositionCoord,2,j.FLOAT,false,i,2*4);j.vertexAttribPointer(this.shader.aScale,2,j.FLOAT,false,i,4*4);j.vertexAttribPointer(this.shader.aRotation,1,j.FLOAT,false,i,6*4);j.vertexAttribPointer(this.shader.aTextureCoord,2,j.FLOAT,false,i,7*4);j.vertexAttribPointer(this.shader.colorAttribute,1,j.FLOAT,false,i,9*4)};g.WebGLFilterManager=function(){this.filterStack=[];this.offsetX=0;this.offsetY=0};g.WebGLFilterManager.prototype.constructor=g.WebGLFilterManager;g.WebGLFilterManager.prototype.setContext=function(h){this.gl=h;this.texturePool=[];this.initShaderBuffers()};g.WebGLFilterManager.prototype.begin=function(j,i){this.renderSession=j;this.defaultShader=j.shaderManager.defaultShader;var h=this.renderSession.projection;this.width=h.x*2;this.height=-h.y*2;this.buffer=i};g.WebGLFilterManager.prototype.pushFilter=function(i){var o=this.gl;var h=this.renderSession.projection;var n=this.renderSession.offset;i._filterArea=i.target.filterArea||i.target.getBounds();this.filterStack.push(i);var j=i.filterPasses[0];this.offsetX+=i._filterArea.x;this.offsetY+=i._filterArea.y;var k=this.texturePool.pop();if(!k){k=new g.FilterTexture(this.gl,this.width,this.height)}else{k.resize(this.width,this.height)}o.bindTexture(o.TEXTURE_2D,k.texture);var l=i._filterArea;var m=j.padding;l.x-=m;l.y-=m;l.width+=m*2;l.height+=m*2;if(l.x<0){l.x=0}if(l.width>this.width){l.width=this.width}if(l.y<0){l.y=0}if(l.height>this.height){l.height=this.height}o.bindFramebuffer(o.FRAMEBUFFER,k.frameBuffer);o.viewport(0,0,l.width,l.height);h.x=l.width/2;h.y=-l.height/2;n.x=-l.x;n.y=-l.y;o.colorMask(true,true,true,true);o.clearColor(0,0,0,0);o.clear(o.COLOR_BUFFER_BIT);i._glFilterTexture=k};g.WebGLFilterManager.prototype.popFilter=function(){var u=this.gl;var r=this.filterStack.pop();var C=r._filterArea;var p=r._glFilterTexture;var D=this.renderSession.projection;var l=this.renderSession.offset;if(r.filterPasses.length>1){u.viewport(0,0,C.width,C.height);u.bindBuffer(u.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=0;this.vertexArray[1]=C.height;this.vertexArray[2]=C.width;this.vertexArray[3]=C.height;this.vertexArray[4]=0;this.vertexArray[5]=0;this.vertexArray[6]=C.width;this.vertexArray[7]=0;u.bufferSubData(u.ARRAY_BUFFER,0,this.vertexArray);u.bindBuffer(u.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=C.width/this.width;this.uvArray[5]=C.height/this.height;this.uvArray[6]=C.width/this.width;this.uvArray[7]=C.height/this.height;u.bufferSubData(u.ARRAY_BUFFER,0,this.uvArray);var w=p;var j=this.texturePool.pop();if(!j){j=new g.FilterTexture(this.gl,this.width,this.height)}j.resize(this.width,this.height);u.bindFramebuffer(u.FRAMEBUFFER,j.frameBuffer);u.clear(u.COLOR_BUFFER_BIT);u.disable(u.BLEND);for(var v=0;v<r.filterPasses.length-1;v++){var k=r.filterPasses[v];u.bindFramebuffer(u.FRAMEBUFFER,j.frameBuffer);u.activeTexture(u.TEXTURE0);u.bindTexture(u.TEXTURE_2D,w.texture);this.applyFilterPass(k,C,C.width,C.height);var B=w;w=j;j=B}u.enable(u.BLEND);p=w;this.texturePool.push(j)}var o=r.filterPasses[r.filterPasses.length-1];this.offsetX-=C.x;this.offsetY-=C.y;var s=this.width;var q=this.height;var A=0;var z=0;var t=this.buffer;if(this.filterStack.length===0){u.colorMask(true,true,true,true)}else{var h=this.filterStack[this.filterStack.length-1];C=h._filterArea;s=C.width;q=C.height;A=C.x;z=C.y;t=h._glFilterTexture.frameBuffer}D.x=s/2;D.y=-q/2;l.x=A;l.y=z;C=r._filterArea;var n=C.x-A;var m=C.y-z;u.bindBuffer(u.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=n;this.vertexArray[1]=m+C.height;this.vertexArray[2]=n+C.width;this.vertexArray[3]=m+C.height;this.vertexArray[4]=n;this.vertexArray[5]=m;this.vertexArray[6]=n+C.width;this.vertexArray[7]=m;u.bufferSubData(u.ARRAY_BUFFER,0,this.vertexArray);u.bindBuffer(u.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=C.width/this.width;this.uvArray[5]=C.height/this.height;this.uvArray[6]=C.width/this.width;this.uvArray[7]=C.height/this.height;u.bufferSubData(u.ARRAY_BUFFER,0,this.uvArray);u.viewport(0,0,s,q);u.bindFramebuffer(u.FRAMEBUFFER,t);u.activeTexture(u.TEXTURE0);u.bindTexture(u.TEXTURE_2D,p.texture);this.applyFilterPass(o,C,s,q);this.texturePool.push(p);r._glFilterTexture=null};g.WebGLFilterManager.prototype.applyFilterPass=function(j,l,i,h){var m=this.gl;var k=j.shaders[m.id];if(!k){k=new g.PixiShader(m);k.fragmentSrc=j.fragmentSrc;k.uniforms=j.uniforms;k.init();j.shaders[m.id]=k}this.renderSession.shaderManager.setShader(k);m.uniform2f(k.projectionVector,i/2,-h/2);m.uniform2f(k.offsetVector,0,0);if(j.uniforms.dimensions){j.uniforms.dimensions.value[0]=this.width;j.uniforms.dimensions.value[1]=this.height;j.uniforms.dimensions.value[2]=this.vertexArray[0];j.uniforms.dimensions.value[3]=this.vertexArray[5]}k.syncUniforms();m.bindBuffer(m.ARRAY_BUFFER,this.vertexBuffer);m.vertexAttribPointer(k.aVertexPosition,2,m.FLOAT,false,0,0);m.bindBuffer(m.ARRAY_BUFFER,this.uvBuffer);m.vertexAttribPointer(k.aTextureCoord,2,m.FLOAT,false,0,0);m.bindBuffer(m.ARRAY_BUFFER,this.colorBuffer);m.vertexAttribPointer(k.colorAttribute,2,m.FLOAT,false,0,0);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,this.indexBuffer);m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0);this.renderSession.drawCount++};g.WebGLFilterManager.prototype.initShaderBuffers=function(){var h=this.gl;this.vertexBuffer=h.createBuffer();this.uvBuffer=h.createBuffer();this.colorBuffer=h.createBuffer();this.indexBuffer=h.createBuffer();this.vertexArray=new g.Float32Array([0,0,1,0,0,1,1,1]);h.bindBuffer(h.ARRAY_BUFFER,this.vertexBuffer);h.bufferData(h.ARRAY_BUFFER,this.vertexArray,h.STATIC_DRAW);this.uvArray=new g.Float32Array([0,0,1,0,0,1,1,1]);h.bindBuffer(h.ARRAY_BUFFER,this.uvBuffer);h.bufferData(h.ARRAY_BUFFER,this.uvArray,h.STATIC_DRAW);this.colorArray=new g.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]);h.bindBuffer(h.ARRAY_BUFFER,this.colorBuffer);h.bufferData(h.ARRAY_BUFFER,this.colorArray,h.STATIC_DRAW);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.indexBuffer);h.bufferData(h.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),h.STATIC_DRAW)};g.WebGLFilterManager.prototype.destroy=function(){var j=this.gl;this.filterStack=null;this.offsetX=0;this.offsetY=0;for(var h=0;h<this.texturePool.length;h++){this.texturePool[h].destroy()}this.texturePool=null;j.deleteBuffer(this.vertexBuffer);j.deleteBuffer(this.uvBuffer);j.deleteBuffer(this.colorBuffer);j.deleteBuffer(this.indexBuffer)};g.FilterTexture=function(k,j,h,i){this.gl=k;this.frameBuffer=k.createFramebuffer();this.texture=k.createTexture();i=i||g.scaleModes.DEFAULT;k.bindTexture(k.TEXTURE_2D,this.texture);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,i===g.scaleModes.LINEAR?k.LINEAR:k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,i===g.scaleModes.LINEAR?k.LINEAR:k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.bindFramebuffer(k.FRAMEBUFFER,this.frameBuffer);k.bindFramebuffer(k.FRAMEBUFFER,this.frameBuffer);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,this.texture,0);this.renderBuffer=k.createRenderbuffer();k.bindRenderbuffer(k.RENDERBUFFER,this.renderBuffer);k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_STENCIL_ATTACHMENT,k.RENDERBUFFER,this.renderBuffer);this.resize(j,h)};g.FilterTexture.prototype.constructor=g.FilterTexture;g.FilterTexture.prototype.clear=function(){var h=this.gl;h.clearColor(0,0,0,0);h.clear(h.COLOR_BUFFER_BIT)};g.FilterTexture.prototype.resize=function(i,h){if(this.width===i&&this.height===h){return}this.width=i;this.height=h;var j=this.gl;j.bindTexture(j.TEXTURE_2D,this.texture);j.texImage2D(j.TEXTURE_2D,0,j.RGBA,i,h,0,j.RGBA,j.UNSIGNED_BYTE,null);j.bindRenderbuffer(j.RENDERBUFFER,this.renderBuffer);j.renderbufferStorage(j.RENDERBUFFER,j.DEPTH_STENCIL,i,h)};g.FilterTexture.prototype.destroy=function(){var h=this.gl;h.deleteFramebuffer(this.frameBuffer);h.deleteTexture(this.texture);this.frameBuffer=null;this.texture=null};g.CanvasBuffer=function(i,h){this.width=i;this.height=h;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=i;this.canvas.height=h};g.CanvasBuffer.prototype.constructor=g.CanvasBuffer;g.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,this.height)};g.CanvasBuffer.prototype.resize=function(i,h){this.width=this.canvas.width=i;this.height=this.canvas.height=h};g.CanvasMaskManager=function(){};g.CanvasMaskManager.prototype.constructor=g.CanvasMaskManager;g.CanvasMaskManager.prototype.pushMask=function(m,l){var k=l.context;k.save();var h=m.alpha;var j=m.worldTransform;var i=l.resolution;k.setTransform(j.a*i,j.b*i,j.c*i,j.d*i,j.tx*i,j.ty*i);g.CanvasGraphics.renderGraphicsMask(m,k);k.clip();m.worldAlpha=h};g.CanvasMaskManager.prototype.popMask=function(h){h.context.restore()};g.CanvasTinter=function(){};g.CanvasTinter.getTintedTexture=function(k,h){var m=k.texture;h=g.CanvasTinter.roundColor(h);var l="#"+("00000"+(h|0).toString(16)).substr(-6);m.tintCache=m.tintCache||{};if(m.tintCache[l]){return m.tintCache[l]}var i=g.CanvasTinter.canvas||document.createElement("canvas");g.CanvasTinter.tintMethod(m,h,i);if(g.CanvasTinter.convertTintToImage){var j=new Image();j.src=i.toDataURL();m.tintCache[l]=j}else{m.tintCache[l]=i;g.CanvasTinter.canvas=null}return i};g.CanvasTinter.tintWithMultiply=function(l,h,i){var j=i.getContext("2d");var k=l.crop;i.width=k.width;i.height=k.height;j.fillStyle="#"+("00000"+(h|0).toString(16)).substr(-6);j.fillRect(0,0,k.width,k.height);j.globalCompositeOperation="multiply";j.drawImage(l.baseTexture.source,k.x,k.y,k.width,k.height,0,0,k.width,k.height);j.globalCompositeOperation="destination-atop";j.drawImage(l.baseTexture.source,k.x,k.y,k.width,k.height,0,0,k.width,k.height)};g.CanvasTinter.tintWithOverlay=function(l,h,i){var j=i.getContext("2d");var k=l.crop;i.width=k.width;i.height=k.height;j.globalCompositeOperation="copy";j.fillStyle="#"+("00000"+(h|0).toString(16)).substr(-6);j.fillRect(0,0,k.width,k.height);j.globalCompositeOperation="destination-atop";j.drawImage(l.baseTexture.source,k.x,k.y,k.width,k.height,0,0,k.width,k.height)};g.CanvasTinter.tintWithPerPixel=function(s,n,l){var k=l.getContext("2d");var p=s.crop;l.width=p.width;l.height=p.height;k.globalCompositeOperation="copy";k.drawImage(s.baseTexture.source,p.x,p.y,p.width,p.height,0,0,p.width,p.height);var j=g.hex2rgb(n);var h=j[0],q=j[1],t=j[2];var u=k.getImageData(0,0,p.width,p.height);var m=u.data;for(var o=0;o<m.length;o+=4){m[o+0]*=h;m[o+1]*=q;m[o+2]*=t}k.putImageData(u,0,0)};g.CanvasTinter.roundColor=function(h){var i=g.CanvasTinter.cacheStepsPerColorChannel;var j=g.hex2rgb(h);j[0]=Math.min(255,(j[0]/i)*i);j[1]=Math.min(255,(j[1]/i)*i);j[2]=Math.min(255,(j[2]/i)*i);return g.rgb2hex(j)};g.CanvasTinter.cacheStepsPerColorChannel=8;g.CanvasTinter.convertTintToImage=false;g.CanvasTinter.canUseMultiply=g.canUseNewCanvasBlendModes();g.CanvasTinter.tintMethod=g.CanvasTinter.canUseMultiply?g.CanvasTinter.tintWithMultiply:g.CanvasTinter.tintWithPerPixel;g.CanvasRenderer=function(l,h,j){if(j){for(var k in g.defaultRenderOptions){if(typeof j[k]==="undefined"){j[k]=g.defaultRenderOptions[k]}}}else{j=g.defaultRenderOptions}if(!g.defaultRenderer){g.sayHello("Canvas");g.defaultRenderer=this}this.type=g.CANVAS_RENDERER;this.resolution=j.resolution;this.clearBeforeRender=j.clearBeforeRender;this.transparent=j.transparent;this.autoResize=j.autoResize||false;this.width=l||800;this.height=h||600;this.width*=this.resolution;this.height*=this.resolution;this.view=j.view||document.createElement("canvas");this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=true;this.view.width=this.width*this.resolution;this.view.height=this.height*this.resolution;this.count=0;this.maskManager=new g.CanvasMaskManager();this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:false};this.mapBlendModes();this.resize(l,h);if("imageSmoothingEnabled" in this.context){this.renderSession.smoothProperty="imageSmoothingEnabled"}else{if("webkitImageSmoothingEnabled" in this.context){this.renderSession.smoothProperty="webkitImageSmoothingEnabled"}else{if("mozImageSmoothingEnabled" in this.context){this.renderSession.smoothProperty="mozImageSmoothingEnabled"}else{if("oImageSmoothingEnabled" in this.context){this.renderSession.smoothProperty="oImageSmoothingEnabled"}else{if("msImageSmoothingEnabled" in this.context){this.renderSession.smoothProperty="msImageSmoothingEnabled"}}}}}};g.CanvasRenderer.prototype.constructor=g.CanvasRenderer;g.CanvasRenderer.prototype.render=function(h){h.updateTransform();this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.renderSession.currentBlendMode=g.blendModes.NORMAL;this.context.globalCompositeOperation=g.blendModesCanvas[g.blendModes.NORMAL];if(navigator.isCocoonJS&&this.view.screencanvas){this.context.fillStyle="black";this.context.clear()}if(this.clearBeforeRender){if(this.transparent){this.context.clearRect(0,0,this.width,this.height)}else{this.context.fillStyle=h.backgroundColorString;this.context.fillRect(0,0,this.width,this.height)}}this.renderDisplayObject(h);if(h.interactive){if(!h._interactiveEventsAdded){h._interactiveEventsAdded=true;h.interactionManager.setTarget(this)}}};g.CanvasRenderer.prototype.destroy=function(h){if(typeof h==="undefined"){h=true}if(h&&this.view.parent){this.view.parent.removeChild(this.view)}this.view=null;this.context=null;this.maskManager=null;this.renderSession=null};g.CanvasRenderer.prototype.resize=function(i,h){this.width=i*this.resolution;this.height=h*this.resolution;this.view.width=this.width;this.view.height=this.height;if(this.autoResize){this.view.style.width=this.width/this.resolution+"px";this.view.style.height=this.height/this.resolution+"px"}};g.CanvasRenderer.prototype.renderDisplayObject=function(i,h){this.renderSession.context=h||this.context;this.renderSession.resolution=this.resolution;i._renderCanvas(this.renderSession)};g.CanvasRenderer.prototype.mapBlendModes=function(){if(!g.blendModesCanvas){g.blendModesCanvas=[];if(g.canUseNewCanvasBlendModes()){g.blendModesCanvas[g.blendModes.NORMAL]="source-over";g.blendModesCanvas[g.blendModes.ADD]="lighter";g.blendModesCanvas[g.blendModes.MULTIPLY]="multiply";g.blendModesCanvas[g.blendModes.SCREEN]="screen";g.blendModesCanvas[g.blendModes.OVERLAY]="overlay";g.blendModesCanvas[g.blendModes.DARKEN]="darken";g.blendModesCanvas[g.blendModes.LIGHTEN]="lighten";g.blendModesCanvas[g.blendModes.COLOR_DODGE]="color-dodge";g.blendModesCanvas[g.blendModes.COLOR_BURN]="color-burn";g.blendModesCanvas[g.blendModes.HARD_LIGHT]="hard-light";g.blendModesCanvas[g.blendModes.SOFT_LIGHT]="soft-light";g.blendModesCanvas[g.blendModes.DIFFERENCE]="difference";g.blendModesCanvas[g.blendModes.EXCLUSION]="exclusion";g.blendModesCanvas[g.blendModes.HUE]="hue";g.blendModesCanvas[g.blendModes.SATURATION]="saturation";g.blendModesCanvas[g.blendModes.COLOR]="color";g.blendModesCanvas[g.blendModes.LUMINOSITY]="luminosity"}else{g.blendModesCanvas[g.blendModes.NORMAL]="source-over";g.blendModesCanvas[g.blendModes.ADD]="lighter";g.blendModesCanvas[g.blendModes.MULTIPLY]="source-over";g.blendModesCanvas[g.blendModes.SCREEN]="source-over";g.blendModesCanvas[g.blendModes.OVERLAY]="source-over";g.blendModesCanvas[g.blendModes.DARKEN]="source-over";g.blendModesCanvas[g.blendModes.LIGHTEN]="source-over";g.blendModesCanvas[g.blendModes.COLOR_DODGE]="source-over";g.blendModesCanvas[g.blendModes.COLOR_BURN]="source-over";g.blendModesCanvas[g.blendModes.HARD_LIGHT]="source-over";g.blendModesCanvas[g.blendModes.SOFT_LIGHT]="source-over";g.blendModesCanvas[g.blendModes.DIFFERENCE]="source-over";g.blendModesCanvas[g.blendModes.EXCLUSION]="source-over";g.blendModesCanvas[g.blendModes.HUE]="source-over";g.blendModesCanvas[g.blendModes.SATURATION]="source-over";g.blendModesCanvas[g.blendModes.COLOR]="source-over";g.blendModesCanvas[g.blendModes.LUMINOSITY]="source-over"}}};g.CanvasGraphics=function(){};g.CanvasGraphics.renderGraphics=function(K,m){var E=K.worldAlpha;var F="";for(var I=0;I<K.graphicsData.length;I++){var M=K.graphicsData[I];var l=M.shape;m.strokeStyle=F="#"+("00000"+(M.lineColor|0).toString(16)).substr(-6);m.lineWidth=M.lineWidth;if(M.type===g.Graphics.POLY){m.beginPath();var H=l.points;m.moveTo(H[0],H[1]);for(var G=1;G<H.length/2;G++){m.lineTo(H[G*2],H[G*2+1])}if(l.closed){m.lineTo(H[0],H[1])}if(H[0]===H[H.length-2]&&H[1]===H[H.length-1]){m.closePath()}if(M.fill){m.globalAlpha=M.fillAlpha*E;m.fillStyle=F="#"+("00000"+(M.fillColor|0).toString(16)).substr(-6);m.fill()}if(M.lineWidth){m.globalAlpha=M.lineAlpha*E;m.stroke()}}else{if(M.type===g.Graphics.RECT){if(M.fillColor||M.fillColor===0){m.globalAlpha=M.fillAlpha*E;m.fillStyle=F="#"+("00000"+(M.fillColor|0).toString(16)).substr(-6);m.fillRect(l.x,l.y,l.width,l.height)}if(M.lineWidth){m.globalAlpha=M.lineAlpha*E;m.strokeRect(l.x,l.y,l.width,l.height)}}else{if(M.type===g.Graphics.CIRC){m.beginPath();m.arc(l.x,l.y,l.radius,0,2*Math.PI);m.closePath();if(M.fill){m.globalAlpha=M.fillAlpha*E;m.fillStyle=F="#"+("00000"+(M.fillColor|0).toString(16)).substr(-6);m.fill()}if(M.lineWidth){m.globalAlpha=M.lineAlpha*E;m.stroke()}}else{if(M.type===g.Graphics.ELIP){var v=l.width*2;var J=l.height*2;var u=l.x-v/2;var t=l.y-J/2;m.beginPath();var z=0.5522848,q=(v/2)*z,o=(J/2)*z,D=u+v,k=t+J,A=u+v/2,L=t+J/2;m.moveTo(u,L);m.bezierCurveTo(u,L-o,A-q,t,A,t);m.bezierCurveTo(A+q,t,D,L-o,D,L);m.bezierCurveTo(D,L+o,A+q,k,A,k);m.bezierCurveTo(A-q,k,u,L+o,u,L);m.closePath();if(M.fill){m.globalAlpha=M.fillAlpha*E;m.fillStyle=F="#"+("00000"+(M.fillColor|0).toString(16)).substr(-6);m.fill()}if(M.lineWidth){m.globalAlpha=M.lineAlpha*E;m.stroke()}}else{if(M.type===g.Graphics.RREC){var r=l.x;var p=l.y;var C=l.width;var B=l.height;var n=l.radius;var s=Math.min(C,B)/2|0;n=n>s?s:n;m.beginPath();m.moveTo(r,p+n);m.lineTo(r,p+B-n);m.quadraticCurveTo(r,p+B,r+n,p+B);m.lineTo(r+C-n,p+B);m.quadraticCurveTo(r+C,p+B,r+C,p+B-n);m.lineTo(r+C,p+n);m.quadraticCurveTo(r+C,p,r+C-n,p);m.lineTo(r+n,p);m.quadraticCurveTo(r,p,r,p+n);m.closePath();if(M.fillColor||M.fillColor===0){m.globalAlpha=M.fillAlpha*E;m.fillStyle=F="#"+("00000"+(M.fillColor|0).toString(16)).substr(-6);m.fill()}if(M.lineWidth){m.globalAlpha=M.lineAlpha*E;m.stroke()}}}}}}}};g.CanvasGraphics.renderGraphicsMask=function(J,m){var H=J.graphicsData.length;if(H===0){return}if(H>1){H=1;window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object")}for(var G=0;G<1;G++){var L=J.graphicsData[G];var l=L.shape;if(L.type===g.Graphics.POLY){m.beginPath();var F=l.points;m.moveTo(F[0],F[1]);for(var E=1;E<F.length/2;E++){m.lineTo(F[E*2],F[E*2+1])}if(F[0]===F[F.length-2]&&F[1]===F[F.length-1]){m.closePath()}}else{if(L.type===g.Graphics.RECT){m.beginPath();m.rect(l.x,l.y,l.width,l.height);m.closePath()}else{if(L.type===g.Graphics.CIRC){m.beginPath();m.arc(l.x,l.y,l.radius,0,2*Math.PI);m.closePath()}else{if(L.type===g.Graphics.ELIP){var v=l.width*2;var I=l.height*2;var u=l.x-v/2;var t=l.y-I/2;m.beginPath();var z=0.5522848,q=(v/2)*z,o=(I/2)*z,D=u+v,k=t+I,A=u+v/2,K=t+I/2;m.moveTo(u,K);m.bezierCurveTo(u,K-o,A-q,t,A,t);m.bezierCurveTo(A+q,t,D,K-o,D,K);m.bezierCurveTo(D,K+o,A+q,k,A,k);m.bezierCurveTo(A-q,k,u,K+o,u,K);m.closePath()}else{if(L.type===g.Graphics.RREC){var M=l.points;var r=M[0];var p=M[1];var C=M[2];var B=M[3];var n=M[4];var s=Math.min(C,B)/2|0;n=n>s?s:n;m.beginPath();m.moveTo(r,p+n);m.lineTo(r,p+B-n);m.quadraticCurveTo(r,p+B,r+n,p+B);m.lineTo(r+C-n,p+B);m.quadraticCurveTo(r+C,p+B,r+C,p+B-n);m.lineTo(r+C,p+n);m.quadraticCurveTo(r+C,p,r+C-n,p);m.lineTo(r+n,p);m.quadraticCurveTo(r,p,r,p+n);m.closePath()}}}}}}};g.Graphics=function(){g.DisplayObjectContainer.call(this);this.renderable=true;this.fillAlpha=1;this.lineWidth=0;this.lineColor=0;this.graphicsData=[];this.tint=16777215;this.blendMode=g.blendModes.NORMAL;this.currentPath=null;this._webGL=[];this.isMask=false;this.boundsPadding=0;this._localBounds=new g.Rectangle(0,0,1,1);this.dirty=true;this.webGLDirty=false;this.cachedSpriteDirty=false};g.Graphics.prototype=Object.create(g.DisplayObjectContainer.prototype);g.Graphics.prototype.constructor=g.Graphics;Object.defineProperty(g.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(h){this._cacheAsBitmap=h;if(this._cacheAsBitmap){this._generateCachedSprite()}else{this.destroyCachedSprite();this.dirty=true}}});g.Graphics.prototype.lineStyle=function(h,i,j){this.lineWidth=h||0;this.lineColor=i||0;this.lineAlpha=(arguments.length<3)?1:j;if(this.currentPath){if(this.currentPath.shape.points.length){this.drawShape(new g.Polygon(this.currentPath.shape.points.slice(-2)));return this}this.currentPath.lineWidth=this.lineWidth;this.currentPath.lineColor=this.lineColor;this.currentPath.lineAlpha=this.lineAlpha}return this};g.Graphics.prototype.moveTo=function(h,i){this.drawShape(new g.Polygon([h,i]));return this};g.Graphics.prototype.lineTo=function(h,i){this.currentPath.shape.points.push(h,i);this.dirty=true;return this};g.Graphics.prototype.quadraticCurveTo=function(s,o,u,r){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points=[0,0]}}else{this.moveTo(0,0)}var h,p,k=20,v=this.currentPath.shape.points;if(v.length===0){this.moveTo(0,0)}var t=v[v.length-2];var q=v[v.length-1];var l=0;for(var m=1;m<=k;m++){l=m/k;h=t+((s-t)*l);p=q+((o-q)*l);v.push(h+(((s+((u-s)*l))-h)*l),p+(((o+((r-o)*l))-p)*l))}this.dirty=true;return this};g.Graphics.prototype.bezierCurveTo=function(x,t,w,p,z,v){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points=[0,0]}}else{this.moveTo(0,0)}var m=20,k,l,h,s,r,A=this.currentPath.shape.points;var y=A[A.length-2];var u=A[A.length-1];var o=0;for(var q=1;q<=m;q++){o=q/m;k=(1-o);l=k*k;h=l*k;s=o*o;r=s*o;A.push(h*y+3*l*o*x+3*k*s*w+r*z,h*u+3*l*o*t+3*k*s*p+r*v)}this.dirty=true;return this};g.Graphics.prototype.arcTo=function(D,n,C,l,o){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points.push(D,n)}}else{this.moveTo(D,n)}var A=this.currentPath.shape.points;var v=A[A.length-2];var t=A[A.length-1];var I=t-n;var q=v-D;var H=l-n;var p=C-D;var B=Math.abs(I*p-q*H);if(B<1e-8||o===0){if(A[A.length-2]!==D||A[A.length-1]!==n){A.push(D,n)}}else{var G=I*I+q*q;var x=H*H+p*p;var i=I*H+q*p;var s=o*Math.sqrt(G)/B;var r=o*Math.sqrt(x)/B;var j=s*i/G;var h=r*i/x;var m=s*p+r*q;var k=s*H+r*I;var w=q*(r+j);var u=I*(r+j);var F=p*(s+h);var E=H*(s+h);var z=Math.atan2(u-k,w-m);var y=Math.atan2(E-k,F-m);this.arc(m+D,k+n,o,z,y,q*H>p*I)}this.dirty=true;return this};g.Graphics.prototype.arc=function(k,j,l,w,u,h){var C=k+Math.cos(w)*l;var A=j+Math.sin(w)*l;var z=this.currentPath.shape.points;if(z.length===0){this.moveTo(C,A);z=this.currentPath.shape.points}else{if(z[z.length-2]!==C||z[z.length-1]!==A){z.push(C,A)}}if(w===u){return this}if(!h&&u<=w){u+=Math.PI*2}else{if(h&&w<=u){w+=Math.PI*2}}var p=h?(w-u)*-1:(u-w);var t=(Math.abs(p)/(Math.PI*2))*40;if(p===0){return this}var m=p/(t*2);var r=m*2;var v=Math.cos(m);var x=Math.sin(m);var E=t-1;var n=(E%1)/E;for(var y=0;y<=E;y++){var q=y+n*y;var B=((m)+w+(r*q));var D=Math.cos(B);var o=-Math.sin(B);z.push(((v*D)+(x*o))*l+k,((v*-o)+(x*D))*l+j)}this.dirty=true;return this};g.Graphics.prototype.beginFill=function(h,i){this.filling=true;this.fillColor=h||0;this.fillAlpha=(i===undefined)?1:i;if(this.currentPath){if(this.currentPath.shape.points.length<=2){this.currentPath.fill=this.filling;this.currentPath.fillColor=this.fillColor;this.currentPath.fillAlpha=this.fillAlpha}}return this};g.Graphics.prototype.endFill=function(){this.filling=false;this.fillColor=null;this.fillAlpha=1;return this};g.Graphics.prototype.drawRect=function(i,k,j,h){this.drawShape(new g.Rectangle(i,k,j,h));return this};g.Graphics.prototype.drawRoundedRect=function(j,l,k,i,h){this.drawShape(new g.RoundedRectangle(j,l,k,i,h));return this};g.Graphics.prototype.drawCircle=function(i,j,h){this.drawShape(new g.Circle(i,j,h));return this};g.Graphics.prototype.drawEllipse=function(i,k,j,h){this.drawShape(new g.Ellipse(i,k,j,h));return this};g.Graphics.prototype.drawPolygon=function(h){if(!(h instanceof Array)){h=Array.prototype.slice.call(arguments)}this.drawShape(new g.Polygon(h));return this};g.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=false;this.dirty=true;this.clearDirty=true;this.graphicsData=[];return this};g.Graphics.prototype.generateTexture=function(h,j){h=h||1;var l=this.getBounds();var i=new g.CanvasBuffer(l.width*h,l.height*h);var k=g.Texture.fromCanvas(i.canvas,j);k.baseTexture.resolution=h;i.context.scale(h,h);i.context.translate(-l.x,-l.y);g.CanvasGraphics.renderGraphics(this,i.context);return k};g.Graphics.prototype._renderWebGL=function(l){if(this.visible===false||this.alpha===0||this.isMask===true){return}if(this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty){this._generateCachedSprite();this.updateCachedSpriteTexture();this.cachedSpriteDirty=false;this.dirty=false}this._cachedSprite.worldAlpha=this.worldAlpha;g.Sprite.prototype._renderWebGL.call(this._cachedSprite,l);return}else{l.spriteBatch.stop();l.blendModeManager.setBlendMode(this.blendMode);if(this._mask){l.maskManager.pushMask(this._mask,l)}if(this._filters){l.filterManager.pushFilter(this._filterBlock)}if(this.blendMode!==l.spriteBatch.currentBlendMode){l.spriteBatch.currentBlendMode=this.blendMode;var m=g.blendModesWebGL[l.spriteBatch.currentBlendMode];l.spriteBatch.gl.blendFunc(m[0],m[1])}if(this.webGLDirty){this.dirty=true;this.webGLDirty=false}g.WebGLGraphics.renderGraphics(this,l);if(this.children.length){l.spriteBatch.start();for(var k=0,h=this.children.length;k<h;k++){this.children[k]._renderWebGL(l)}l.spriteBatch.stop()}if(this._filters){l.filterManager.popFilter()}if(this._mask){l.maskManager.popMask(this.mask,l)}l.drawCount++;l.spriteBatch.start()}};g.Graphics.prototype._renderCanvas=function(o){if(this.visible===false||this.alpha===0||this.isMask===true){return}if(this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty){this._generateCachedSprite();this.updateCachedSpriteTexture();this.cachedSpriteDirty=false;this.dirty=false}this._cachedSprite.alpha=this.alpha;g.Sprite.prototype._renderCanvas.call(this._cachedSprite,o);return}else{var n=o.context;var l=this.worldTransform;if(this.blendMode!==o.currentBlendMode){o.currentBlendMode=this.blendMode;n.globalCompositeOperation=g.blendModesCanvas[o.currentBlendMode]}if(this._mask){o.maskManager.pushMask(this._mask,o)}var k=o.resolution;n.setTransform(l.a*k,l.b*k,l.c*k,l.d*k,l.tx*k,l.ty*k);g.CanvasGraphics.renderGraphics(this,n);for(var m=0,h=this.children.length;m<h;m++){this.children[m]._renderCanvas(o)}if(this._mask){o.maskManager.popMask(o)}}};g.Graphics.prototype.getBounds=function(s){if(this.isMask){return g.EmptyRectangle}if(this.dirty){this.updateLocalBounds();this.webGLDirty=true;this.cachedSpriteDirty=true;this.dirty=false}var l=this._localBounds;var p=l.x;var o=l.width+l.x;var n=l.y;var m=l.height+l.y;var q=s||this.worldTransform;var E=q.a;var C=q.b;var B=q.c;var z=q.d;var F=q.tx;var D=q.ty;var v=E*o+B*m+F;var k=z*m+C*o+D;var u=E*p+B*m+F;var j=z*m+C*p+D;var t=E*p+B*n+F;var i=z*n+C*p+D;var r=E*o+B*n+F;var h=z*n+C*o+D;var y=v;var w=k;var A=v;var x=k;A=u<A?u:A;A=t<A?t:A;A=r<A?r:A;x=j<x?j:x;x=i<x?i:x;x=h<x?h:x;y=u>y?u:y;y=t>y?t:y;y=r>y?r:y;w=j>w?j:w;w=i>w?i:w;w=h>w?h:w;this._bounds.x=A;this._bounds.width=y-A;this._bounds.y=x;this._bounds.height=w-x;return this._bounds};g.Graphics.prototype.updateLocalBounds=function(){var n=Infinity;var l=-Infinity;var m=Infinity;var k=-Infinity;if(this.graphicsData.length){var t,C,A,v,B,r;for(var q=0;q<this.graphicsData.length;q++){var p=this.graphicsData[q];var u=p.type;var s=p.lineWidth;t=p.shape;if(u===g.Graphics.RECT||u===g.Graphics.RREC){A=t.x-s/2;v=t.y-s/2;B=t.width+s;r=t.height+s;n=A<n?A:n;l=A+B>l?A+B:l;m=v<m?v:m;k=v+r>k?v+r:k}else{if(u===g.Graphics.CIRC){A=t.x;v=t.y;B=t.radius+s/2;r=t.radius+s/2;n=A-B<n?A-B:n;l=A+B>l?A+B:l;m=v-r<m?v-r:m;k=v+r>k?v+r:k}else{if(u===g.Graphics.ELIP){A=t.x;v=t.y;B=t.width+s/2;r=t.height+s/2;n=A-B<n?A-B:n;l=A+B>l?A+B:l;m=v-r<m?v-r:m;k=v+r>k?v+r:k}else{C=t.points;for(var o=0;o<C.length;o+=2){A=C[o];v=C[o+1];n=A-s<n?A-s:n;l=A+s>l?A+s:l;m=v-s<m?v-s:m;k=v+s>k?v+s:k}}}}}}else{n=0;l=0;m=0;k=0}var z=this.boundsPadding;this._localBounds.x=n-z;this._localBounds.width=(l-n)+z*2;this._localBounds.y=m-z;this._localBounds.height=(k-m)+z*2};g.Graphics.prototype._generateCachedSprite=function(){var j=this.getLocalBounds();if(!this._cachedSprite){var h=new g.CanvasBuffer(j.width,j.height);var i=g.Texture.fromCanvas(h.canvas);this._cachedSprite=new g.Sprite(i);this._cachedSprite.buffer=h;this._cachedSprite.worldTransform=this.worldTransform}else{this._cachedSprite.buffer.resize(j.width,j.height)}this._cachedSprite.anchor.x=-(j.x/j.width);this._cachedSprite.anchor.y=-(j.y/j.height);this._cachedSprite.buffer.context.translate(-j.x,-j.y);this.worldAlpha=1;g.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context);this._cachedSprite.alpha=this.alpha};g.Graphics.prototype.updateCachedSpriteTexture=function(){var j=this._cachedSprite;var i=j.texture;var h=j.buffer.canvas;i.baseTexture.width=h.width;i.baseTexture.height=h.height;i.crop.width=i.frame.width=h.width;i.crop.height=i.frame.height=h.height;j._width=h.width;j._height=h.height;i.baseTexture.dirty()};g.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(true);this._cachedSprite=null};g.Graphics.prototype.drawShape=function(h){if(this.currentPath){if(this.currentPath.shape.points.length<=2){this.graphicsData.pop()}}this.currentPath=null;var i=new g.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,h);this.graphicsData.push(i);if(i.type===g.Graphics.POLY){i.shape.closed=this.filling;this.currentPath=i}this.dirty=true;return i};g.GraphicsData=function(h,m,j,n,k,l,i){this.lineWidth=h;this.lineColor=m;this.lineAlpha=j;this.fillColor=n;this.fillAlpha=k;this.fill=l;this.shape=i;this.type=i.type};g.Graphics.POLY=0;g.Graphics.RECT=1;g.Graphics.CIRC=2;g.Graphics.ELIP=3;g.Graphics.RREC=4;g.Polygon.prototype.type=g.Graphics.POLY;g.Rectangle.prototype.type=g.Graphics.RECT;g.Circle.prototype.type=g.Graphics.CIRC;g.Ellipse.prototype.type=g.Graphics.ELIP;g.RoundedRectangle.prototype.type=g.Graphics.RREC;g.Strip=function(h){g.DisplayObjectContainer.call(this);this.texture=h;this.uvs=new g.Float32Array([0,1,1,1,1,0,0,1]);this.verticies=new g.Float32Array([0,0,100,0,100,100,0,100]);this.colors=new g.Float32Array([1,1,1,1]);this.indices=new g.Uint16Array([0,1,2,3]);this.dirty=true;this.blendMode=g.blendModes.NORMAL;this.padding=0};g.Strip.prototype=Object.create(g.DisplayObjectContainer.prototype);g.Strip.prototype.constructor=g.Strip;g.Strip.prototype._renderWebGL=function(h){if(!this.visible||this.alpha<=0){return}h.spriteBatch.stop();if(!this._vertexBuffer){this._initWebGL(h)}h.shaderManager.setShader(h.shaderManager.stripShader);this._renderStrip(h);h.spriteBatch.start()};g.Strip.prototype._initWebGL=function(h){var i=h.gl;this._vertexBuffer=i.createBuffer();this._indexBuffer=i.createBuffer();this._uvBuffer=i.createBuffer();this._colorBuffer=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,this._vertexBuffer);i.bufferData(i.ARRAY_BUFFER,this.verticies,i.DYNAMIC_DRAW);i.bindBuffer(i.ARRAY_BUFFER,this._uvBuffer);i.bufferData(i.ARRAY_BUFFER,this.uvs,i.STATIC_DRAW);i.bindBuffer(i.ARRAY_BUFFER,this._colorBuffer);i.bufferData(i.ARRAY_BUFFER,this.colors,i.STATIC_DRAW);i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._indexBuffer);i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.indices,i.STATIC_DRAW)};g.Strip.prototype._renderStrip=function(j){var l=j.gl;var h=j.projection,k=j.offset,i=j.shaderManager.stripShader;j.blendModeManager.setBlendMode(this.blendMode);l.uniformMatrix3fv(i.translationMatrix,false,this.worldTransform.toArray(true));l.uniform2f(i.projectionVector,h.x,-h.y);l.uniform2f(i.offsetVector,-k.x,-k.y);l.uniform1f(i.alpha,this.worldAlpha);if(!this.dirty){l.bindBuffer(l.ARRAY_BUFFER,this._vertexBuffer);l.bufferSubData(l.ARRAY_BUFFER,0,this.verticies);l.vertexAttribPointer(i.aVertexPosition,2,l.FLOAT,false,0,0);l.bindBuffer(l.ARRAY_BUFFER,this._uvBuffer);l.vertexAttribPointer(i.aTextureCoord,2,l.FLOAT,false,0,0);l.activeTexture(l.TEXTURE0);if(this.texture.baseTexture._dirty[l.id]){j.renderer.updateTexture(this.texture.baseTexture)}else{l.bindTexture(l.TEXTURE_2D,this.texture.baseTexture._glTextures[l.id])}l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this._indexBuffer)}else{this.dirty=false;l.bindBuffer(l.ARRAY_BUFFER,this._vertexBuffer);l.bufferData(l.ARRAY_BUFFER,this.verticies,l.STATIC_DRAW);l.vertexAttribPointer(i.aVertexPosition,2,l.FLOAT,false,0,0);l.bindBuffer(l.ARRAY_BUFFER,this._uvBuffer);l.bufferData(l.ARRAY_BUFFER,this.uvs,l.STATIC_DRAW);l.vertexAttribPointer(i.aTextureCoord,2,l.FLOAT,false,0,0);l.activeTexture(l.TEXTURE0);if(this.texture.baseTexture._dirty[l.id]){j.renderer.updateTexture(this.texture.baseTexture)}else{l.bindTexture(l.TEXTURE_2D,this.texture.baseTexture._glTextures[l.id])}l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this._indexBuffer);l.bufferData(l.ELEMENT_ARRAY_BUFFER,this.indices,l.STATIC_DRAW)}l.drawElements(l.TRIANGLE_STRIP,this.indices.length,l.UNSIGNED_SHORT,0)};g.Strip.prototype._renderCanvas=function(r){var m=r.context;var C=this.worldTransform;if(r.roundPixels){m.setTransform(C.a,C.b,C.c,C.d,C.tx|0,C.ty|0)}else{m.setTransform(C.a,C.b,C.c,C.d,C.tx,C.ty)}var E=this;var l=E.verticies;var B=E.uvs;var q=l.length/2;this.count++;for(var I=0;I<q-2;I++){var t=I*2;var N=l[t],M=l[t+2],K=l[t+4];var p=l[t+1],o=l[t+3],k=l[t+5];if(this.padding>0){var z=(N+M+K)/3;var x=(p+o+k)/3;var G=N-z;var F=p-x;var D=Math.sqrt(G*G+F*F);N=z+(G/D)*(D+3);p=x+(F/D)*(D+3);G=M-z;F=o-x;D=Math.sqrt(G*G+F*F);M=z+(G/D)*(D+3);o=x+(F/D)*(D+3);G=K-z;F=k-x;D=Math.sqrt(G*G+F*F);K=z+(G/D)*(D+3);k=x+(F/D)*(D+3)}var L=B[t]*E.texture.width,J=B[t+2]*E.texture.width,H=B[t+4]*E.texture.width;var n=B[t+1]*E.texture.height,j=B[t+3]*E.texture.height,h=B[t+5]*E.texture.height;m.save();m.beginPath();m.moveTo(N,p);m.lineTo(M,o);m.lineTo(K,k);m.closePath();m.clip();var O=L*j+n*H+J*h-j*H-n*J-L*h;var A=N*j+n*K+M*h-j*K-n*M-N*h;var y=L*M+N*H+J*K-M*H-N*J-L*K;var w=L*j*K+n*M*H+N*J*h-N*j*H-n*J*K-L*M*h;var v=p*j+n*k+o*h-j*k-n*o-p*h;var u=L*o+p*H+J*k-o*H-p*J-L*k;var s=L*j*k+n*o*H+p*J*h-p*j*H-n*J*k-L*o*h;m.transform(A/O,v/O,y/O,u/O,w/O,s/O);m.drawImage(E.texture.baseTexture.source,0,0);m.restore()}};g.Strip.prototype.renderStripFlat=function(j){var k=this.context;var m=j.verticies;var n=m.length/2;this.count++;k.beginPath();for(var p=1;p<n-2;p++){var q=p*2;var o=m[q],l=m[q+2],h=m[q+4];var t=m[q+1],s=m[q+3],r=m[q+5];k.moveTo(o,t);k.lineTo(l,s);k.lineTo(h,r)}k.fillStyle="#FF0000";k.fill();k.closePath()};g.Strip.prototype.onTextureUpdate=function(){this.updateFrame=true};g.Rope=function(i,h){g.Strip.call(this,i);this.points=h;this.verticies=new g.Float32Array(h.length*4);this.uvs=new g.Float32Array(h.length*4);this.colors=new g.Float32Array(h.length*2);this.indices=new g.Uint16Array(h.length*2);this.refresh()};g.Rope.prototype=Object.create(g.Strip.prototype);g.Rope.prototype.constructor=g.Rope;g.Rope.prototype.refresh=function(){var q=this.points;if(q.length<1){return}var j=this.uvs;var o=q[0];var r=this.indices;var h=this.colors;this.count-=0.2;j[0]=0;j[1]=0;j[2]=0;j[3]=1;h[0]=1;h[1]=1;r[0]=0;r[1]=1;var n=q.length,p,m,l;for(var k=1;k<n;k++){p=q[k];m=k*4;l=k/(n-1);if(k%2){j[m]=l;j[m+1]=0;j[m+2]=l;j[m+3]=1}else{j[m]=l;j[m+1]=0;j[m+2]=l;j[m+3]=1}m=k*2;h[m]=1;h[m+1]=1;m=k*2;r[m]=m;r[m+1]=m+1;o=p}};g.Rope.prototype.updateTransform=function(){var t=this.points;if(t.length<1){return}var r=t[0];var p;var j={x:0,y:0};this.count-=0.2;var h=this.verticies;var q=t.length,s,n,o,k,m;for(var l=0;l<q;l++){s=t[l];n=l*4;if(l<t.length-1){p=t[l+1]}else{p=s}j.y=-(p.x-r.x);j.x=p.y-r.y;o=(1-(l/(q-1)))*10;if(o>1){o=1}k=Math.sqrt(j.x*j.x+j.y*j.y);m=this.texture.height/2;j.x/=k;j.y/=k;j.x*=m;j.y*=m;h[n]=s.x+j.x;h[n+1]=s.y+j.y;h[n+2]=s.x-j.x;h[n+3]=s.y-j.y;r=s}g.DisplayObjectContainer.prototype.updateTransform.call(this)};g.Rope.prototype.setTexture=function(h){this.texture=h};g.TilingSprite=function(j,i,h){g.Sprite.call(this,j);this._width=i||100;this._height=h||100;this.tileScale=new g.Point(1,1);this.tileScaleOffset=new g.Point(1,1);this.tilePosition=new g.Point(0,0);this.renderable=true;this.tint=16777215;this.blendMode=g.blendModes.NORMAL};g.TilingSprite.prototype=Object.create(g.Sprite.prototype);g.TilingSprite.prototype.constructor=g.TilingSprite;Object.defineProperty(g.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(h){this._width=h}});Object.defineProperty(g.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(h){this._height=h}});g.TilingSprite.prototype.setTexture=function(h){if(this.texture===h){return}this.texture=h;this.refreshTexture=true;this.cachedTint=16777215};g.TilingSprite.prototype._renderWebGL=function(l){if(this.visible===false||this.alpha===0){return}var k,h;if(this._mask){l.spriteBatch.stop();l.maskManager.pushMask(this.mask,l);l.spriteBatch.start()}if(this._filters){l.spriteBatch.flush();l.filterManager.pushFilter(this._filterBlock)}if(!this.tilingTexture||this.refreshTexture){this.generateTilingTexture(true);if(this.tilingTexture&&this.tilingTexture.needsUpdate){g.updateWebGLTexture(this.tilingTexture.baseTexture,l.gl);this.tilingTexture.needsUpdate=false}}else{l.spriteBatch.renderTilingSprite(this)}for(k=0,h=this.children.length;k<h;k++){this.children[k]._renderWebGL(l)}l.spriteBatch.stop();if(this._filters){l.filterManager.popFilter()}if(this._mask){l.maskManager.popMask(this._mask,l)}l.spriteBatch.start()};g.TilingSprite.prototype._renderCanvas=function(q){if(this.visible===false||this.alpha===0){return}var p=q.context;if(this._mask){q.maskManager.pushMask(this._mask,p)}p.globalAlpha=this.worldAlpha;var n=this.worldTransform;var o,m;var l=q.resolution;p.setTransform(n.a*l,n.c*l,n.b*l,n.d*l,n.tx*l,n.ty*l);if(!this.__tilePattern||this.refreshTexture){this.generateTilingTexture(false);if(this.tilingTexture){this.__tilePattern=p.createPattern(this.tilingTexture.baseTexture.source,"repeat")}else{return}}if(this.blendMode!==q.currentBlendMode){q.currentBlendMode=this.blendMode;p.globalCompositeOperation=g.blendModesCanvas[q.currentBlendMode]}var h=this.tilePosition;var k=this.tileScale;h.x%=this.tilingTexture.baseTexture.width;h.y%=this.tilingTexture.baseTexture.height;p.scale(k.x,k.y);p.translate(h.x+(this.anchor.x*-this._width),h.y+(this.anchor.y*-this._height));p.fillStyle=this.__tilePattern;p.fillRect(-h.x,-h.y,this._width/k.x,this._height/k.y);p.scale(1/k.x,1/k.y);p.translate(-h.x+(this.anchor.x*this._width),-h.y+(this.anchor.y*this._height));if(this._mask){q.maskManager.popMask(q.context)}for(o=0,m=this.children.length;o<m;o++){this.children[o]._renderCanvas(q)}};g.TilingSprite.prototype.getBounds=function(){var r=this._width;var q=this._height;var p=r*(1-this.anchor.x);var o=r*-this.anchor.x;var n=q*(1-this.anchor.y);var m=q*-this.anchor.y;var s=this.worldTransform;var F=s.a;var D=s.b;var C=s.c;var A=s.d;var G=s.tx;var E=s.ty;var w=F*o+C*m+G;var k=A*m+D*o+E;var v=F*p+C*m+G;var j=A*m+D*p+E;var u=F*p+C*n+G;var i=A*n+D*p+E;var t=F*o+C*n+G;var h=A*n+D*o+E;var z=-Infinity;var x=-Infinity;var B=Infinity;var y=Infinity;B=w<B?w:B;B=v<B?v:B;B=u<B?u:B;B=t<B?t:B;y=k<y?k:y;y=j<y?j:y;y=i<y?i:y;y=h<y?h:y;z=w>z?w:z;z=v>z?v:z;z=u>z?u:z;z=t>z?t:z;x=k>x?k:x;x=j>x?j:x;x=i>x?i:x;x=h>x?h:x;var l=this._bounds;l.x=B;l.width=z-B;l.y=y;l.height=x-y;this._currentBounds=l;return l};g.TilingSprite.prototype.onTextureUpdate=function(){};g.TilingSprite.prototype.generateTilingTexture=function(j){if(!this.texture.baseTexture.hasLoaded){return}var n=this.originalTexture||this.texture;var o=n.frame;var m,i;var h=o.width!==n.baseTexture.width||o.height!==n.baseTexture.height;var l=false;if(!j){if(h){m=o.width;i=o.height;l=true}}else{m=g.getNextPowerOfTwo(o.width);i=g.getNextPowerOfTwo(o.height);if(o.width!==m||o.height!==i){l=true}}if(l){var k;if(this.tilingTexture&&this.tilingTexture.isTiling){k=this.tilingTexture.canvasBuffer;k.resize(m,i);this.tilingTexture.baseTexture.width=m;this.tilingTexture.baseTexture.height=i;this.tilingTexture.needsUpdate=true}else{k=new g.CanvasBuffer(m,i);this.tilingTexture=g.Texture.fromCanvas(k.canvas);this.tilingTexture.canvasBuffer=k;this.tilingTexture.isTiling=true}k.context.drawImage(n.baseTexture.source,n.crop.x,n.crop.y,n.crop.width,n.crop.height,0,0,m,i);this.tileScaleOffset.x=o.width/m;this.tileScaleOffset.y=o.height/i}else{if(this.tilingTexture&&this.tilingTexture.isTiling){this.tilingTexture.destroy(true)}this.tileScaleOffset.x=1;this.tileScaleOffset.y=1;this.tilingTexture=n}this.refreshTexture=false;this.originalTexture=this.texture;this.texture=this.tilingTexture;this.tilingTexture.baseTexture._powerOf2=true};var f={};f.BoneData=function(h,i){this.name=h;this.parent=i};f.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1};f.SlotData=function(h,i){this.name=h;this.boneData=i};f.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null};f.Bone=function(i,h){this.data=i;this.parent=h;this.setToSetupPose()};f.Bone.yDown=false;f.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(j,i){var k=this.parent;if(k!=null){this.worldX=this.x*k.m00+this.y*k.m01+k.worldX;this.worldY=this.x*k.m10+this.y*k.m11+k.worldY;this.worldScaleX=k.worldScaleX*this.scaleX;this.worldScaleY=k.worldScaleY*this.scaleY;this.worldRotation=k.worldRotation+this.rotation}else{this.worldX=this.x;this.worldY=this.y;this.worldScaleX=this.scaleX;this.worldScaleY=this.scaleY;this.worldRotation=this.rotation}var m=this.worldRotation*Math.PI/180;var l=Math.cos(m);var h=Math.sin(m);this.m00=l*this.worldScaleX;this.m10=h*this.worldScaleX;this.m01=-h*this.worldScaleY;this.m11=l*this.worldScaleY;if(j){this.m00=-this.m00;this.m01=-this.m01}if(i){this.m10=-this.m10;this.m11=-this.m11}if(f.Bone.yDown){this.m10=-this.m10;this.m11=-this.m11}},setToSetupPose:function(){var h=this.data;this.x=h.x;this.y=h.y;this.rotation=h.rotation;this.scaleX=h.scaleX;this.scaleY=h.scaleY}};f.Slot=function(h,j,i){this.data=h;this.skeleton=j;this.bone=i;this.setToSetupPose()};f.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(h){this.attachment=h;this._attachmentTime=this.skeleton.time},setAttachmentTime:function(h){this._attachmentTime=this.skeleton.time-h},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var j=this.data;this.r=j.r;this.g=j.g;this.b=j.b;this.a=j.a;var l=this.skeleton.data.slots;for(var h=0,k=l.length;h<k;h++){if(l[h]==j){this.setAttachment(!j.attachmentName?null:this.skeleton.getAttachmentBySlotIndex(h,j.attachmentName));break}}}};f.Skin=function(h){this.name=h;this.attachments={}};f.Skin.prototype={addAttachment:function(h,i,j){this.attachments[h+":"+i]=j},getAttachment:function(h,i){return this.attachments[h+":"+i]},_attachAll:function(l,o){for(var j in o.attachments){var k=j.indexOf(":");var h=parseInt(j.substring(0,k),10);var i=j.substring(k+1);var n=l.slots[h];if(n.attachment&&n.attachment.name==i){var m=this.getAttachment(h,i);if(m){n.setAttachment(m)}}}}};f.Animation=function(h,i,j){this.name=h;this.timelines=i;this.duration=j};f.Animation.prototype={apply:function(m,l,h){if(h&&this.duration){l%=this.duration}var k=this.timelines;for(var j=0,o=k.length;j<o;j++){k[j].apply(m,l,1)}},mix:function(o,m,h,l){if(h&&this.duration){m%=this.duration}var k=this.timelines;for(var j=0,p=k.length;j<p;j++){k[j].apply(o,m,l)}}};f.binarySearch=function(i,m,j){var h=0;var k=Math.floor(i.length/j)-2;if(!k){return j}var l=k>>>1;while(true){if(i[(l+1)*j]<=m){h=l+1}else{k=l}if(h==k){return(h+1)*j}l=(h+k)>>>1}};f.linearSearch=function(h,m,l){for(var j=0,k=h.length-l;j<=k;j+=l){if(h[j]>m){return j}}return -1};f.Curves=function(h){this.curves=[];this.curves.length=(h-1)*6};f.Curves.prototype={setLinear:function(h){this.curves[h*6]=0},setStepped:function(h){this.curves[h*6]=-1},setCurve:function(p,s,y,r,x){var t=1/10;var o=t*t;var n=o*t;var k=3*t;var j=3*o;var h=6*o;var z=6*n;var w=-s*2+r;var v=-y*2+x;var m=(s-r)*3+1;var l=(y-x)*3+1;var u=p*6;var q=this.curves;q[u]=s*k+w*j+m*n;q[u+1]=y*k+v*j+l*n;q[u+2]=w*h+m*z;q[u+3]=v*h+l*z;q[u+4]=m*z;q[u+5]=l*z},getCurvePercent:function(l,q){q=q<0?0:(q>1?1:q);var o=l*6;var v=this.curves;var h=v[o];if(!h){return q}if(h==-1){return 0}var w=v[o+1];var u=v[o+2];var t=v[o+3];var n=v[o+4];var m=v[o+5];var s=h,r=w;var p=10-2;while(true){if(s>=q){var k=s-h;var j=r-w;return j+(r-j)*(q-k)/(s-k)}if(!p){break}p--;h+=u;w+=t;u+=n;t+=m;s+=h;r+=w}return r+(1-r)*(q-s)/(1-s)}};f.RotateTimeline=function(h){this.curves=new f.Curves(h);this.frames=[];this.frames.length=h*2};f.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(j,h,i){j*=2;this.frames[j]=h;this.frames[j+1]=i},apply:function(j,i,k){var p=this.frames,l;if(i<p[0]){return}var q=j.bones[this.boneIndex];if(i>=p[p.length-2]){l=q.data.rotation+p[p.length-1]-q.rotation;while(l>180){l-=360}while(l<-180){l+=360}q.rotation+=l*k;return}var h=f.binarySearch(p,i,2);var m=p[h-1];var o=p[h];var n=1-(i-o)/(p[h-2]-o);n=this.curves.getCurvePercent(h/2-1,n);l=p[h+1]-m;while(l>180){l-=360}while(l<-180){l+=360}l=q.data.rotation+(m+l*n)-q.rotation;while(l>180){l-=360}while(l<-180){l+=360}q.rotation+=l*k}};f.TranslateTimeline=function(h){this.curves=new f.Curves(h);this.frames=[];this.frames.length=h*3};f.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(k,i,h,j){k*=3;this.frames[k]=i;this.frames[k+1]=h;this.frames[k+2]=j},apply:function(j,i,k){var p=this.frames;if(i<p[0]){return}var q=j.bones[this.boneIndex];if(i>=p[p.length-3]){q.x+=(q.data.x+p[p.length-2]-q.x)*k;q.y+=(q.data.y+p[p.length-1]-q.y)*k;return}var h=f.binarySearch(p,i,3);var m=p[h-2];var l=p[h-1];var o=p[h];var n=1-(i-o)/(p[h+-3]-o);n=this.curves.getCurvePercent(h/3-1,n);q.x+=(q.data.x+m+(p[h+1]-m)*n-q.x)*k;q.y+=(q.data.y+l+(p[h+2]-l)*n-q.y)*k}};f.ScaleTimeline=function(h){this.curves=new f.Curves(h);this.frames=[];this.frames.length=h*3};f.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(k,i,h,j){k*=3;this.frames[k]=i;this.frames[k+1]=h;this.frames[k+2]=j},apply:function(j,i,k){var p=this.frames;if(i<p[0]){return}var q=j.bones[this.boneIndex];if(i>=p[p.length-3]){q.scaleX+=(q.data.scaleX-1+p[p.length-2]-q.scaleX)*k;q.scaleY+=(q.data.scaleY-1+p[p.length-1]-q.scaleY)*k;return}var h=f.binarySearch(p,i,3);var m=p[h-2];var l=p[h-1];var o=p[h];var n=1-(i-o)/(p[h+-3]-o);n=this.curves.getCurvePercent(h/3-1,n);q.scaleX+=(q.data.scaleX-1+m+(p[h+1]-m)*n-q.scaleX)*k;q.scaleY+=(q.data.scaleY-1+l+(p[h+2]-l)*n-q.scaleY)*k}};f.ColorTimeline=function(h){this.curves=new f.Curves(h);this.frames=[];this.frames.length=h*5};f.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(m,l,k,j,h,i){m*=5;this.frames[m]=l;this.frames[m+1]=k;this.frames[m+2]=j;this.frames[m+3]=h;this.frames[m+4]=i},apply:function(m,l,n){var v=this.frames;if(l<v[0]){return}var z=m.slots[this.slotIndex];if(l>=v[v.length-5]){var o=v.length-1;z.r=v[o-3];z.g=v[o-2];z.b=v[o-1];z.a=v[o];return}var j=f.binarySearch(v,l,5);var y=v[j-4];var k=v[j-3];var p=v[j-2];var s=v[j-1];var u=v[j];var t=1-(l-u)/(v[j-5]-u);t=this.curves.getCurvePercent(j/5-1,t);var h=y+(v[j+1]-y)*t;var q=k+(v[j+2]-k)*t;var w=p+(v[j+3]-p)*t;var x=s+(v[j+4]-s)*t;if(n<1){z.r+=(h-z.r)*n;z.g+=(q-z.g)*n;z.b+=(w-z.b)*n;z.a+=(x-z.a)*n}else{z.r=h;z.g=q;z.b=w;z.a=x}}};f.AttachmentTimeline=function(h){this.curves=new f.Curves(h);this.frames=[];this.frames.length=h;this.attachmentNames=[];this.attachmentNames.length=h};f.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(j,i,h){this.frames[j]=i;this.attachmentNames[j]=h},apply:function(k,j,i){var l=this.frames;if(j<l[0]){return}var m;if(j>=l[l.length-1]){m=l.length-1}else{m=f.binarySearch(l,j,1)-1}var h=this.attachmentNames[m];k.slots[this.slotIndex].setAttachment(!h?null:k.getAttachmentBySlotIndex(this.slotIndex,h))}};f.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=[];this.animations=[]};f.SkeletonData.prototype={defaultSkin:null,findBone:function(k){var h=this.bones;for(var j=0,l=h.length;j<l;j++){if(h[j].name==k){return h[j]}}return null},findBoneIndex:function(k){var h=this.bones;for(var j=0,l=h.length;j<l;j++){if(h[j].name==k){return j}}return -1},findSlot:function(h){var k=this.slots;for(var j=0,l=k.length;j<l;j++){if(k[j].name==h){return slot[j]}}return null},findSlotIndex:function(h){var k=this.slots;for(var j=0,l=k.length;j<l;j++){if(k[j].name==h){return j}}return -1},findSkin:function(h){var k=this.skins;for(var j=0,l=k.length;j<l;j++){if(k[j].name==h){return k[j]}}return null},findAnimation:function(j){var l=this.animations;for(var h=0,k=l.length;h<k;h++){if(l[h].name==j){return l[h]}}return null}};f.Skeleton=function(h){this.data=h;this.bones=[];for(var j=0,q=h.bones.length;j<q;j++){var o=h.bones[j];var k=!o.parent?null:this.bones[h.bones.indexOf(o.parent)];this.bones.push(new f.Bone(o,k))}this.slots=[];this.drawOrder=[];for(j=0,q=h.slots.length;j<q;j++){var l=h.slots[j];var m=this.bones[h.bones.indexOf(l.boneData)];var p=new f.Slot(l,this,m);this.slots.push(p);this.drawOrder.push(p)}};f.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:false,flipY:false,updateWorldTransform:function(){var k=this.flipX;var j=this.flipY;var h=this.bones;for(var l=0,m=h.length;l<m;l++){h[l].updateWorldTransform(k,j)}},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){var h=this.bones;for(var j=0,k=h.length;j<k;j++){h[j].setToSetupPose()}},setSlotsToSetupPose:function(){var j=this.slots;for(var h=0,k=j.length;h<k;h++){j[h].setToSetupPose(h)}},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(k){var h=this.bones;for(var j=0,l=h.length;j<l;j++){if(h[j].data.name==k){return h[j]}}return null},findBoneIndex:function(k){var h=this.bones;for(var j=0,l=h.length;j<l;j++){if(h[j].data.name==k){return j}}return -1},findSlot:function(h){var k=this.slots;for(var j=0,l=k.length;j<l;j++){if(k[j].data.name==h){return k[j]}}return null},findSlotIndex:function(h){var k=this.slots;for(var j=0,l=k.length;j<l;j++){if(k[j].data.name==h){return j}}return -1},setSkinByName:function(h){var i=this.data.findSkin(h);if(!i){throw"Skin not found: "+h}this.setSkin(i)},setSkin:function(h){if(this.skin&&h){h._attachAll(this,this.skin)}this.skin=h},getAttachmentBySlotName:function(i,h){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(i),h)},getAttachmentBySlotIndex:function(i,h){if(this.skin){var j=this.skin.getAttachment(i,h);if(j){return j}}if(this.data.defaultSkin){return this.data.defaultSkin.getAttachment(i,h)}return null},setAttachment:function(j,h){var l=this.slots;for(var k=0,p=l.size;k<p;k++){var o=l[k];if(o.data.name==j){var m=null;if(h){m=this.getAttachment(k,h);if(m==null){throw"Attachment not found: "+h+", for slot: "+j}}o.setAttachment(m);return}}throw"Slot not found: "+j},update:function(h){time+=h}};f.AttachmentType={region:0};f.RegionAttachment=function(){this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};f.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(j,h,l,m,i){var k=this.uvs;if(i){k[2]=j;k[3]=m;k[4]=j;k[5]=h;k[6]=l;k[7]=h;k[0]=l;k[1]=m}else{k[0]=j;k[1]=m;k[2]=j;k[3]=h;k[4]=l;k[5]=h;k[6]=l;k[7]=m}},updateOffset:function(){var w=this.width/this.regionOriginalWidth*this.scaleX;var v=this.height/this.regionOriginalHeight*this.scaleY;var i=-this.width/2*this.scaleX+this.regionOffsetX*w;var y=-this.height/2*this.scaleY+this.regionOffsetY*v;var n=i+this.regionWidth*w;var u=y+this.regionHeight*v;var x=this.rotation*Math.PI/180;var j=Math.cos(x);var h=Math.sin(x);var p=i*j+this.x;var o=i*h;var s=y*j+this.y;var q=y*h;var t=n*j+this.x;var r=n*h;var l=u*j+this.y;var k=u*h;var m=this.offset;m[0]=p-q;m[1]=s+o;m[2]=p-k;m[3]=l+o;m[4]=t-k;m[5]=l+r;m[6]=t-q;m[7]=s+r},computeVertices:function(m,l,o,k){m+=o.worldX;l+=o.worldY;var p=o.m00;var n=o.m01;var j=o.m10;var i=o.m11;var h=this.offset;k[0]=h[0]*p+h[1]*n+m;k[1]=h[0]*j+h[1]*i+l;k[2]=h[2]*p+h[3]*n+m;k[3]=h[2]*j+h[3]*i+l;k[4]=h[4]*p+h[5]*n+m;k[5]=h[4]*j+h[5]*i+l;k[6]=h[6]*p+h[7]*n+m;k[7]=h[6]*j+h[7]*i+l}};f.AnimationStateData=function(h){this.skeletonData=h;this.animationToMixTime={}};f.AnimationStateData.prototype={defaultMix:0,setMixByName:function(i,h,j){var l=this.skeletonData.findAnimation(i);if(!l){throw"Animation not found: "+i}var k=this.skeletonData.findAnimation(h);if(!k){throw"Animation not found: "+h}this.setMix(l,k,j)},setMix:function(j,i,h){this.animationToMixTime[j.name+":"+i.name]=h},getMix:function(j,i){var h=this.animationToMixTime[j.name+":"+i.name];return h?h:this.defaultMix}};f.AnimationState=function(h){this.data=h;this.queue=[]};f.AnimationState.prototype={animationSpeed:1,current:null,previous:null,currentTime:0,previousTime:0,currentLoop:false,previousLoop:false,mixTime:0,mixDuration:0,update:function(i){this.currentTime+=(i*this.animationSpeed);this.previousTime+=i;this.mixTime+=i;if(this.queue.length>0){var h=this.queue[0];if(this.currentTime>=h.delay){this._setAnimation(h.animation,h.loop);this.queue.shift()}}},apply:function(i){if(!this.current){return}if(this.previous){this.previous.apply(i,this.previousTime,this.previousLoop);var h=this.mixTime/this.mixDuration;if(h>=1){h=1;this.previous=null}this.current.mix(i,this.currentTime,this.currentLoop,h)}else{this.current.apply(i,this.currentTime,this.currentLoop)}},clearAnimation:function(){this.previous=null;this.current=null;this.queue.length=0},_setAnimation:function(i,h){this.previous=null;if(i&&this.current){this.mixDuration=this.data.getMix(this.current,i);if(this.mixDuration>0){this.mixTime=0;this.previous=this.current;this.previousTime=this.currentTime;this.previousLoop=this.currentLoop}}this.current=i;this.currentLoop=h;this.currentTime=0},setAnimationByName:function(i,h){var j=this.data.skeletonData.findAnimation(i);if(!j){throw"Animation not found: "+i}this.setAnimation(j,h)},setAnimation:function(i,h){this.queue.length=0;this._setAnimation(i,h)},addAnimationByName:function(j,h,i){var k=this.data.skeletonData.findAnimation(j);if(!k){throw"Animation not found: "+j}this.addAnimation(k,h,i)},addAnimation:function(l,h,j){var k={};k.animation=l;k.loop=h;if(!j||j<=0){var i=this.queue.length?this.queue[this.queue.length-1].animation:this.current;if(i!=null){j=i.duration-this.data.getMix(i,l)+(j||0)}else{j=0}}k.delay=j;this.queue.push(k)},isComplete:function(){return !this.current||this.currentTime>=this.current.duration}};f.SkeletonJson=function(h){this.attachmentLoader=h};f.SkeletonJson.prototype={scale:1,readSkeletonData:function(x){var h=new f.SkeletonData(),j;var C=x.bones;for(var A=0,v=C.length;A<v;A++){var E=C[A];var p=null;if(E.parent){p=h.findBone(E.parent);if(!p){throw"Parent bone not found: "+E.parent}}j=new f.BoneData(E.name,p);j.length=(E.length||0)*this.scale;j.x=(E.x||0)*this.scale;j.y=(E.y||0)*this.scale;j.rotation=(E.rotation||0);j.scaleX=E.scaleX||1;j.scaleY=E.scaleY||1;h.bones.push(j)}var r=x.slots;for(A=0,v=r.length;A<v;A++){var B=r[A];j=h.findBone(B.bone);if(!j){throw"Slot bone not found: "+B.bone}var k=new f.SlotData(B.name,j);var z=B.color;if(z){k.r=f.SkeletonJson.toColor(z,0);k.g=f.SkeletonJson.toColor(z,1);k.b=f.SkeletonJson.toColor(z,2);k.a=f.SkeletonJson.toColor(z,3)}k.attachmentName=B.attachment;h.slots.push(k)}var F=x.skins;for(var s in F){if(!F.hasOwnProperty(s)){continue}var u=F[s];var y=new f.Skin(s);for(var l in u){if(!u.hasOwnProperty(l)){continue}var D=h.findSlotIndex(l);var w=u[l];for(var t in w){if(!w.hasOwnProperty(t)){continue}var q=this.readAttachment(y,t,w[t]);if(q!=null){y.addAttachment(D,t,q)}}}h.skins.push(y);if(y.name=="default"){h.defaultSkin=y}}var o=x.animations;for(var m in o){if(!o.hasOwnProperty(m)){continue}this.readAnimation(m,o[m],h)}return h},readAttachment:function(k,h,j){h=j.name||h;var i=f.AttachmentType[j.type||"region"];if(i==f.AttachmentType.region){var l=new f.RegionAttachment();l.x=(j.x||0)*this.scale;l.y=(j.y||0)*this.scale;l.scaleX=j.scaleX||1;l.scaleY=j.scaleY||1;l.rotation=j.rotation||0;l.width=(j.width||32)*this.scale;l.height=(j.height||32)*this.scale;l.updateOffset();l.rendererObject={};l.rendererObject.name=h;l.rendererObject.scale={};l.rendererObject.scale.x=l.scaleX;l.rendererObject.scale.y=l.scaleY;l.rendererObject.rotation=-l.rotation*Math.PI/180;return l}throw"Unknown attachment type: "+i},readAnimation:function(N,M,k){var B=[];var h=0;var t,m,w,p,j,E,C;var G=M.bones;for(var o in G){if(!G.hasOwnProperty(o)){continue}var s=k.findBoneIndex(o);if(s==-1){throw"Bone not found: "+o}var K=G[o];for(w in K){if(!K.hasOwnProperty(w)){continue}j=K[w];if(w=="rotate"){m=new f.RotateTimeline(j.length);m.boneIndex=s;t=0;for(E=0,C=j.length;E<C;E++){p=j[E];m.setFrame(t,p.time,p.angle);f.SkeletonJson.readCurve(m,t,p);t++}B.push(m);h=Math.max(h,m.frames[m.getFrameCount()*2-2])}else{if(w=="translate"||w=="scale"){var l=1;if(w=="scale"){m=new f.ScaleTimeline(j.length)}else{m=new f.TranslateTimeline(j.length);l=this.scale}m.boneIndex=s;t=0;for(E=0,C=j.length;E<C;E++){p=j[E];var v=(p.x||0)*l;var u=(p.y||0)*l;m.setFrame(t,p.time,v,u);f.SkeletonJson.readCurve(m,t,p);t++}B.push(m);h=Math.max(h,m.frames[m.getFrameCount()*3-3])}else{throw"Invalid timeline type for a bone: "+w+" ("+o+")"}}}}var z=M.slots;for(var q in z){if(!z.hasOwnProperty(q)){continue}var F=z[q];var I=k.findSlotIndex(q);for(w in F){if(!F.hasOwnProperty(w)){continue}j=F[w];if(w=="color"){m=new f.ColorTimeline(j.length);m.slotIndex=I;t=0;for(E=0,C=j.length;E<C;E++){p=j[E];var D=p.color;var A=f.SkeletonJson.toColor(D,0);var H=f.SkeletonJson.toColor(D,1);var J=f.SkeletonJson.toColor(D,2);var L=f.SkeletonJson.toColor(D,3);m.setFrame(t,p.time,A,H,J,L);f.SkeletonJson.readCurve(m,t,p);t++}B.push(m);h=Math.max(h,m.frames[m.getFrameCount()*5-5])}else{if(w=="attachment"){m=new f.AttachmentTimeline(j.length);m.slotIndex=I;t=0;for(E=0,C=j.length;E<C;E++){p=j[E];m.setFrame(t++,p.time,p.name)}B.push(m);h=Math.max(h,m.frames[m.getFrameCount()-1])}else{throw"Invalid timeline type for a slot: "+w+" ("+q+")"}}}}k.animations.push(new f.Animation(N,B,h))}};f.SkeletonJson.readCurve=function(h,k,j){var i=j.curve;if(!i){return}if(i=="stepped"){h.curves.setStepped(k)}else{if(i instanceof Array){h.curves.setCurve(k,i[0],i[1],i[2],i[3])}}};f.SkeletonJson.toColor=function(h,i){if(h.length!=8){throw"Color hexidecimal length must be 8, recieved: "+h}return parseInt(h.substr(i*2,2),16)/255};f.Atlas=function(n,h){this.textureLoader=h;this.pages=[];this.regions=[];var j=new f.AtlasReader(n);var q=[];q.length=4;var k=null;while(true){var s=j.readLine();if(s==null){break}s=j.trim(s);if(!s.length){k=null}else{if(!k){k=new f.AtlasPage();k.name=s;k.format=f.Atlas.Format[j.readValue()];j.readTuple(q);k.minFilter=f.Atlas.TextureFilter[q[0]];k.magFilter=f.Atlas.TextureFilter[q[1]];var p=j.readValue();k.uWrap=f.Atlas.TextureWrap.clampToEdge;k.vWrap=f.Atlas.TextureWrap.clampToEdge;if(p=="x"){k.uWrap=f.Atlas.TextureWrap.repeat}else{if(p=="y"){k.vWrap=f.Atlas.TextureWrap.repeat}else{if(p=="xy"){k.uWrap=k.vWrap=f.Atlas.TextureWrap.repeat}}}h.load(k,s);this.pages.push(k)}else{var m=new f.AtlasRegion();m.name=s;m.page=k;m.rotate=j.readValue()=="true";j.readTuple(q);var o=parseInt(q[0],10);var l=parseInt(q[1],10);j.readTuple(q);var i=parseInt(q[0],10);var r=parseInt(q[1],10);m.u=o/k.width;m.v=l/k.height;if(m.rotate){m.u2=(o+r)/k.width;m.v2=(l+i)/k.height}else{m.u2=(o+i)/k.width;m.v2=(l+r)/k.height}m.x=o;m.y=l;m.width=Math.abs(i);m.height=Math.abs(r);if(j.readTuple(q)==4){m.splits=[parseInt(q[0],10),parseInt(q[1],10),parseInt(q[2],10),parseInt(q[3],10)];if(j.readTuple(q)==4){m.pads=[parseInt(q[0],10),parseInt(q[1],10),parseInt(q[2],10),parseInt(q[3],10)];j.readTuple(q)}}m.originalWidth=parseInt(q[0],10);m.originalHeight=parseInt(q[1],10);j.readTuple(q);m.offsetX=parseInt(q[0],10);m.offsetY=parseInt(q[1],10);m.index=parseInt(j.readValue(),10);this.regions.push(m)}}}};f.Atlas.prototype={findRegion:function(h){var l=this.regions;for(var j=0,k=l.length;j<k;j++){if(l[j].name==h){return l[j]}}return null},dispose:function(){var h=this.pages;for(var j=0,k=h.length;j<k;j++){this.textureLoader.unload(h[j].rendererObject)}},updateUVs:function(j){var m=this.regions;for(var h=0,l=m.length;h<l;h++){var k=m[h];if(k.page!=j){continue}k.u=k.x/j.width;k.v=k.y/j.height;if(k.rotate){k.u2=(k.x+k.height)/j.width;k.v2=(k.y+k.width)/j.height}else{k.u2=(k.x+k.width)/j.width;k.v2=(k.y+k.height)/j.height}}}};f.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};f.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};f.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};f.AtlasPage=function(){};f.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};f.AtlasRegion=function(){};f.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:false,splits:null,pads:null};f.AtlasReader=function(h){this.lines=h.split(/\r\n|\r|\n/)};f.AtlasReader.prototype={index:0,trim:function(h){return h.replace(/^\s+|\s+$/g,"")},readLine:function(){if(this.index>=this.lines.length){return null}return this.lines[this.index++]},readValue:function(){var h=this.readLine();var i=h.indexOf(":");if(i==-1){throw"Invalid line: "+h}return this.trim(h.substring(i+1))},readTuple:function(j){var k=this.readLine();var m=k.indexOf(":");if(m==-1){throw"Invalid line: "+k}var l=0,n=m+1;for(;l<3;l++){var h=k.indexOf(",",n);if(h==-1){if(!l){throw"Invalid line: "+k}break}j[l]=this.trim(k.substr(n,h-n));n=h+1}j[l]=this.trim(k.substring(n));return l+1}};f.AtlasAttachmentLoader=function(h){this.atlas=h};f.AtlasAttachmentLoader.prototype={newAttachment:function(k,i,h){switch(i){case f.AttachmentType.region:var j=this.atlas.findRegion(h);if(!j){throw"Region not found in atlas: "+h+" ("+i+")"}var l=new f.RegionAttachment(h);l.rendererObject=j;l.setUVs(j.u,j.v,j.u2,j.v2,j.rotate);l.regionOffsetX=j.offsetX;l.regionOffsetY=j.offsetY;l.regionWidth=j.width;l.regionHeight=j.height;l.regionOriginalWidth=j.originalWidth;l.regionOriginalHeight=j.originalHeight;return l}throw"Unknown attachment type: "+i}};f.Bone.yDown=true;g.AnimCache={};g.Spine=function(j){g.DisplayObjectContainer.call(this);this.spineData=g.AnimCache[j];if(!this.spineData){throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+j)}this.skeleton=new f.Skeleton(this.spineData);this.skeleton.updateWorldTransform();this.stateData=new f.AnimationStateData(this.spineData);this.state=new f.AnimationState(this.stateData);this.slotContainers=[];for(var m=0,q=this.skeleton.drawOrder.length;m<q;m++){var p=this.skeleton.drawOrder[m];var o=p.attachment;var h=new g.DisplayObjectContainer();this.slotContainers.push(h);this.addChild(h);if(!(o instanceof f.RegionAttachment)){continue}var l=o.rendererObject.name;var k=this.createSprite(p,o.rendererObject);p.currentSprite=k;p.currentSpriteName=l;h.addChild(k)}};g.Spine.prototype=Object.create(g.DisplayObjectContainer.prototype);g.Spine.prototype.constructor=g.Spine;g.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var k=(Date.now()-this.lastTime)*0.001;this.lastTime=Date.now();this.state.update(k);this.state.apply(this.skeleton);this.skeleton.updateWorldTransform();var h=this.skeleton.drawOrder;for(var m=0,j=h.length;m<j;m++){var q=h[m];var o=q.attachment;var p=this.slotContainers[m];if(!(o instanceof f.RegionAttachment)){p.visible=false;continue}if(o.rendererObject){if(!q.currentSpriteName||q.currentSpriteName!=o.name){var l=o.rendererObject.name;if(q.currentSprite!==undefined){q.currentSprite.visible=false}q.sprites=q.sprites||{};if(q.sprites[l]!==undefined){q.sprites[l].visible=true}else{var r=this.createSprite(q,o.rendererObject);p.addChild(r)}q.currentSprite=q.sprites[l];q.currentSpriteName=l}}p.visible=true;var s=q.bone;p.position.x=s.worldX+o.x*s.m00+o.y*s.m01;p.position.y=s.worldY+o.x*s.m10+o.y*s.m11;p.scale.x=s.worldScaleX;p.scale.y=s.worldScaleY;p.rotation=-(q.bone.worldRotation*Math.PI/180);p.alpha=q.a;q.currentSprite.tint=g.rgb2hex([q.r,q.g,q.b])}g.DisplayObjectContainer.prototype.updateTransform.call(this)};g.Spine.prototype.createSprite=function(k,j){var h=g.TextureCache[j.name]?j.name:j.name+".png";var i=new g.Sprite(g.Texture.fromFrame(h));i.scale=j.scale;i.rotation=j.rotation;i.anchor.x=i.anchor.y=0.5;k.sprites=k.sprites||{};k.sprites[j.name]=i;return i};g.BaseTextureCache={};g.BaseTextureCacheIdGenerator=0;g.BaseTexture=function(j,i){this.resolution=1;this.width=100;this.height=100;this.scaleMode=i||g.scaleModes.DEFAULT;this.hasLoaded=false;this.source=j;this._UID=g._UID++;this.premultipliedAlpha=true;this._glTextures=[];this._dirty=[true,true,true,true];if(!j){return}if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height){this.hasLoaded=true;this.width=this.source.naturalWidth||this.source.width;this.height=this.source.naturalHeight||this.source.height;this.dirty()}else{var h=this;this.source.onload=function(){h.hasLoaded=true;h.width=h.source.naturalWidth||h.source.width;h.height=h.source.naturalHeight||h.source.height;h.dirty();h.dispatchEvent({type:"loaded",content:h})};this.source.onerror=function(){h.dispatchEvent({type:"error",content:h})}}this.imageUrl=null;this._powerOf2=false};g.BaseTexture.prototype.constructor=g.BaseTexture;g.EventTarget.mixin(g.BaseTexture.prototype);g.BaseTexture.prototype.destroy=function(){if(this.imageUrl){delete g.BaseTextureCache[this.imageUrl];delete g.TextureCache[this.imageUrl];this.imageUrl=null;if(!navigator.isCocoonJS){this.source.src=""}}else{if(this.source&&this.source._pixiId){delete g.BaseTextureCache[this.source._pixiId]}}this.source=null;this.unloadFromGPU()};g.BaseTexture.prototype.updateSourceImage=function(h){this.hasLoaded=false;this.source.src=null;this.source.src=h};g.BaseTexture.prototype.dirty=function(){for(var h=0;h<this._glTextures.length;h++){this._dirty[h]=true}};g.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var j=this._glTextures.length-1;j>=0;j--){var h=this._glTextures[j];var k=g.glContexts[j];if(k&&h){k.deleteTexture(h)}}this._glTextures.length=0;this.dirty()};g.BaseTexture.fromImage=function(i,h,j){var k=g.BaseTextureCache[i];if(h===undefined&&i.indexOf("data:")===-1){h=true}if(!k){var l=new Image();if(h){l.crossOrigin=""}l.src=i;k=new g.BaseTexture(l,j);k.imageUrl=i;g.BaseTextureCache[i]=k;if(i.indexOf(g.RETINA_PREFIX+".")!==-1){k.resolution=2}}return k};g.BaseTexture.fromCanvas=function(h,i){if(!h._pixiId){h._pixiId="canvas_"+g.TextureCacheIdGenerator++}var j=g.BaseTextureCache[h._pixiId];if(!j){j=new g.BaseTexture(h,i);g.BaseTextureCache[h._pixiId]=j}return j};g.TextureCache={};g.FrameCache={};g.TextureCacheIdGenerator=0;g.Texture=function(j,k,i,h){this.noFrame=false;if(!k){this.noFrame=true;k=new g.Rectangle(0,0,1,1)}if(j instanceof g.Texture){j=j.baseTexture}this.baseTexture=j;this.frame=k;this.trim=h;this.valid=false;this.requiresUpdate=false;this._uvs=null;this.width=0;this.height=0;this.crop=i||new g.Rectangle(0,0,1,1);if(j.hasLoaded){if(this.noFrame){k=new g.Rectangle(0,0,j.width,j.height)}this.setFrame(k)}else{j.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))}};g.Texture.prototype.constructor=g.Texture;g.EventTarget.mixin(g.Texture.prototype);g.Texture.prototype.onBaseTextureLoaded=function(){var h=this.baseTexture;h.removeEventListener("loaded",this.onLoaded);if(this.noFrame){this.frame=new g.Rectangle(0,0,h.width,h.height)}this.setFrame(this.frame);this.dispatchEvent({type:"update",content:this})};g.Texture.prototype.destroy=function(h){if(h){this.baseTexture.destroy()}this.valid=false};g.Texture.prototype.setFrame=function(h){this.noFrame=false;this.frame=h;this.width=h.width;this.height=h.height;this.crop.x=h.x;this.crop.y=h.y;this.crop.width=h.width;this.crop.height=h.height;if(!this.trim&&(h.x+h.width>this.baseTexture.width||h.y+h.height>this.baseTexture.height)){throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this)}this.valid=h&&h.width&&h.height&&this.baseTexture.source&&this.baseTexture.hasLoaded;if(this.trim){this.width=this.trim.width;this.height=this.trim.height;this.frame.width=this.trim.width;this.frame.height=this.trim.height}if(this.valid){this._updateUvs()}};g.Texture.prototype._updateUvs=function(){if(!this._uvs){this._uvs=new g.TextureUvs()}var j=this.crop;var h=this.baseTexture.width;var i=this.baseTexture.height;this._uvs.x0=j.x/h;this._uvs.y0=j.y/i;this._uvs.x1=(j.x+j.width)/h;this._uvs.y1=j.y/i;this._uvs.x2=(j.x+j.width)/h;this._uvs.y2=(j.y+j.height)/i;this._uvs.x3=j.x/h;this._uvs.y3=(j.y+j.height)/i};g.Texture.fromImage=function(i,h,j){var k=g.TextureCache[i];if(!k){k=new g.Texture(g.BaseTexture.fromImage(i,h,j));g.TextureCache[i]=k}return k};g.Texture.fromFrame=function(i){var h=g.TextureCache[i];if(!h){throw new Error('The frameId "'+i+'" does not exist in the texture cache ')}return h};g.Texture.fromCanvas=function(h,i){var j=g.BaseTexture.fromCanvas(h,i);return new g.Texture(j)};g.Texture.addTextureToCache=function(h,i){g.TextureCache[i]=h};g.Texture.removeTextureFromCache=function(i){var h=g.TextureCache[i];delete g.TextureCache[i];delete g.BaseTextureCache[i];return h};g.TextureUvs=function(){this.x0=0;this.y0=0;this.x1=0;this.y1=0;this.x2=0;this.y2=0;this.x3=0;this.y3=0};g.Texture.emptyTexture=new g.Texture(new g.BaseTexture());g.RenderTexture=function(k,h,l,j,i){this.width=k||100;this.height=h||100;this.resolution=i||1;this.frame=new g.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.crop=new g.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.baseTexture=new g.BaseTexture();this.baseTexture.width=this.width*this.resolution;this.baseTexture.height=this.height*this.resolution;this.baseTexture._glTextures=[];this.baseTexture.resolution=this.resolution;this.baseTexture.scaleMode=j||g.scaleModes.DEFAULT;this.baseTexture.hasLoaded=true;g.Texture.call(this,this.baseTexture,new g.Rectangle(0,0,this.width,this.height));this.renderer=l||g.defaultRenderer;if(this.renderer.type===g.WEBGL_RENDERER){var m=this.renderer.gl;this.baseTexture._dirty[m.id]=false;this.textureBuffer=new g.FilterTexture(m,this.width*this.resolution,this.height*this.resolution,this.baseTexture.scaleMode);this.baseTexture._glTextures[m.id]=this.textureBuffer.texture;this.render=this.renderWebGL;this.projection=new g.Point(this.width*0.5,-this.height*0.5)}else{this.render=this.renderCanvas;this.textureBuffer=new g.CanvasBuffer(this.width*this.resolution,this.height*this.resolution);this.baseTexture.source=this.textureBuffer.canvas}this.valid=true;this._updateUvs()};g.RenderTexture.prototype=Object.create(g.Texture.prototype);g.RenderTexture.prototype.constructor=g.RenderTexture;g.RenderTexture.prototype.resize=function(j,h,i){if(j===this.width&&h===this.height){return}this.valid=(j>0&&h>0);this.width=this.frame.width=this.crop.width=j;this.height=this.frame.height=this.crop.height=h;if(i){this.baseTexture.width=this.width;this.baseTexture.height=this.height}if(this.renderer.type===g.WEBGL_RENDERER){this.projection.x=this.width/2;this.projection.y=-this.height/2}if(!this.valid){return}this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution)};g.RenderTexture.prototype.clear=function(){if(!this.valid){return}if(this.renderer.type===g.WEBGL_RENDERER){this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer)}this.textureBuffer.clear()};g.RenderTexture.prototype.renderWebGL=function(q,l,k){if(!this.valid){return}var h=q.worldTransform;h.identity();h.translate(0,this.projection.y*2);if(l){h.append(l)}h.scale(1,-1);q.worldAlpha=1;var o=q.children;for(var n=0,m=o.length;n<m;n++){o[n].updateTransform()}var p=this.renderer.gl;p.viewport(0,0,this.width*this.resolution,this.height*this.resolution);p.bindFramebuffer(p.FRAMEBUFFER,this.textureBuffer.frameBuffer);if(k){this.textureBuffer.clear()}this.renderer.spriteBatch.dirty=true;this.renderer.renderDisplayObject(q,this.projection,this.textureBuffer.frameBuffer);this.renderer.spriteBatch.dirty=true};g.RenderTexture.prototype.renderCanvas=function(p,r,n){if(!this.valid){return}var o=p.worldTransform;o.identity();if(r){o.append(r)}p.worldAlpha=1;var k=p.children;for(var m=0,l=k.length;m<l;m++){k[m].updateTransform()}if(n){this.textureBuffer.clear()}var h=this.textureBuffer.context;var q=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(p,h);this.renderer.resolution=q};g.RenderTexture.prototype.getImage=function(){var h=new Image();h.src=this.getBase64();return h};g.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()};g.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===g.WEBGL_RENDERER){var m=this.renderer.gl;var k=this.textureBuffer.width;var h=this.textureBuffer.height;var i=new Uint8Array(4*k*h);m.bindFramebuffer(m.FRAMEBUFFER,this.textureBuffer.frameBuffer);m.readPixels(0,0,k,h,m.RGBA,m.UNSIGNED_BYTE,i);m.bindFramebuffer(m.FRAMEBUFFER,null);var l=new g.CanvasBuffer(k,h);var j=l.context.getImageData(0,0,k,h);j.data.set(i);l.context.putImageData(j,0,0);return l.canvas}else{return this.textureBuffer.canvas}};g.RenderTexture.tempMatrix=new g.Matrix();g.VideoTexture=function(i,h){if(!i){throw new Error("No video source element specified.")}if((i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height){i.complete=true}g.BaseTexture.call(this,i,h);this.autoUpdate=false;this.updateBound=this._onUpdate.bind(this);if(!i.complete){this._onCanPlay=this.onCanPlay.bind(this);i.addEventListener("canplay",this._onCanPlay);i.addEventListener("canplaythrough",this._onCanPlay);i.addEventListener("play",this.onPlayStart.bind(this));i.addEventListener("pause",this.onPlayStop.bind(this))}};g.VideoTexture.prototype=Object.create(g.BaseTexture.prototype);g.VideoTexture.constructor=g.VideoTexture;g.VideoTexture.prototype._onUpdate=function(){if(this.autoUpdate){window.requestAnimationFrame(this.updateBound);this.dirty()}};g.VideoTexture.prototype.onPlayStart=function(){if(!this.autoUpdate){window.requestAnimationFrame(this.updateBound);this.autoUpdate=true}};g.VideoTexture.prototype.onPlayStop=function(){this.autoUpdate=false};g.VideoTexture.prototype.onCanPlay=function(){if(event.type==="canplaythrough"){this.hasLoaded=true;if(this.source){this.source.removeEventListener("canplay",this._onCanPlay);this.source.removeEventListener("canplaythrough",this._onCanPlay);this.width=this.source.videoWidth;this.height=this.source.videoHeight;if(!this.__loaded){this.__loaded=true;this.dispatchEvent({type:"loaded",content:this})}}}};g.VideoTexture.baseTextureFromVideo=function(j,h){if(!j._pixiId){j._pixiId="video_"+g.TextureCacheIdGenerator++}var i=g.BaseTextureCache[j._pixiId];if(!i){i=new g.VideoTexture(j,h);g.BaseTextureCache[j._pixiId]=i}return i};g.VideoTexture.prototype.destroy=function(){if(this.source&&this.source._pixiId){g.BaseTextureCache[this.source._pixiId]=null;delete g.BaseTextureCache[this.source._pixiId];this.source._pixiId=null;delete this.source._pixiId}g.BaseTexture.prototype.destroy.call(this)};g.VideoTexture.textureFromVideo=function(j,h){var i=g.VideoTexture.baseTextureFromVideo(j,h);return new g.Texture(i)};g.VideoTexture.fromUrl=function(h,i){var j=document.createElement("video");j.src=h;j.autoPlay=true;j.play();return g.VideoTexture.textureFromVideo(j,i)};g.AssetLoader=function(h,i){this.assetURLs=h;this.crossorigin=i;this.loadersByType={jpg:g.ImageLoader,jpeg:g.ImageLoader,png:g.ImageLoader,gif:g.ImageLoader,webp:g.ImageLoader,json:g.JsonLoader,atlas:g.AtlasLoader,anim:g.SpineLoader,xml:g.BitmapFontLoader,fnt:g.BitmapFontLoader}};g.EventTarget.mixin(g.AssetLoader.prototype);g.AssetLoader.prototype.constructor=g.AssetLoader;g.AssetLoader.prototype._getDataType=function(j){var m="data:";var l=j.slice(0,m.length).toLowerCase();if(l===m){var h=j.slice(m.length);var k=h.indexOf(",");if(k===-1){return null}var i=h.slice(0,k).split(";")[0];if(!i||i.toLowerCase()==="text/plain"){return"txt"}return i.split("/").pop().toLowerCase()}return null};g.AssetLoader.prototype.load=function(){var m=this;function l(i){m.onAssetLoaded(i.data.content)}this.loadCount=this.assetURLs.length;for(var k=0;k<this.assetURLs.length;k++){var o=this.assetURLs[k];var j=this._getDataType(o);if(!j){j=o.split("?").shift().split(".").pop().toLowerCase()}var n=this.loadersByType[j];if(!n){throw new Error(j+" is an unsupported file type")}var h=new n(o,this.crossorigin);h.on("loaded",l);h.load()}};g.AssetLoader.prototype.onAssetLoaded=function(h){this.loadCount--;this.emit("onProgress",{content:this,loader:h});if(this.onProgress){this.onProgress(h)}if(!this.loadCount){this.emit("onComplete",{content:this});if(this.onComplete){this.onComplete()}}};g.JsonLoader=function(i,h){this.url=i;this.crossorigin=h;this.baseUrl=i.replace(/[^\/]*$/,"");this.loaded=false};g.JsonLoader.prototype.constructor=g.JsonLoader;g.EventTarget.mixin(g.JsonLoader.prototype);g.JsonLoader.prototype.load=function(){if(window.XDomainRequest&&this.crossorigin){this.ajaxRequest=new window.XDomainRequest();this.ajaxRequest.timeout=3000;this.ajaxRequest.onerror=this.onError.bind(this);this.ajaxRequest.ontimeout=this.onError.bind(this);this.ajaxRequest.onprogress=function(){}}else{if(window.XMLHttpRequest){this.ajaxRequest=new window.XMLHttpRequest()}else{this.ajaxRequest=new window.ActiveXObject("Microsoft.XMLHTTP")}}this.ajaxRequest.onload=this.onJSONLoaded.bind(this);this.ajaxRequest.open("GET",this.url,true);this.ajaxRequest.send()};g.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText){this.onError();return}this.json=JSON.parse(this.ajaxRequest.responseText);if(this.json.frames){var p=this.baseUrl+this.json.meta.image;var l=new g.ImageLoader(p,this.crossorigin);var r=this.json.frames;this.texture=l.texture.baseTexture;l.addEventListener("loaded",this.onLoaded.bind(this));for(var m in r){var q=r[m].frame;if(q){var j=new g.Rectangle(q.x,q.y,q.w,q.h);var o=j.clone();var k=null;if(r[m].trimmed){var t=r[m].sourceSize;var s=r[m].spriteSourceSize;k=new g.Rectangle(s.x,s.y,t.w,t.h)}g.TextureCache[m]=new g.Texture(this.texture,j,o,k)}}l.load()}else{if(this.json.bones){var n=new f.SkeletonJson();var h=n.readSkeletonData(this.json);g.AnimCache[this.url]=h;this.onLoaded()}else{this.onLoaded()}}};g.JsonLoader.prototype.onLoaded=function(){this.loaded=true;this.dispatchEvent({type:"loaded",content:this})};g.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};g.AtlasLoader=function(i,h){this.url=i;this.baseUrl=i.replace(/[^\/]*$/,"");this.crossorigin=h;this.loaded=false};g.AtlasLoader.constructor=g.AtlasLoader;g.EventTarget.mixin(g.AtlasLoader.prototype);g.AtlasLoader.prototype.load=function(){this.ajaxRequest=new g.AjaxRequest();this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this);this.ajaxRequest.open("GET",this.url,true);if(this.ajaxRequest.overrideMimeType){this.ajaxRequest.overrideMimeType("application/json")}this.ajaxRequest.send(null)};g.AtlasLoader.prototype.onAtlasLoaded=function(){if(this.ajaxRequest.readyState===4){if(this.ajaxRequest.status===200||window.location.href.indexOf("http")===-1){this.atlas={meta:{image:[]},frames:[]};var u=this.ajaxRequest.responseText.split(/\r?\n/);var s=-3;var n=0;var h=null;var q=false;var l=0,k=0,v=this.onLoaded.bind(this);for(l=0;l<u.length;l++){u[l]=u[l].replace(/^\s+|\s+$/g,"");if(u[l]===""){q=l+1}if(u[l].length>0){if(q===l){this.atlas.meta.image.push(u[l]);n=this.atlas.meta.image.length-1;this.atlas.frames.push({});s=-3}else{if(s>0){if(s%7===1){if(h!=null){this.atlas.frames[n][h.name]=h}h={name:u[l],frame:{}}}else{var r=u[l].split(" ");if(s%7===3){h.frame.x=Number(r[1].replace(",",""));h.frame.y=Number(r[2])}else{if(s%7===4){h.frame.w=Number(r[1].replace(",",""));h.frame.h=Number(r[2])}else{if(s%7===5){var t={x:0,y:0,w:Number(r[1].replace(",","")),h:Number(r[2])};if(t.w>h.frame.w||t.h>h.frame.h){h.trimmed=true;h.realSize=t}else{h.trimmed=false}}}}}}}s++}}if(h!=null){this.atlas.frames[n][h.name]=h}if(this.atlas.meta.image.length>0){this.images=[];for(k=0;k<this.atlas.meta.image.length;k++){var m=this.baseUrl+this.atlas.meta.image[k];var p=this.atlas.frames[k];this.images.push(new g.ImageLoader(m,this.crossorigin));for(l in p){var o=p[l].frame;if(o){g.TextureCache[l]=new g.Texture(this.images[k].texture.baseTexture,{x:o.x,y:o.y,width:o.w,height:o.h});if(p[l].trimmed){g.TextureCache[l].realSize=p[l].realSize;g.TextureCache[l].trim.x=0;g.TextureCache[l].trim.y=0}}}}this.currentImageId=0;for(k=0;k<this.images.length;k++){this.images[k].on("loaded",v)}this.images[this.currentImageId].load()}else{this.onLoaded()}}else{this.onError()}}};g.AtlasLoader.prototype.onLoaded=function(){if(this.images.length-1>this.currentImageId){this.currentImageId++;this.images[this.currentImageId].load()}else{this.loaded=true;this.emit("loaded",{content:this})}};g.AtlasLoader.prototype.onError=function(){this.emit("error",{content:this})};g.SpriteSheetLoader=function(i,h){this.url=i;this.crossorigin=h;this.baseUrl=i.replace(/[^\/]*$/,"");this.texture=null;this.frames={}};g.SpriteSheetLoader.prototype.constructor=g.SpriteSheetLoader;g.EventTarget.mixin(g.SpriteSheetLoader.prototype);g.SpriteSheetLoader.prototype.load=function(){var i=this;var h=new g.JsonLoader(this.url,this.crossorigin);h.on("loaded",function(j){i.json=j.data.content.json;i.onLoaded()});h.load()};g.SpriteSheetLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})};g.ImageLoader=function(i,h){this.texture=g.Texture.fromImage(i,h);this.frames=[]};g.ImageLoader.prototype.constructor=g.ImageLoader;g.EventTarget.mixin(g.ImageLoader.prototype);g.ImageLoader.prototype.load=function(){if(!this.texture.baseTexture.hasLoaded){this.texture.baseTexture.on("loaded",this.onLoaded.bind(this))}else{this.onLoaded()}};g.ImageLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})};g.ImageLoader.prototype.loadFramedSpriteSheet=function(o,j,h){this.frames=[];var n=Math.floor(this.texture.width/o);var q=Math.floor(this.texture.height/j);var k=0;for(var m=0;m<q;m++){for(var p=0;p<n;p++,k++){var l=new g.Texture(this.texture.baseTexture,{x:p*o,y:m*j,width:o,height:j});this.frames.push(l);if(h){g.TextureCache[h+"-"+k]=l}}}this.load()};g.BitmapFontLoader=function(i,h){this.url=i;this.crossorigin=h;this.baseUrl=i.replace(/[^\/]*$/,"");this.texture=null};g.BitmapFontLoader.prototype.constructor=g.BitmapFontLoader;g.EventTarget.mixin(g.BitmapFontLoader.prototype);g.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new g.AjaxRequest();this.ajaxRequest.onreadystatechange=this.onXMLLoaded.bind(this);this.ajaxRequest.open("GET",this.url,true);if(this.ajaxRequest.overrideMimeType){this.ajaxRequest.overrideMimeType("application/xml")}this.ajaxRequest.send(null)};g.BitmapFontLoader.prototype.onXMLLoaded=function(){if(this.ajaxRequest.readyState===4){if(this.ajaxRequest.status===200||window.location.protocol.indexOf("http")===-1){var v=this.ajaxRequest.responseXML;if(!v||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS){if(typeof(window.DOMParser)==="function"){var q=new DOMParser();v=q.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var h=document.createElement("div");h.innerHTML=this.ajaxRequest.responseText;v=h}}var r=this.baseUrl+v.getElementsByTagName("page")[0].getAttribute("file");var l=new g.ImageLoader(r,this.crossorigin);this.texture=l.texture.baseTexture;var n={};var k=v.getElementsByTagName("info")[0];var s=v.getElementsByTagName("common")[0];n.font=k.getAttribute("face");n.size=parseInt(k.getAttribute("size"),10);n.lineHeight=parseInt(s.getAttribute("lineHeight"),10);n.chars={};var t=v.getElementsByTagName("char");for(var m=0;m<t.length;m++){var x=parseInt(t[m].getAttribute("id"),10);var w=new g.Rectangle(parseInt(t[m].getAttribute("x"),10),parseInt(t[m].getAttribute("y"),10),parseInt(t[m].getAttribute("width"),10),parseInt(t[m].getAttribute("height"),10));n.chars[x]={xOffset:parseInt(t[m].getAttribute("xoffset"),10),yOffset:parseInt(t[m].getAttribute("yoffset"),10),xAdvance:parseInt(t[m].getAttribute("xadvance"),10),kerning:{},texture:g.TextureCache[x]=new g.Texture(this.texture,w)}}var u=v.getElementsByTagName("kerning");for(m=0;m<u.length;m++){var p=parseInt(u[m].getAttribute("first"),10);var j=parseInt(u[m].getAttribute("second"),10);var o=parseInt(u[m].getAttribute("amount"),10);n.chars[j].kerning[p]=o}g.BitmapText.fonts[n.font]=n;l.addEventListener("loaded",this.onLoaded.bind(this));l.load()}}};g.BitmapFontLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})};g.SpineLoader=function(i,h){this.url=i;this.crossorigin=h;this.loaded=false};g.SpineLoader.prototype.constructor=g.SpineLoader;g.EventTarget.mixin(g.SpineLoader.prototype);g.SpineLoader.prototype.load=function(){var i=this;var h=new g.JsonLoader(this.url,this.crossorigin);h.on("loaded",function(j){i.json=j.data.content.json;i.onLoaded()});h.load()};g.SpineLoader.prototype.onLoaded=function(){this.loaded=true;this.emit("loaded",{content:this})};g.AbstractFilter=function(i,h){this.passes=[this];this.shaders=[];this.dirty=true;this.padding=0;this.uniforms=h||{};this.fragmentSrc=i||[]};g.AbstractFilter.prototype.constructor=g.AbstractFilter;g.AbstractFilter.prototype.syncUniforms=function(){for(var k=0,h=this.shaders.length;k<h;k++){this.shaders[k].dirty=true}};g.AlphaMaskFilter=function(h){g.AbstractFilter.call(this);this.passes=[this];h.baseTexture._powerOf2=true;this.uniforms={mask:{type:"sampler2D",value:h},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}};if(h.baseTexture.hasLoaded){this.uniforms.mask.value.x=h.width;this.uniforms.mask.value.y=h.height}else{this.boundLoadedFunction=this.onTextureLoaded.bind(this);h.baseTexture.on("loaded",this.boundLoadedFunction)}this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]};g.AlphaMaskFilter.prototype=Object.create(g.AbstractFilter.prototype);g.AlphaMaskFilter.prototype.constructor=g.AlphaMaskFilter;g.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height;this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)};Object.defineProperty(g.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(h){this.uniforms.mask.value=h}});g.ColorMatrixFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]};g.ColorMatrixFilter.prototype=Object.create(g.AbstractFilter.prototype);g.ColorMatrixFilter.prototype.constructor=g.ColorMatrixFilter;Object.defineProperty(g.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(h){this.uniforms.matrix.value=h}});g.GrayFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={gray:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]};g.GrayFilter.prototype=Object.create(g.AbstractFilter.prototype);g.GrayFilter.prototype.constructor=g.GrayFilter;Object.defineProperty(g.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(h){this.uniforms.gray.value=h}});g.DisplacementFilter=function(h){g.AbstractFilter.call(this);this.passes=[this];h.baseTexture._powerOf2=true;this.uniforms={displacementMap:{type:"sampler2D",value:h},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}};if(h.baseTexture.hasLoaded){this.uniforms.mapDimensions.value.x=h.width;this.uniforms.mapDimensions.value.y=h.height}else{this.boundLoadedFunction=this.onTextureLoaded.bind(this);h.baseTexture.on("loaded",this.boundLoadedFunction)}this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]};g.DisplacementFilter.prototype=Object.create(g.AbstractFilter.prototype);g.DisplacementFilter.prototype.constructor=g.DisplacementFilter;g.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height;this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)};Object.defineProperty(g.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(h){this.uniforms.displacementMap.value=h}});Object.defineProperty(g.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(h){this.uniforms.scale.value=h}});Object.defineProperty(g.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(h){this.uniforms.offset.value=h}});g.PixelateFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new g.Float32Array([10000,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]};g.PixelateFilter.prototype=Object.create(g.AbstractFilter.prototype);g.PixelateFilter.prototype.constructor=g.PixelateFilter;Object.defineProperty(g.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(h){this.dirty=true;this.uniforms.pixelSize.value=h}});g.BlurXFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]};g.BlurXFilter.prototype=Object.create(g.AbstractFilter.prototype);g.BlurXFilter.prototype.constructor=g.BlurXFilter;Object.defineProperty(g.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7000)},set:function(h){this.dirty=true;this.uniforms.blur.value=(1/7000)*h}});g.BlurYFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]};g.BlurYFilter.prototype=Object.create(g.AbstractFilter.prototype);g.BlurYFilter.prototype.constructor=g.BlurYFilter;Object.defineProperty(g.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7000)},set:function(h){this.uniforms.blur.value=(1/7000)*h}});g.BlurFilter=function(){this.blurXFilter=new g.BlurXFilter();this.blurYFilter=new g.BlurYFilter();this.passes=[this.blurXFilter,this.blurYFilter]};g.BlurFilter.prototype=Object.create(g.AbstractFilter.prototype);g.BlurFilter.prototype.constructor=g.BlurFilter;Object.defineProperty(g.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(h){this.blurXFilter.blur=this.blurYFilter.blur=h}});Object.defineProperty(g.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(h){this.blurXFilter.blur=h}});Object.defineProperty(g.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(h){this.blurYFilter.blur=h}});g.InvertFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]};g.InvertFilter.prototype=Object.create(g.AbstractFilter.prototype);g.InvertFilter.prototype.constructor=g.InvertFilter;Object.defineProperty(g.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(h){this.uniforms.invert.value=h}});g.SepiaFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={sepia:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]};g.SepiaFilter.prototype=Object.create(g.AbstractFilter.prototype);g.SepiaFilter.prototype.constructor=g.SepiaFilter;Object.defineProperty(g.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(h){this.uniforms.sepia.value=h}});g.TwistFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={radius:{type:"1f",value:0.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:0.5,y:0.5}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]};g.TwistFilter.prototype=Object.create(g.AbstractFilter.prototype);g.TwistFilter.prototype.constructor=g.TwistFilter;Object.defineProperty(g.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(h){this.dirty=true;this.uniforms.offset.value=h}});Object.defineProperty(g.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(h){this.dirty=true;this.uniforms.radius.value=h}});Object.defineProperty(g.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(h){this.dirty=true;this.uniforms.angle.value=h}});g.ColorStepFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={step:{type:"1f",value:5}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]};g.ColorStepFilter.prototype=Object.create(g.AbstractFilter.prototype);g.ColorStepFilter.prototype.constructor=g.ColorStepFilter;Object.defineProperty(g.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(h){this.uniforms.step.value=h}});g.DotScreenFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]};g.DotScreenFilter.prototype=Object.create(g.AbstractFilter.prototype);g.DotScreenFilter.prototype.constructor=g.DotScreenFilter;Object.defineProperty(g.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(h){this.dirty=true;this.uniforms.scale.value=h}});Object.defineProperty(g.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(h){this.dirty=true;this.uniforms.angle.value=h}});g.CrossHatchFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]};g.CrossHatchFilter.prototype=Object.create(g.AbstractFilter.prototype);g.CrossHatchFilter.prototype.constructor=g.CrossHatchFilter;Object.defineProperty(g.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7000)},set:function(h){this.uniforms.blur.value=(1/7000)*h}});g.RGBSplitFilter=function(){g.AbstractFilter.call(this);this.passes=[this];this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]};g.RGBSplitFilter.prototype=Object.create(g.AbstractFilter.prototype);g.RGBSplitFilter.prototype.constructor=g.RGBSplitFilter;Object.defineProperty(g.RGBSplitFilter.prototype,"red",{get:function(){return this.uniforms.red.value},set:function(h){this.uniforms.red.value=h}});Object.defineProperty(g.RGBSplitFilter.prototype,"green",{get:function(){return this.uniforms.green.value},set:function(h){this.uniforms.green.value=h}});Object.defineProperty(g.RGBSplitFilter.prototype,"blue",{get:function(){return this.uniforms.blue.value},set:function(h){this.uniforms.blue.value=h}});if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=g}exports.PIXI=g}else{if(typeof define!=="undefined"&&define.amd){define(g)}else{b.PIXI=g}}}).call(this);
