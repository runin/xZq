(function(a){H.cjdialog={init:function(){getResult("comedian/publish",{yp:openid},"callbackComedianPublish",true)},result:function(b){a("#jifen").append(this.tpl(b));setTimeout(function(){a("#show-result").removeClass("none");H.page.to("show-result")},parseInt(5000))},tpl:function(h){var e=simpleTpl();var j=h.hc==""?0:h.hc,g=h.lc==""?0:h.lc,b=g<=0?"none":"",c=["晋级","待定","淘汰"];a("#show-result").find(".hz").text(j);a("#show-result").find(".lc").text(g);g<=0?a("#ljdraw").addClass("none"):"";e._('<div class="star-list">');for(var d=0;d<h.items.length;d++){var f=h.items[d];if(d==0||d%4==0||d==h.items.length){e._('<div class="star-tr">')}e._('<div class="star-td">');e._('<div class="star-heard" style="background: url('+f.pi+') no-repeat center 0;background-size:cover;background-color: rgba(110,67,46,1);">');if(f.sr==1){e._('<img src="./images/icon-jinji.png">')}e._("</div>");e._('<p class="star-name">'+f.t+"</p>");e._("</div>");if((d+1)%4==0||(d+1)==h.items.length){e._("</div>")}}e._("</div>");return e.toString()}};H.dialog={puid:0,$container:a("#main"),REQUEST_CLS:"requesting",iscroll:null,init:function(){var b=this;this.$container.delegate(".btn-rule","click",function(c){c.preventDefault();H.dialog.rule.open()}).delegate(".btn-close","click",function(c){c.preventDefault();a(this).closest(".modal").addClass("none")}).delegate(".btn-result","click",function(c){c.preventDefault();H.dialog.result.open()}).delegate(".btn-lottery","click",function(c){c.preventDefault();H.dialog.lottery.open()}).delegate(".btn-comeon","click",function(c){c.preventDefault();H.dialog.guide.open()})},close:function(){a(".modal").addClass("none")},open:function(){H.dialog.close();if(this.$dialog){this.$dialog.removeClass("none")}else{this.$dialog=a(this.tpl());H.dialog.$container.append(this.$dialog)}H.dialog.relocate()},relocate:function(){var b=a(window).height(),c=a(window).width(),d=a(window).scrollTop()+b*0.06;a(".modal").css({width:c,height:b}).find(".btn-close").css({right:c*0.06-15,top:d-15});a(".dialog").each(function(){if(a(this).hasClass("relocated")){return}a(this).css({width:c*0.88,height:b*0.88,left:c*0.06,right:c*0.06,top:d,bottom:b*0.06});var e=a(this).find(".box");if(e.length>0){e.css("height",b*0.38)}})},guide:{$dialog:null,open:function(){H.dialog.open.call(this);this.event();var b=this;setTimeout(function(){b.close()},8000)},event:function(){var b=this;this.$dialog.find(".btn-try").click(function(c){c.preventDefault();localStorage.nextoneGuided=true;b.close()})},close:function(){this.$dialog&&this.$dialog.addClass("none")},tpl:function(){var b=simpleTpl();b._('<section class="modal modal-guide" id="guide-dialog">')._('<div class="dialog guide-dialog relocated">')._("<h2></h2>")._('<p class="ellipsis"><label>1.</label>打开电视，锁定安徽卫视</p>')._('<p class="ellipsis"><label>2.</label>打开微信，进入摇一摇(歌曲)</p>')._('<p class="ellipsis"><label>3.</label>对着电视摇一摇</p>')._('<a href="#" class="btn btn-try" data-collect="true" data-collect-flag="ah-guide-trybtn" data-collect-desc="引导弹层-关闭按钮">等下就去试试</a>')._("</div>")._("</section>");return b.toString()}},rule:{$dialog:null,open:function(){H.dialog.open.call(this);this.event();getResult("common/activtyRule/"+serviceNo,{},"callbackRuleHandler",true,this.$dialog)},close:function(){this.$dialog&&this.$dialog.addClass("none")},event:function(){var b=this;this.$dialog.find(".btn-close").click(function(c){c.preventDefault();b.close()})},update:function(b){this.$dialog.find(".rule").html(b).closest(".content").removeClass("none")},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="rule-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="ah-ruledialog-closebtn" data-collect-desc="规则弹层-关闭按钮"></a>')._('<div class="dialog rule-dialog">')._("<h2></h2>")._('<div class="content border none">')._('<div class="rule"></div>')._("</div>")._('<p class="dialog-copyright">本活动最终解释权归安徽卫视 《超级笑星》 栏目所有</p>')._("</div>")._("</section>");return b.toString()}},result:{$dialog:null,open:function(){H.dialog.open.call(this);this.event();getResult("comedian/transcript",{tsuid:stationUuid,yp:openid},"callbackComedianTranscript",true,this.$dialog)},close:function(){this.$dialog&&this.$dialog.addClass("none")},event:function(){var b=this;this.$dialog.find(".btn-close").click(function(c){c.preventDefault();b.close()})},update:function(d){var b=this.$dialog.find(".btn-lottery");if(d.code!=0){alert("加载战绩榜出错，请稍后重试");this.close();return false}var c=(d.gc?Math.round((d.hc/d.gc).toFixed(2)*100):0)+"%";this.$dialog.find(".rt").text(c);this.$dialog.find(".gc").text(d.gc);this.$dialog.find(".hc").text(d.hc);this.$dialog.find(".lc").text(d.lc);this.$dialog.find(".iv").text(d.iv);a("#result-dialog").find(".lc").text(d.lc);if(d.iv>0){this.$dialog.find(".db").removeClass("none");this.$dialog.find(".rk").text(d.rank)}else{this.$dialog.find(".db").addClass("none")}if(d.lc>0){b.removeClass("none")}else{b.addClass("none")}},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="result-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="ah-resultdialog-closebtn" data-collect-desc="战绩弹层-关闭按钮"></a>')._('<div class="dialog result-dialog">')._("<h2></h2>")._('<div class="title-border"></div>')._('<div class="img"></div>')._('<div class="tip">')._('<div class="content">')._('<h3>总共猜中<span class="hc">-</span>场，继续加油哦！</h3>')._('<p>您一共还有<span class="lc">-</span>次抽奖机会</p>')._('<a href="#" class="btn btn-lottery none" data-collect="true" data-collect-flag="ah-resultdialog-lotterybtn" data-collect-desc="战绩弹层-抽奖按钮">立即抽奖</a>')._("</div>")._("</div>")._('<div class="list border">')._("<ul>")._("<li>")._('<h4 class="hc">-</h4>')._("<p>我猜对</p>")._("</li>")._("<li>")._('<h4 class="gc">-</h4>')._("<p>我参与</p>")._("</li>")._("<li>")._('<h4 class="rt">-</h4>')._("<p>胜率</p>")._("</li>")._("</ul>")._("</div>")._('<div class="jifen" style="margin-top: 2%;font-size: 20px;text-align: center;color: #fff;">')._('<p class="jf">您现在的积分为<span class="iv">-</span>分</p>')._('<p class="db none">您的排名是第<span class="rk">-</span>名！</p>')._("</div>")._("</div>")._("</section>");return b.toString()}},lottery:{$dialog:null,BROKEN_CLS:"broken",ANIMATED_CLS:"animated",LOTTERIED_CLS:"lotteried",open:function(){var b=this,c=this.$dialog;H.dialog.open.call(this);if(!c){this.event()}this.reset();this.$dialog.removeClass("none");var d=this.$dialog.find(".btn-hammer").addClass(this.ANIMATED_CLS);setTimeout(function(){d.removeClass(b.ANIMATED_CLS)},800);getResult("comedian/querylc",{tsuid:stationUuid,yp:openid},"callbackComedianQuerylc",true);this.record()},shake:function(){W.addEventListener("shake",H.dialog.lottery.shake_listener,false)},unshake:function(){W.removeEventListener("shake",H.dialog.lottery.shake_listener,false)},shake_listener:function(){var b=H.dialog.lottery.$dialog;if(b.hasClass("none")){return}b.find(".btn-hammer").trigger("click")},event:function(){var b=this;this.$dialog.find(".btn-hammer").click(function(d){var c=a(this);d.preventDefault();if(b.$dialog.hasClass(b.LOTTERIED_CLS)){return false}b.$dialog.addClass(b.LOTTERIED_CLS);c.addClass(b.ANIMATED_CLS);setTimeout(function(){b.$dialog.addClass(b.BROKEN_CLS)},400);setTimeout(function(){c.removeClass(b.ANIMATED_CLS)},800);getResult("comedian/lottery",{tsuid:stationUuid,tcuid:channelUuid,serviceNo:serviceNo,yp:openid},"callbackComedianLottery",this.$dialog)});this.$dialog.find(".list").scrollbox({linear:false,startDelay:2,step:1,delay:1.5,speed:20});this.shake()},animate:function(c){var b=this;setTimeout(function(){b.$dialog.addClass(b.ANIMATED_CLS)},400);setTimeout(function(){H.dialog.award.open(c)},1100)},update:function(b){W.lc=b;a(".s-lc").text(b);a("#result-dialog").find(".lc").text(b)},reset:function(){this.$dialog.removeClass(this.BROKEN_CLS).removeClass(this.ANIMATED_CLS).removeClass(this.LOTTERIED_CLS)},record:function(){var c=W.lottery_record||[],b=c.length,e=simpleTpl();for(var d=0;d<b;d++){e._("<li>")._('<span class="label-name ellipsis">'+c[d].n+"</span>")._('<span class="label-mobile ellipsis">'+c[d].p+"</span>")._('<span class="label-gift ellipsis">'+c[d].pn+"</span>")._("</li>")}this.$dialog.find("ul").html(e.toString())},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="lottery-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="ah-lotterydialog-closebtn" data-collect-desc="抽奖弹层-关闭按钮"></a>')._('<div class="dialog lottery-dialog">')._('<div class="hammer">')._("<p>举起你的双手，让我们一起摇摆吧！</p>")._('<a href="#" class="btn-hammer" data-collect="true" data-collect-flag="ah-lotterydialog-hammerbtn" data-collect-desc="抽奖弹层-锤子砸奖"></a>')._("</div>")._('<div class="ctrl">')._('<div class="list"><ul></ul></div>')._('<a href="#" class="btn btn-result" data-collect="true" data-collect-flag="ah-lotterydialog-resultbtn" data-collect-desc="抽奖弹层-查看战绩">查看战绩</a>')._('<p>你还有<strong class="s-lc"></strong>次抽奖机会</p>')._("</div>")._('<div class="light"></div>')._('<p class="dialog-copyright none">本活动最终解释权归安徽卫视 《超级笑星》 栏目所有</p>')._("</div>")._("</section>");return b.toString()}},award:{puid:0,pt:0,$dialog:null,SUCCESS_CLS:"award-succ-dialog",REQUEST_CLS:"requesting",open:function(c){var b=this.$dialog;H.dialog.open.call(this);if(!b){this.event()}this.scroll_enable();this.pt=c.pt;this.puid=c.puid;this.$dialog.find(".s-award").text(" "+c.pn+" "+(c.pt==2?"":(c.co+c.pu)));this.$dialog.find(".prize").html('<img src="'+c.pi+'" />').addClass("p"+c.pt);this.$dialog.find(".mobile").val(c.ph||"");this.$dialog.find(".name").val(c.rn||"");var d=this.$dialog.find(".address").val(c.ad||"");if(c.pt==2){d.addClass("none")}else{d.removeClass("none")}this.$dialog.removeClass(this.SUCCESS_CLS)},scroll_enable:function(){if(this.iscroll){this.iscroll.scrollTo(0,0);this.iscroll.enable()}},scroll_disable:function(){if(this.iscroll){this.iscroll.scrollTo(0,0);this.iscroll.disable()}},enable:function(){this.$dialog.find(".btn-award").removeClass(this.REQUEST_CLS)},disable:function(){this.$dialog.find(".btn-award").addClass(this.REQUEST_CLS)},succ:function(){this.scroll_disable();H.dialog.lottery.update(W.lc);a("#result-dialog").find(".lc").text(W.lc);this.$dialog.addClass(this.SUCCESS_CLS);if(W.lc<=0){this.$dialog.find(".btn-again").addClass("none")}else{this.$dialog.find(".btn-again").removeClass("none")}},check:function(){var f=this,e=f.$dialog.find(".mobile"),d=a.trim(e.val()),h=f.$dialog.find(".name"),c=a.trim(h.val()),g=f.$dialog.find(".address"),b=a.trim(g.val());if(!c){H.dialog.confirm.open(h);return false}else{if(!d){H.dialog.confirm.open(e);return false}else{if(f.pt==1&&!b){H.dialog.confirm.open(g);return false}}}if(c.length>20){alert("姓名太太太长了！");h.focus();return false}if(!/^\d{11}$/.test(d)){alert("这手机号，可打不通...");e.focus();return false}if(f.pt==1&&(b.length<5||b.length>60)){alert("地址长度为5~60个字符");g.focus();return false}return true},event:function(){var b=this;this.$dialog.find(".btn-award").click(function(g){g.preventDefault();if(!b.check()){return false}var f=a.trim(b.$dialog.find(".mobile").val()),d=a.trim(b.$dialog.find(".name").val()),c=a.trim(b.$dialog.find(".address").val());b.disable();getResult("comedian/award/",{puid:b.puid,ph:f,rn:encodeURIComponent(d),ad:b.pt==1?encodeURIComponent(c):"",yp:openid},"callbackComedianAward",this.$dialog)});this.$dialog.find(".btn-again").click(function(c){c.preventDefault();b.$dialog.removeClass(b.SUCCESS_CLS);H.dialog.lottery.open()});this.$dialog.find(".btn-close").click(function(c){c.preventDefault();if(!b.check()){return false}});if(is_android()){this.iscroll=new IScroll(this.$dialog.find(".dialog")[0],{mouseWheel:true,preventDefaultException:{tagName:/^(A|INPUT|TEXTAREA|BUTTON|SELECT)$/},});this.$dialog.find(".dialog-inner").css("padding-bottom","70%");this.$dialog.find("input").focus(function(){if(b.iscroll){b.iscroll.refresh();b.iscroll.scrollToElement(a(this)[0])}})}},tpl:function(){var b=simpleTpl();b._('<section class="modal iscroll" id="award-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="ah-awarddialog-closebtn" data-collect-desc="领奖弹层-关闭按钮"></a>')._('<div class="dialog award-dialog">')._('<div class="dialog-inner">')._('<div class="box">')._('<div class="prize"></div>')._("</div>")._('<div class="ctrl">')._('<h2>运气太好了，您获得<strong class="s-award"></strong></h2>')._('<div class="content">')._("<p>请填写您的姓名及联系方式，以便顺利领奖</p>")._('<input type="text" class="name" placeholder="姓名" />')._('<input type="number" class="mobile" placeholder="手机号码" />')._('<input type="text" class="address" placeholder="地址" />')._("</div>")._('<a href="#" class="btn btn-award" data-collect="true" data-collect-flag="ah-awarddialog-awardbtn" data-collect-desc="领奖弹层-领奖按钮">确定</a>')._("</div>")._('<div class="ctrl award-succ">')._("<h2>实物奖品将会由工作人员联系您进行发放，积分奖品则会继续累积。</h2>")._('<h3>您还有<strong class="s-lc"></strong>次抽奖机会</h3>')._('<a href="#" class="btn btn-again" data-collect="true" data-collect-flag="ah-awarddialog-againbtn" data-collect-desc="领奖弹层-再来一次">再来一次</a>')._('<a href="#" class="btn btn-result" data-collect="true" data-collect-flag="ah-awarddialog-resultbtn" data-collect-desc="领奖弹层-查看战绩">查看战绩</a>')._("</div>")._("</div>")._('<p class="dialog-copyright none">本活动最终解释权归安徽卫视 《超级笑星》 栏目所有</p>')._("</div>")._("</section>");return b.toString()}},confirm:{$dialog:null,$focus_obj:null,open:function(b){this.$focus_obj=b;if(this.$dialog){this.$dialog.removeClass("none")}else{this.$dialog=a(this.tpl());H.dialog.$container.append(this.$dialog)}H.dialog.relocate();this.event()},close:function(){this.$dialog&&this.$dialog.addClass("none")},event:function(){var b=this;this.$dialog.find(".btn-confirm").click(function(c){c.preventDefault();b.close()})},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="confirm-dialog">')._('<div class="dialog confirm-dialog relocated">')._('<div class="content">资料填写不全，将被视为自愿放弃奖品。</div>')._('<div class="ctrl">')._('<a href="#" class="btn btn-confirm">返回填写</a>')._("</div>")._("</div>")._("</section>");return b.toString()}},tip:{$dialog:null,open:function(){H.dialog.open.call(this)},close:function(){this.$dialog&&this.$dialog.remove()},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="tip-dialog">')._('<div class="dialog tip-dialog relocated">')._("<h2></h2>")._('<a href="#" class="btn btn-close">确定</a>')._("</div>")._("</section>");return b.toString()}}};W.callbackComedianAward=function(b){H.dialog.award.enable();if(b.code==0){H.dialog.award.succ();return}alert(b.message)};W.callbackComedianShare=function(b){if(b.code==0){H.dialog.lottery.update(b.lc)}};W.callbackComedianLottery=function(b){if(b.code==0){H.dialog.lottery.update(b.lc);H.dialog.lottery.animate(b)}else{setTimeout(function(){alert(b.message);H.dialog.lottery.reset()},400)}};W.callbackComedianQuerylc=function(b){if(b.code==0){W.jo=b.jo;W.gc=b.gc;W.hc=b.hc;W.lc=b.lc;H.dialog.lottery.update(b.lc)}};W.callbackRuleHandler=function(b){if(b.code==0&&b.rule){H.dialog.rule.update(b.rule)}};W.callbackComedianTranscript=function(b){H.dialog.result.update(b)};W.callbackComedianPublish=function(b){if(b.code==0){H.cjdialog.result(b)}}})(Zepto);H.dialog.init();(function(a){H.index={$pages:a("#pages"),from:getQueryString("from"),$ctrl_wrapper:a(".ctrl-wrapper"),$ttips:a(".ttips"),$pv_tips:a("#pv-tips"),$pv_num:a("#pv-num"),$next_tips:a("#next-tips"),$next_num:a("#next-num"),init:function(){var b=this;if(yao_openid){this.$pages.removeClass("disabled")}else{this.$pages.addClass("disabled");return}if(this.from&&window.localStorage&&!localStorage.nextoneGuided){setTimeout(function(){H.dialog.guide.open()},800)}getResult("comedian/index",{tsuid:stationUuid,yp:openid,serviceNo:serviceNo},"callbackComedianIndex",true);this.update_pv();this.update_record();H.weixin.init()},init_audio:function(c){H.audio.init(c);H.audio.event_handler();var b=setInterval(function(){if(!H.audio.audio){return}H.audio.show();H.audio.audio.play();clearInterval(b)},1000);a(document).one("touchstart",function(){if(a(".page").eq(0).hasClass("current")){H.audio.audio.play()}})},update_pv:function(){getResult("log/servicepv/"+serviceNo,{},"callbackCountServicePvHander");setInterval(function(){getResult("log/servicepv/"+serviceNo,{},"callbackCountServicePvHander")},5000)},update_record:function(){W.lottery_record=W.lottery_record||[];getResult("comedian/querywin",{tsuid:stationUuid,tcuid:channelUuid},"callbackComedianQuerywin");setInterval(function(){getResult("comedian/querywin",{tsuid:stationUuid,tcuid:channelUuid},"callbackComedianQuerywin")},600000)},show_pvtip:function(){this.$ttips.addClass("none");this.$pv_tips.removeClass("none")},show_nexttip:function(){this.$ttips.addClass("none");this.$next_tips.removeClass("none")}};H.weixin={init:function(){a(document).wx({img_url:share_img,desc:share_desc,title:share_title,callback:function(d,e){var b="安徽卫视分享"+(e=="message"?"给朋友":"到朋友圈"),c="ah-share-"+e;recordUserOperate(openid,b,c);if(!/\:cancel$/i.test(d.err_msg)){recordUserOperate(openid,b+"成功",c+"-success");getResult("comedian/share",{puid:H.page.puid,yp:openid},"callbackComedianShare")}}})}};H.page={puid:0,curr_time:new Date().getTime(),$pages:a("#pages"),$top_outer:a("#ui-outer-top"),$top_inner:a("#ui-inner-top"),s_type:0,TURNED_CLS:"turned",STARTING_CLS:"starting",timeout:true,time:4000,init:function(d){var c=this;a("#show-result").before(this.tpl(d));if(this.$pages.find(".page").length<=1){return}H.myScroll.init(d);var e=c.$pages.parallax({direction:"horizontal",swipeAnim:"default",drag:true,loading:false,indicator:false,arrow:false,onchange:function(f,g,i){if(f>0){var h=i=="forward"?"右翻":(i=="backward"?"左翻":"");recordUserOperate(openid,h+"查看第"+f+"组选手","ah-pagechange-"+f)}}});var b=a(window).height();a(".xs-wrapper").css("height",b*0.4).css("marginTop",b*0.2).find("img").css("maxHeight",b*0.4);a(".ctrl-wrapper").css("height",b*0.4);c.event_handler();c.progress();setInterval(function(){a.each(W.pages_info,function(f,g){if(g.state>1&&g.guid){getResult("comedian/group/"+g.guid,{},"callbackComedianGroup")}})},5000)},to:function(d){var e=a(window).width(),f=this.$pages.find(".page"),c=f.index('[data-guid="'+(d||0)+'"]');c=c>-1?c:1;var b=a(".page").eq(c);if(c==0||b.hasClass("none")){return}f.removeClass("current");b.addClass("current");this.$pages.css("-webkit-transform","matrix(1, 0, 0, 1, -"+(c*e)+", 0)");window.curPage=c},progress:function(){var b=this;a(".progress-bar").each(function(g){var h=a(this),d=h.prev(),f=h.attr("data-guid"),e=b.get_page(f),i=e.prev(),c=parseInt(e.attr("data-sr"));h.progress({index:g,cTime:b.curr_time,callback:function(m){var j=a(".page").not(function(){return a(this).hasClass("none")}).last();if(!j.hasClass(b.TURNED_CLS)){var l=j.attr("data-state");if(!l){return}j.addClass(b.TURNED_CLS);if(l>=3&&j.next().length==0){var k=a(".page").eq(1);if(b.timeout){b.timeout=false;setTimeout(function(){if(a("#show-result").hasClass("none")){b.to(k.length>0?k.attr("data-guid"):0)}},b.time)}else{if(a("#show-result").hasClass("none")){b.to(k.length>0?k.attr("data-guid"):0)}}}else{if(b.timeout){b.timeout=false;setTimeout(function(){if(a("#show-result").hasClass("none")){b.to(j.attr("data-guid"))}},b.time)}else{if(a("#show-result").hasClass("none")){b.to(j.attr("data-guid"))}}}}b.update_state(f)},stCallback:function(k){e.addClass("none");var j=g>0?W.pages_info[g-1]["state"]:0;if(j>=3||j==0){H.index.show_nexttip();e.addClass(b.STARTING_CLS).removeClass("none")}},sdCallback:function(j){e.removeClass(b.STARTING_CLS).removeClass("none");H.index.show_pvtip()},otCallback:function(j){e.find(".cwc-item").addClass("none");e.find(".cw-voted").removeClass("none")},ptCallback:function(j){e.find(".cwc-item").addClass("none");e.find(".cw-voted").removeClass("none");e.find(".xs-wrapper").addClass("type t"+c);if(e.attr("data-vote")){e.removeAttr("data-vote");W.gc++;if(parseInt(e.attr("data-type"))==c){W.lc+=1;W.hc+=1}}}})})},event_handler:function(){var b=this;this.$pages.delegate(".btn-vote","click",function(g){g.preventDefault();var f=a(this).attr("data-type"),d=a(this).closest(".page"),c=d.attr("data-guid");if(d.hasClass(b.STARTING_CLS)){H.dialog.tip.open();return false}getResult("comedian/guess",{guid:c,yp:openid,rsl:f},"callbackComedianGuess",true)})},get_page:function(b){return a("#page-"+b)},vote:function(e,f){var d=this.get_page(f),c=parseInt(d.attr("data-sr")),b=this.get_attr(e);d.find(".cwc-item").addClass("none");d.find(".cw-voted").removeClass("none");d.attr("data-vote",true).attr("data-type",e).attr(b,parseInt(d.attr(b))+1).attr("data-total",parseInt(d.attr("data-total"))+1);H.page.update_state(f)},update_rate:function(f){if(f.guid){var c=this.get_page(f.guid),b=f.pc||0,e=f.wc||0,g=f.wdc||0,d=b+e+g;c.attr("data-t1",b).attr("data-t2",e).attr("data-t3",g).attr("data-total",d);H.page.update_state(f.guid)}},update_state:function(m){var h=this,f=this.get_page(m),i=f.attr("data-type"),g=h.get_attr(i),j=f.attr("data-total"),d=f.find(".cw-vote"),e=f.find(".cw-voted"),n=f.find(".cwr-ctrl"),c=f.find(".tips-txt"),l=f.find(".btn-result"),k=f.find(".btn-lottery");if(W.lc>0){k.removeClass("none");c.text("晋级结果在节目最后揭晓,猜对一次即有一次抽奖机会")}else{c.text("晋级结果在节目最后揭晓,猜对一次即有一次抽奖机会");k.addClass("none");if(W.hc>0){}else{}}if(W.jo||W.gc>0){l.removeClass("none")}else{l.addClass("none");!d.hasClass("none")&&c.text("晋级结果在节目最后揭晓,猜对一次即有一次抽奖机会");!e.hasClass("none")&&c.text("晋级结果在节目最后揭晓,猜对一次即有一次抽奖机会")}n.removeClass("none");if(e.hasClass("none")){return}var b=f.find("dl").attr("data-percent",0);f.find(".pg").each(function(){var o=parseInt(b.attr("data-percent"))||0;if(a(this).closest(".cv-progress-tt").length>0){percent=100-o}else{percent=Math.round(f.attr(h.get_attr(a(this).attr("data-type")))*100/j);b.attr("data-percent",percent+o)}percent=Math.max(0,percent);percent=Math.min(100,percent);if(a(this).attr("data-type")==3){var p=100-parseInt(a(this).parent().parent().find(".pgt_jj").text().replace("%"));a(this).parent().parent().find(".pgt_tt").text(p+"%");a(this).css("width",p+"%")}else{a(this).parent().parent().find(".pgt_jj").text(percent+"%");a(this).css("width",percent+"%")}});f.find("dt").text(this.get_label(i));f.find(".cwc-item").addClass("none");e.removeClass("none");c.text("晋级结果在节目最后揭晓,猜对一次即有一次抽奖机会")},get_attr:function(b){return"data-t"+b},get_label:function(c){var b=["晋级","待定","淘汰"];if(c>0){return"您猜此选手将会"+b[parseInt(c)-1]}else{return"用户的竞猜结果："}},tpl:function(c){var l=simpleTpl(),k=c.items||[];this.curr_time=timestamp(c.cud);this.puid=c.puid;H.dialog.puid=this.puid;W.jo=c.jo;W.gc=c.gc;W.hc=c.hc;W.lc=c.lc;H.index.$pv_num.text(c.pv).closest(".pv-tips").removeClass("none");for(var d=0,g=k.length;d<g;d++){var f=k[d].ij,j=timestamp(k[d].pt)<=timestamp(c.cud),b=f?"none":(j?"none":""),h=f?"":"none",e="none";W.pages_info=W.pages_info||{};W.pages_info[d]={guid:k[d].guid,type:k[d].ij};l._('<div class="page" id="page-'+k[d].guid+'" data-type="'+k[d].ij+'" data-guid="'+k[d].guid+'" data-sr="'+k[d].sr+'" data-t1="'+k[d].pc+'" data-t2="'+k[d].wc+'" data-t3="'+k[d].wdc+'" data-total="'+(k[d].pc+k[d].wc+k[d].wdc)+'">');l._('<div class="xs-wrapper type t'+(j?k[d].sr:"")+'">')._('<img src="'+k[d].pi+'" />')._("</div>")._('<div class="ctrl-wrapper">')._('<div class="cw-progress">')._('<p class="progress-bar" data-guid="'+k[d].guid+'" ptime="'+timestamp(k[d].pt)+'" etime="'+timestamp(k[d].set)+'" stime="'+timestamp(k[d].sst)+'"></p>')._("</div>");l._('<div class="cwc-item cw-vote '+b+'">')._('<div class="cw-btns">')._('<a href="#" id="btn-jj'+d+'" class="btn-vote btn-jinji cli-jinji'+d+'" data-type="1" data-collect="true" data-collect-flag="ah-index-votejj" data-collect-desc="安徽首页-晋级按钮" ></a>')._('<a href="#" id="btn-tt'+d+'" class="btn-vote btn-taotai cli-taotai'+d+'" data-type="3" data-collect="true" data-collect-flag="ah-index-votett" data-collect-desc="安徽首页-淘汰按钮"></a>')._('<span style="line-height: 58px;  font-size: 16px;  color: red;position: absolute;left:38%;z-index:-1;">晋级</span>')._('<span style="line-height: 58px;  font-size: 16px;  color: green;position: absolute;right:38%;z-index:-1;">淘汰</span>')._("</div>")._("</div>");l._('<div class="cwc-item cw-voted '+h+'">')._('<dl class="vote-result">')._('<dt>您猜此选手将会<span class="stt"></span></dt>')._('<dd class="clearfix">')._('<div class="mes-jj">晋级')._('<br/><span class="pgt_jj" style="font-size:16px;">0%</span></div>')._('<div class="mes-tt" >淘汰')._('<br/><span class="pgt_tt" style="font-size:16px;">0%</span></div>')._('<div class="cv-progress cv-progress-jj">')._('<p class="pg" data-type="'+1+'" style=" float: left;"></p>')._('<p class="pg" data-type="'+3+'" style=" float: left;background:rgba(100,170,5,1);"></p>')._("</div>")._("</dd>")._("</dl>")._("</div>");l._('<div class="cwc-item cw-result '+e+'">')._('<div class="movie" data-guid="'+k[d].guid+'" data-collect="true" data-collect-flag="ah-index-tomovie" data-collect-desc="安徽首页-进入视频页">')._('<div class="cover"><img src="'+k[d].vi+'" /></div>')._('<div class="content">')._('<h3 class="ellipsis">《超级笑星》<span>'+k[d].da+"</span></h3>")._("<p>"+k[d].vd+"</p>")._('<a href="#">立即分享</a>')._("</div>")._("</div>")._("</div>");l._('<div class="cwr-ctrl ctrl">')._('<p class="tips"><span class="tips-txt"></span><br/><a href="#" class="btn-rule" data-collect="true" data-collect-flag="ah-index-rulebtn" data-collect-desc="安徽首页-规则弹层按钮">查看规则</a></p>')._("</div>");l._("</div>")._("</div>")}return l.toString()}};H.myScroll={startX:0,startY:0,x:0,y:0,aboveY:0,is_jj:true,cl:"",mam:60,init:function(c){for(var b=0;b<c.items.length;b++){document.getElementById("btn-jj"+b).addEventListener("touchstart",this.touchSatrt,false);document.getElementById("btn-jj"+b).addEventListener("touchmove",this.touchMove,false);document.getElementById("btn-jj"+b).addEventListener("touchend",this.touchEnd,false);document.getElementById("btn-tt"+b).addEventListener("touchstart",this.touchSatrt,false);document.getElementById("btn-tt"+b).addEventListener("touchmove",this.touchMove,false);document.getElementById("btn-tt"+b).addEventListener("touchend",this.touchEnd,false)}},touchSatrt:function(b){cl=b.srcElement.classList[2];b.preventDefault();var c=b.touches[0];a("#pages").addClass("disabled");startY=c.pageY;startX=c.pageX;is_jj=startX>150?false:true;mam=a(this).parent().width()/2-60},touchMove:function(b){b.preventDefault();var c=b.touches[0];y=c.pageY-startY;x=c.pageX-startX;if(is_jj){x=x>mam?mam:x;x=x<0?0:x;a("."+cl).css("margin-left",x+"px")}else{x=-x;x=x>mam?mam:x;x=x<0?0:x;a("."+cl).css("margin-right",x+"px")}},touchEnd:function(f){f.preventDefault();a("."+cl).css("margin-left","0px");a("."+cl).css("margin-right","0px");a("#pages").removeClass("disabled");if(x>=mam){var d=a(this).attr("data-type"),c=a(this).closest(".page"),b=c.attr("data-guid");if(c.hasClass(H.page.STARTING_CLS)){H.dialog.tip.open();return false}getResult("comedian/guess",{guid:b,yp:openid,rsl:d},"callbackComedianGuess",true)}}};W.callbackComedianIndex=function(b){if(b.code!=0){return}var c=timestamp(b.put)-timestamp(b.cud)<=0?50:timestamp(b.put)-timestamp(b.cud);setTimeout(function(){H.cjdialog.init()},parseInt(c));H.page.init(b);H.index.init_audio(b.vul)};W.callbackComedianGuess=function(b){if(b.code!=0){alert(b.message);return}H.page.vote(b.rsl,b.guid)};W.callbackCountServicePvHander=function(b){if(b.c){H.index.$pv_num.text(b.c)}};W.callbackComedianGroup=function(b){H.page.update_rate(b)};W.callbackComedianShare=function(b){if(b.code==0){W.jo=true;W.gc=b.gc;W.hc=b.hc;W.lc=b.lc}};W.callbackComedianQuerywin=function(b){if(b.code==0){W.lottery_record=b.items||[]}}})(Zepto);H.index.init();