var stars=[{id:1,name:"乔任梁",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E4%B9%94%E4%BB%BB%E6%A2%81.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E4%B9%94%E4%BB%BB%E6%A2%81.mp3",},{id:2,name:"俞飞鸿",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E4%BF%9E%E9%A3%9E%E9%B8%BF.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E4%BF%9E%E9%A3%9E%E9%B8%BF.mp3"},{id:3,name:"刘诗诗",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%88%98%E8%AF%97%E8%AF%97.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%88%98%E8%AF%97%E8%AF%97.mp3"},{id:4,name:"吴奇隆",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%90%B4%E5%A5%87%E9%9A%86.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%90%B4%E5%A5%87%E9%9A%86.mp3"},{id:5,name:"孙艺洲",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%AD%99%E8%89%BA%E6%B4%B2.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%AD%99%E8%89%BA%E6%B4%B2.mp3"},{id:6,name:"尚雯婕",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%B0%9A%E9%9B%AF%E5%A9%95.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%B0%9A%E9%9B%AF%E5%A9%95.mp3"},{id:7,name:"徐正曦",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%BE%90%E6%AD%A3%E6%9B%A6.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%BE%90%E6%AD%A3%E6%9B%A6.mp3"},{id:8,name:"李易峰",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E6%9D%8E%E6%98%93%E5%B3%B0.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E6%9D%8E%E6%98%93%E5%B3%B0.mp3"},{id:9,name:"胡歌",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E8%83%A1%E6%AD%8C.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E8%83%A1%E6%AD%8C.mp3"},{id:10,name:"赵丽颖",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E8%B5%B5%E4%B8%BD%E9%A2%96.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E8%B5%B5%E4%B8%BD%E9%A2%96.mp3"},{id:11,name:"钟汉良",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%92%9F%E6%B1%89%E8%89%AF.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%92%9F%E6%B1%89%E8%89%AF.mp3"},{id:12,name:"陈伟霆",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%99%88%E4%BC%9F%E9%9C%86.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%99%88%E4%BC%9F%E9%9C%86.mp3"},{id:13,name:"陈数",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%99%88%E6%95%B0.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%99%88%E6%95%B0.mp3"},{id:14,name:"陈赫",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%99%88%E8%B5%AB.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%99%88%E8%B5%AB.mp3"},{id:15,name:"颖儿",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%A2%96%E5%84%BF.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%A2%96%E5%84%BF.mp3"},{id:16,name:"霍建华",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%9C%8D%E5%BB%BA%E5%8D%8E.jpg",type:"text",wish:"元宝祝你新年结金玉良缘"},{id:17,name:"周迅",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%91%A8%E8%BF%85.jpg",type:"text",wish:"九儿祝你新年红似高粱"},{id:18,name:"张歆艺",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%BC%A0%E6%AD%86%E8%89%BA.jpg",type:"text",wish:"新年和你一起二！"},{id:19,name:"张杰",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%BC%A0%E6%9D%B0.jpg",type:"text",wish:"新年，和爱的人一起度过"},{id:20,name:"张嘉译",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%BC%A0%E5%98%89%E8%AF%91.jpg",type:"text",wish:"新年快乐，大叔爱你"}];var virtualDatas=[{id:1,message:" <p>2014年您辛苦了，</p><p>让我给你揉揉肩吧！</p>",priurl:"http://cdn.holdfun.cn/ahtv/images/vartual_prize.png"},{id:2,message:" <p>2014年您辛苦了，</p><p>让我给你按按摩吧！</p>",priurl:"http://cdn.holdfun.cn/ahtv/images/vartual_prize_am.png",},{id:3,message:" <p>2014年您辛苦了，</p><p>让我给你捶捶背吧！</p>",priurl:"http://cdn.holdfun.cn/ahtv/images/vartual_prize_cb.png",},{id:4,message:" <p>2014年您辛苦了，</p><p>让我给你松松腿吧！</p>",priurl:"http://cdn.holdfun.cn/ahtv/images/vartual_prize_st.png",},];WeixinApi.ready(function(a){var b={appId:shaketv_token,imgUrl:share_img,link:add_param(share_url.replace("stars.html","index.html"),"resopenid",hex_md5(openid),true),desc:share_desc,title:share_title};var c={favorite:false,async:true,ready:function(){var d=$("#btn-sendcard");if(d&&!d.hasClass("shared")){d.trigger("click")}this.dataLoaded({title:share_title,link:add_yao_prefix(add_param(share_url.replace("stars.html","index.html"),"resopenid",hex_md5(openid),true)),desc:share_desc,imgUrl:share_img})}};a.shareToFriend(b,c);a.shareToTimeline(b,c);a.generalShare(b,c)});(function(a){H.stars={$stars:a("#stars"),$btn_card:a("#btn-card"),$pv:a("#ui-pv"),expires:{expires:7},init:function(){this.shake_tv();H.utils.resize();this.event();var e=simpleTpl(),c=W.stars||[];for(var d=0,b=c.length;d<b;d++){e._('<dd data-type="'+c[d].type+'" data-id="'+(d+1)+'" data-wish="'+c[d].wish+'">');if(c[d].type=="audio"){e._('<audio preload="auto" class="audio none" src="'+c[d].wish+'"></audio>')}e._('<div class="avatar">')._('<img src="'+(c[d].avatar||"./images/blank.gif")+'" />')._("</div>")._("<span>"+c[d].name+"</span>")._("</dd>")}this.$stars.html(e.toString());this.update_pv()},shake_tv:function(){var d=this,b=a.fn.cookie("da-nickname"),c=a.fn.cookie("da-avatar");if(!b||!c){W.shaketv&&shaketv.authorize(shaketv_token_avatar,"userinfo",function(e){if(e.errorCode==0){getResult("shaketv/userinfo?openid="+openid+"&code="+e.code,{},"callbackShaketvUserinfoHandler",true)}else{window.location.href="index.html"}})}},update_pv:function(){getResult("log/servicepv/"+serviceNo,{},"callbackCountServicePvHander");setInterval(function(){getResult("log/servicepv/"+serviceNo,{},"callbackCountServicePvHander")},5000)},event:function(){var b=this;this.$stars.delegate("dd","click",function(j){var i=a(this),g=i.siblings("dd"),f=i.attr("data-type");if(f=="audio"){if(g.hasClass("scale")){return}g.removeClass("selected");a(this).addClass("selected scale");b.$stars.find("dt").remove();var d=a(this).find("audio");d.get(0).play();d.on("playing",function(){console.log("playing")}).on("ended",function(){console.log("ended");d.get(0).pause();i.removeClass("scale")})}else{g.removeClass("selected");a(this).addClass("selected tips");b.$stars.find("dt").remove();var k=parseInt(i.attr("data-id")),c,h="";if(k%4==0){c=k}else{c=Math.ceil(k/4)*4;h="a"+(k%4)}b.$stars.find("dd").eq(c-1).after('<dt class="arrow-box '+h+'"><div class="tip">'+i.attr("data-wish")+"</div></dt>")}});this.$btn_card.click(function(d){d.preventDefault();var c=b.$stars.find(".selected");if(c.length==0){alert("请先选择您喜欢的明星");return false}window.location.href="card.html?id="+(c.attr("data-id")||1)})}};H.utils={$main:a("#main"),resize:function(){var d=this,c=a(window).width(),b=a(window).height();this.$main.css("minHeight",b)}};W.callbackCountServicePvHander=function(b){if(b.c){H.stars.$pv.find("strong").text(b.c);H.stars.$pv.removeClass("none")}};W.callbackShaketvUserinfoHandler=function(b){if(b.nickname){a.fn.cookie("da-nickname",b.nickname,H.stars.expires)}if(b.headimgurl){a.fn.cookie("da-avatar",b.headimgurl,H.stars.expires)}}})(Zepto);H.stars.init();