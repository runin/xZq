var stars=[{id:1,name:"乔任梁",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E4%B9%94%E4%BB%BB%E6%A2%81.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E4%B9%94%E4%BB%BB%E6%A2%81.mp3",},{id:2,name:"俞飞鸿",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E4%BF%9E%E9%A3%9E%E9%B8%BF.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E4%BF%9E%E9%A3%9E%E9%B8%BF.mp3"},{id:3,name:"刘诗诗",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%88%98%E8%AF%97%E8%AF%97.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%88%98%E8%AF%97%E8%AF%97.mp3"},{id:4,name:"吴奇隆",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%90%B4%E5%A5%87%E9%9A%86.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%90%B4%E5%A5%87%E9%9A%86.mp3"},{id:5,name:"孙艺洲",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%AD%99%E8%89%BA%E6%B4%B2.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%AD%99%E8%89%BA%E6%B4%B2.mp3"},{id:6,name:"尚雯婕",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%B0%9A%E9%9B%AF%E5%A9%95.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%B0%9A%E9%9B%AF%E5%A9%95.mp3"},{id:7,name:"徐正曦",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%BE%90%E6%AD%A3%E6%9B%A6.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E5%BE%90%E6%AD%A3%E6%9B%A6.mp3"},{id:8,name:"李易峰",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E6%9D%8E%E6%98%93%E5%B3%B0.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E6%9D%8E%E6%98%93%E5%B3%B0.mp3"},{id:9,name:"胡歌",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E8%83%A1%E6%AD%8C.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E8%83%A1%E6%AD%8C.mp3"},{id:10,name:"赵丽颖",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E8%B5%B5%E4%B8%BD%E9%A2%96.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E8%B5%B5%E4%B8%BD%E9%A2%96.mp3"},{id:11,name:"钟汉良",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%92%9F%E6%B1%89%E8%89%AF.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%92%9F%E6%B1%89%E8%89%AF.mp3"},{id:12,name:"陈伟霆",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%99%88%E4%BC%9F%E9%9C%86.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%99%88%E4%BC%9F%E9%9C%86.mp3"},{id:13,name:"陈数",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%99%88%E6%95%B0.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%99%88%E6%95%B0.mp3"},{id:14,name:"陈赫",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%99%88%E8%B5%AB.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%99%88%E8%B5%AB.mp3"},{id:15,name:"颖儿",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%A2%96%E5%84%BF.jpg",type:"audio",wish:"http://cdn.holdfun.cn/ahtv/audios/%E9%A2%96%E5%84%BF.mp3"},{id:16,name:"霍建华",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E9%9C%8D%E5%BB%BA%E5%8D%8E.jpg",type:"text",wish:"元宝祝你新年结金玉良缘"},{id:17,name:"周迅",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%91%A8%E8%BF%85.jpg",type:"text",wish:"九儿祝你新年红似高粱"},{id:18,name:"张歆艺",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%BC%A0%E6%AD%86%E8%89%BA.jpg",type:"text",wish:"新年和你一起二！"},{id:19,name:"张杰",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%BC%A0%E6%9D%B0.jpg",type:"text",wish:"新年，和爱的人一起度过"},{id:20,name:"张嘉译",avatar:"http://cdn.holdfun.cn/ahtv/images/stars/%E5%BC%A0%E5%98%89%E8%AF%91.jpg",type:"text",wish:"新年快乐，大叔爱你"}];var virtualDatas=[{id:1,message:" <p>2014年您辛苦了，</p><p>让我给你揉揉肩吧！</p>",priurl:"http://cdn.holdfun.cn/ahtv/images/vartual_prize.png"},{id:2,message:" <p>2014年您辛苦了，</p><p>让我给你按按摩吧！</p>",priurl:"http://cdn.holdfun.cn/ahtv/images/vartual_prize_am.png",},{id:3,message:" <p>2014年您辛苦了，</p><p>让我给你捶捶背吧！</p>",priurl:"http://cdn.holdfun.cn/ahtv/images/vartual_prize_cb.png",},{id:4,message:" <p>2014年您辛苦了，</p><p>让我给你松松腿吧！</p>",priurl:"http://cdn.holdfun.cn/ahtv/images/vartual_prize_st.png",},];WeixinApi.ready(function(a){var b={appId:shaketv_token,imgUrl:share_img,link:add_param(share_url.replace("stars.html","index.html"),"resopenid",hex_md5(openid),true),desc:share_desc,title:share_title};var c={favorite:false,async:true,ready:function(){var d=$("#btn-sendcard");if(d&&!d.hasClass("shared")){d.trigger("click")}this.dataLoaded({title:share_title,link:add_yao_prefix(add_param(share_url.replace("stars.html","index.html"),"resopenid",hex_md5(openid),true)),desc:share_desc,imgUrl:share_img})}};a.shareToFriend(b,c);a.shareToTimeline(b,c);a.generalShare(b,c)});(function(a){H.audio={$audio:null,$pages:a("#pages"),audioEventListener:function(b){$audio.addEventListener(b,function(){})},play:function(b){$audio=new Audio();$audio.src=b;H.audio.audioEventListener("ended");$audio.play()},pause:function(){$audio.pause()},replay:function(){$audio.play()},to:function(d){var e=a(window).width(),f=this.$pages.find(".page"),c=f.index('[data-guid="'+(d||0)+'"]');c=c>-1?c:1;var b=a(".page").eq(c);if(c==0||b.hasClass("none")){return}f.removeClass("current");b.addClass("current");this.$pages.css("-webkit-transform","matrix(1, 0, 0, 1, -"+(c*e)+", 0)");window.curPage=c}};H.award={$awardClose:a("#award-close"),$award_message:a("#award-message"),is_dbclick:false,init:function(){a("#award-confirm").click(function(){if(!H.award.is_dbclick){H.award.is_dbclick=true;H.award.awardConfirm()}setTimeout(function(){H.award.is_dbclick=false},500)});a("#award-close").click(function(){H.award.closeAward()})},closeAward:function(){H.lottery.awardMessage(false)},checkInfo:function(){var c=a("#awardname");var b=a("#award-telphone");var e=a("#award-address");var d=/^1\d{10}$/;if(c.val().trim()==""){alert("请输入姓名");return false}else{if(b.val()==""){alert("请输入手机号码");return false}else{if(d.test(b.val())==false){alert("请输入正确的手机号");return false}else{return true}}}},confirmInfo:function(){},awardConfirm:function(){var b=H.award.checkInfo();if(b){H.lottery.award_flag=false;a("#pack-gift-btn span").text("去打包贺礼");getResult("ceremony/award",{oi:openid,ph:a("#award-telphone").val(),rn:a("#awardname").val(),ad:a("#award-address").val()},"callbackAwardHandler")}}};H.lottery={count:2,openid:openid,award:getQueryString("award"),soi:getQueryString("soi"),sn:getQueryString("sn"),lottery_rate:3,award_flag:true,expires:{expires:7},forjoin:null,init:function(){if(this.openid==""){H.lottery.lineChange(false)}else{if(this.soi==""||this.sn==""){H.audio.play("http://cdn.holdfun.cn/ahtv/audios/bgmusic.mp3");setTimeout(function(){H.audio.to(2)},this.award?20:4000);H.lottery.shake()}else{if(this.soi!=""&&this.sn!=""){H.audio.to(2);H.lottery.share()}}}H.index.parallaxinit();getResult("log/servicepv/"+serviceNo,{},"callbackCountServicePvHander");forjoin=setInterval(function(){getResult("log/servicepv/"+serviceNo,{},"callbackCountServicePvHander")},5000);a("#wait-try-btn").click(function(b){a(this).parent().parent().addClass("none");a("#pages").removeClass("disabled")})},joincount:function(b){a("#person-join-count strong").text(b.c)},shake:function(){H.lottery.lineChange(true)},share:function(){a("#lottery-message").removeClass("none");a("#pages").addClass("disabled");H.lottery.lineChange(true)},rate:function(){var b=parseInt(Math.random()*100)+1;return parseInt(H.lottery.lottery_rate)>=b},drawlottery:function(){var b=H.lottery.rate();var d=a.fn.cookie("result-max"+this.openid);var c=2;if(parseInt(d)==1){c=2;b=false}if(this.soi!=""&&this.sn!=""){a.fn.cookie("result-type-"+this.openid+"-"+this.soi+"-"+this.sn,"share",this.expires)}else{a.fn.cookie("result-type-"+this.openid,"shake",this.expires)}if(b){getResult("ceremony/lottery",{oi:this.openid},"callbackLotteryHandler")}else{var e=parseInt(Math.random()*4)+2;H.lottery.virtualPrize(true,e);a.fn.cookie("result-"+this.openid,e,this.expires);a("#pack-gift-btn").click(function(){window.location.href="stars.html"})}},awardMessage:function(b){if(b){a("#award-message").removeClass("none");a("#award-close").removeClass("none");a("#pages").addClass("disabled");H.award.init()}else{a("#award-message").addClass("none");a("#award-close").addClass("none");a("#pages").removeClass("disabled")}},lineChange:function(b){if(b){H.index.appentHTML_("page-2",'<section class="draw-line" id="draw-line"><img src="./images/bg_sz.png" class="draw-line-image" id="draw-line-image"><div class="sz-click" id="sz-click" ><div/></section><section class="to-draw-light" id="to-draw-light"><img src="./images/ah_sz_light.png" class="to-draw-light-image"></section>');H.myScroll.init()}else{a("#person-join-count").addClass("none");a("#word").remove();a("#draw-line").remove();a("#to-draw-light").remove();a("#to-draw").remove()}},lineClick:function(){a("#draw-line-image").css("-webkit-animation-name","clickcurtain");a("#draw-line-image").css("-webkit-animation-duration","1s");a("#draw-line-image").css("-webkit-animation-fill-mode","forwards");a("#sz-click").css("bottom","4%")},scrollLottery:function(){window.clearInterval(forjoin);if(H.lottery.soi!=""||H.lottery.sn!=""){var d=a.fn.cookie("result-type-"+H.lottery.openid+"-"+H.lottery.soi+"-"+H.lottery.sn);if(d==""||d==null){H.lottery.drawlottery();H.pullCurtain.draw()}else{H.lottery.showPrize();return false}}else{var b=a.fn.cookie("result-"+H.lottery.openid);var c=a.fn.cookie("result-type-"+H.lottery.openid);if(parseInt(b)>0&&c=="shake"){H.lottery.showPrize();return false}else{H.lottery.drawlottery();H.pullCurtain.draw()}}},phonePrize:function(b,d,c){if(b){d=d==""||d==null?"http://cdn.holdfun.cn/ahtv/images/ah_iphone.png":d;c=c==""||c==null?"iPhone6":c;H.index.appentHTML_("page-2","<section class='congratulations-word' id='congratulations-word'><span><p>&nbsp;&nbsp;&nbsp;&nbsp;恭喜你,</p><p>你获得"+c+"一部</p></span></section><section class='shadow-img' id='shadow-img'><img src='"+d+"' class='iphone-image'></section><section class='pack-gift-btn' id='pack-gift-btn'><span><p>去领奖</p></span></section><section class='pack-gift-word' id='pack-gift-word'><span><p>和明星一起去送贺礼，</p><p>小伙伴有机会得到iPhone6哦！</p></span></section>");H.lottery.lineChange(false)}else{a("#congratulations-word").remove();a("#pack-gift-btn").remove();a("#pack-gift-word").remove()}},virtualPrize:function(b,c){if(b){H.index.appentHTML_("page-2","<section class='congratulations-word' id='congratulations-word'><span>"+virtualDatas[c-2].message+"</span></section><section class='vartual-prize-img' id='vartual-prize-img'><img src='"+virtualDatas[c-2].priurl+"' class='congratulations-word-image'></section><section class='pack-gift-btn' id='pack-gift-btn'><span><p>去打包贺礼</p></span></section><section class='pack-gift-word' id='pack-gift-word'><span><p>和明星一起去送贺礼，</p><p>小伙伴有机会得到iPhone6哦！</p></span></section>");H.lottery.lineChange(false)}else{a("#congratulations-word-false").remove();a("#pack-gift-btn").remove();a("#pack-gift-word").remove()}},showPrize:function(){a.fn.cookie("result-"+H.lottery.openid)==1?H.lottery.phonePrize(true,"",""):H.lottery.virtualPrize(true,a.fn.cookie("result-"+H.lottery.openid));H.pullCurtain.draw();a("#pack-gift-btn span").text("去打包贺礼");a("#pack-gift-btn").click(function(){window.location.href="stars.html"})},update:function(c){if(c.result){a.fn.cookie("result-"+this.openid,1,this.expires);a.fn.cookie("result-max"+this.openid,1,this.expires);H.lottery.phonePrize(true,c.pp,c.pn);a("#pack-gift-btn").click(function(){if(H.lottery.award_flag){H.lottery.awardMessage(true)}else{window.location.href="stars.html"}})}else{var b=parseInt(Math.random()*4)+2;a.fn.cookie("result-"+this.openid,b,this.expires);H.lottery.virtualPrize(true,b);a("#pack-gift-btn").click(function(){window.location.href="stars.html"})}},awardPrize:function(b){if(b.result>0){alert("信息提交成功,我们会尽快和您联系")}else{if(b.result<=0){}}H.lottery.awardMessage(false)}};H.index={init:function(){H.utils.resize();this.parallaxinit();W.shaketv&&shaketv.subscribe(shaketv_token,function(b){console.log(b.errorMsg)})},appentHTML_:function(c,b){a("#"+c+"").append(b)},parallaxinit:function(){a(".pages").parallax({direction:"horizontal",swipeAnim:"default",drag:true,loading:false,indicator:false,arrow:false,onchange:function(b,c,d){},orientationchange:function(b){}})}};H.myScroll={startX:0,startY:0,x:0,y:0,aboveY:0,is_move:false,init:function(){document.getElementById("sz-click").addEventListener("touchstart",this.touchSatrt,false);document.getElementById("sz-click").addEventListener("touchmove",this.touchMove,false);document.getElementById("sz-click").addEventListener("touchend",this.touchEnd,false)},touchSatrt:function(b){a("#pages").addClass("disabled");b.preventDefault();var c=b.touches[0];startY=c.pageY},touchMove:function(b){b.preventDefault();var c=b.touches[0];y=c.pageY-startY;this.is_move=true;y=y>45?45:y;y=y<0?0:y;a("#sz-click").css("bottom",20-y/3+"%");a("#draw-line-image").css("bottom",20-y/3+"%")},touchEnd:function(b){a("#pages").removeClass("disabled");if(!this.is_move){H.lottery.lineClick()}b.preventDefault();H.lottery.scrollLottery()},};H.pullCurtain={draw:function(){a("#left_lm").css("-webkit-animation-name","drawcurtain");a("#left_lm").css("-webkit-animation-duration","2s");a("#left_lm").css("-webkit-animation-fill-mode","forwards");a("#right_lm").css("-webkit-animation-name","drawcurtain");a("#right_lm").css("-webkit-animation-duration","2s");a("#right_lm").css("-webkit-animation-fill-mode","forwards");setTimeout(this.drawLine,500)},drawLine:function(){a("#congratulations-word").css("z-index","12");a("#pack-gift-btn").css("z-index","122");a("#pack-gift-word").css("z-index","122");a("#congratulations-word-false").css("z-index","122")}};H.weixin={init:function(){a(document).wx({img_url:share_img,desc:share_desc,title:share_title})}};H.utils={$main:a("#main"),$shadow:a(".shadow"),$indexmain:a(".index-main"),$lottery_message:a("#lottery-message"),$award_close:a("#award-close"),resize:function(){var e=this,d=a(window).width(),b=a(window).height(),c="images/bg.png";this.$main.css("minHeight",b).css("height",b);this.$shadow.css("width",d-90).css("height",d-90).css("margin-left",45);this.$indexmain.css("minHeight",b).css("height",b);this.$award_close.css("top",b*0.02).css("right",b*0.04);a("#award-message").css("width",d*0.8).css("height",b*0.8).css("margin-left",d*0.1);if(b<600){this.$lottery_message.css("width",234).css("height",270).css("margin-left",(d-234)/2).css("margin-top",(b-270)/2)}else{this.$lottery_message.css("width",234).css("height",270).css("margin-left",(d-234)/2).css("margin-top",(b-200)/2)}}};W.callbackLotteryHandler=function(b){H.lottery.update(b)};W.callbackAwardHandler=function(b){H.lottery.awardPrize(b)};W.callbackCountServicePvHander=function(b){H.lottery.joincount(b)}})(Zepto);H.index.init();H.lottery.init();