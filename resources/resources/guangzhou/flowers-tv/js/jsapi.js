//Messager
!function(){var a={},b={},c={parse:function(a){var d,e,f,g,h,b={},c=a.split("&");for(g=0,h=c.length;h>g;g++)d=c[g].split("="),2==d.length&&(e=d[0],f=d[1],-1==e.indexOf("[]")?b[e]=decodeURIComponent(f):(e=e.replace("[]",""),b[e]=b[e]||[],b[e].push(f)));return b},serialize:function(a){var c,d,e,f,g,b=[];for(c in a)if(a.hasOwnProperty(c))if(d=a[c],d instanceof Array)for(e=d,f=0,g=e.length;g>f;f++)d=encodeURIComponent(e[f]),b.push(c+"[]="+d);else d=encodeURIComponent(d),b.push(c+"="+d);return b.join("&")}},d=function(){function d(b,c){this.targets={},this.name=b,this.actionFunc=[],a=c||a,this.initListen()}var a="shake_tv",b=function(a,b){var c="";if(arguments.length<2?c="target error - target and name are both requied":"object"!=typeof a?c="target error - target itself must be window object":"string"!=typeof b&&(c="target error - target name must be string type"),c)throw new Error(c);this.target=a,this.name=b},c="postMessage"in window;return b.prototype.send=c?function(a){this.target.postMessage(a,"*")}:function(b){var c=window.navigator[a+this.name];if("function"!=typeof c)throw new Error("target callback function is not defined");c(b,window)},d.prototype.addTarget=function(a,c){var d=new b(a,c);this.targets[c]=d},d.prototype.initListen=function(){var a=this,b=function(b){"object"==typeof b&&b.data&&(b=b.data);for(var c=0;c<a.actionFunc.length;c++)a.actionFunc[c](b)};c?document["addEventListener"]?window.addEventListener("message",b,!1):document["attachEvent"]&&window.attachEvent("onmessage",b):window.navigator[n+this.name]=b},d.prototype.addAction=function(a){this.actionFunc.push(a)},d.prototype.clear=function(){this.actionFunc=[]},d.prototype.send=function(a){var c,b=this.targets;for(c in b)b.hasOwnProperty(c)&&b[c].send(a)},d}();b.init=function(e){window.parent!=window?(b.messager=new d("iframe"),e&&b.messager.addTarget(e,"parent")):(b.messager=new d("parent"),e&&b.messager.addTarget(e,"iframe")),b.messager.addAction(function(b){b=c.parse(b),(funcName=b.type)&&a[funcName]&&a[funcName](b)})},b.addTarget=function(a,c){b.messager&&b.messager.addTarget(a,c)},b.on=function(b,c){a[b]=c},b.post=function(a){b.messager.send(c.serialize(a))},window.Iframe=b}();
//关注
!function(){function a(a){if(a){var b;return(!window["_loadCss"]||window["_loadCss"].indexOf(a)<0)&&(b=document.createElement("link"),b.setAttribute("type","text/css"),b.setAttribute("rel","stylesheet"),b.setAttribute("href",a),b.setAttribute("id","loadCss"+Math.random()),document.getElementsByTagName("head")[0].appendChild(b),window["_loadCss"]?window["_loadCss"]+="|"+a:window["_loadCss"]="|"+a),!0}}function b(a,b){function f(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||"function"==typeof b&&b()}var d,e,c=document.getElementsByTagName("script");for(d=0;d<c.length;d++)if(c[d].src==a)return c[d].onload=c[d].onreadystatechange=f,void 0;e=document.createElement("script"),e.type="text/javascript",e.src=a,document.getElementsByTagName("head")[0].appendChild(e),e.onload=e.onreadystatechange=f}function c(){return d(location.search,"?","&")}function d(a,b,c){var f,g,h,d=a.replace(b,"").split(c),e={};for(f=0,g=d.length;g>f;f++)h=d[f].split("="),e[h[0]]=h[1];return e}function e(b,c){var d,e,h,i;return $(".ui-mask_201409011455").length&&$(".ui-mask_201409011455").remove(),$(".mod-layer_201409011455").length&&$(".mod-layer_201409011455").remove(),a("http://yaotv.qq.com/shake_tv/include/css/tip201409111455.css?t=201410241018"),d='<div class="ui-mask_201409011455"></div><div class="mod-layer_201409011455"><div class="mod-layer__desc_201409011455">{#word#}</div><div><a class="mod-layer__confirm_201409011455">确定</a></div></div>',e=g(d,"{#word#}",f(b)),h={},i=document.createElement("div"),i.innerHTML=e,h.show=function(){document.body.appendChild(i)},h.close=function(){document.body.removeChild(i)},h.show(),"function"==typeof c?$(".mod-layer__confirm_201409011455").click(function(){c()&&h.close()}):$(".mod-layer__confirm_201409011455").click(function(){h.close()}),h}function f(a){return"string"!=typeof a?"":a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&apos;").replace(/ /g,"&nbsp;")}function g(a,b,c){function e(b,c){var d=a.split(b);a=d.join(c)}if(void 0!=c)e(b,c);else for(var d in b)e(d,b[d]);return a}window.shaketv||(window.shaketv={}),window.Zepto||b("http://yaotv.qq.com/shake_tv/include/js/lib/zepto.1.1.4.min.js"),shaketv.subscribe=function(d,f){function j(){$.isFunction(f)&&f(h)}function k(){var a=c();a.cb41faa22e731e9b||(a.cb41faa22e731e9b=""),window.Zepto&&$.ajax({type:"GET",url:"http://yao.qq.com/cgi-bin/checkforceauth",data:{appid:d,cb41faa22e731e9b:a.cb41faa22e731e9b},dataType:"jsonp",timeout:5e3,success:function(a){return 0!=a.errorCode?(h.errorCode=a.errorCode,h.errorMsg=a.errorMsg,j(),void 0):(i={},$.extend(!0,i,a),l(),j(),void 0)},error:function(){h.errorCode=-1001,h.errorMsg="系统错误，请稍后重试",j()}})}function l(){if($("#iframe_subscribe_footer").length>0)return $("#iframe_subscribe").show(),void 0;var a='<iframe id="iframe_subscribe_footer" src="http://yaotv.qq.com/shake_tv/include/js/iframe_subscribe_footer.html?name={#name#}&logo={#logo#}" style="border: 0px;height: 64px;width: 100%;position: fixed;bottom: 0;left: 0; z-index:10000;"></iframe>';a=g(a,{"{#logo#}":encodeURIComponent(i.headimgurl),"{#name#}":encodeURIComponent(i.appname)}),$("body").append(a)}function m(){var a,b;return $("#iframe_subscribe").length>0?($("#iframe_subscribe").show(),void 0):(a='<iframe id="iframe_subscribe" src="http://yao.qq.com/tv/page?id=1&appname={#appname#}&icon={#icon#}&cb41faa22e731e9b={#cb41faa22e731e9b#}&appid={#appid#}" style="border: 0px;height: 205px;width: 280px;position: fixed;top: 50%;left: 50%; margin-left: -140px;margin-top: -140px;z-index:10000;"></iframe>',b=c(),a=g(a,{"{#appname#}":i.appname,"{#icon#}":i.headimgurl,"{#cb41faa22e731e9b#}":b.cb41faa22e731e9b,"{#appid#}":d}),$("body").append(a),void 0)}function n(){$("#iframe_subscribe_footer").hide()}function o(){var a='<div class="mod-layer__alert_20140929" id="shaketv_div_subscribe_success_float"><div class="ic_20140929 mod-layer__ic_20140929-success"></div><div>已关注</div></div>';$(document.body).append(a),setTimeout(function(){$("#shaketv_div_subscribe_success_float").remove()},2e3)}function p(){window.Iframe&&(Iframe.init(),Iframe.on("tip",function(a){e(a.word)}),Iframe.on("subscribe_cancle",function(){$("#iframe_subscribe").remove(),n()}),Iframe.on("subscribe_success",function(){$("#iframe_subscribe").remove(),n(),o()}),Iframe.on("subscribe_footer_no",function(){n(),$("#iframe_subscribe").length>0&&$("#iframe_subscribe").remove()}),Iframe.on("subscribe_footer_yes",function(){m()}))}var h={errorCode:0,errorMsg:""},i=null;a("http://yaotv.qq.com/shake_tv/include/css/subscribe.css?t=20140929"),window.Iframe?p():b("http://yaotv.qq.com/shake_tv/include/js/messager.js",p),window.Zepto?k():b("http://yaotv.qq.com/shake_tv/include/js/lib/zepto.1.1.4.min.js",k)}}();
//getTicket
!function(){function a(a){var b=new RegExp("(^| )"+a+"(?:=([^;]*))?(;|$)"),c=document.cookie.match(b);return c?c[2]?unescape(c[2]):"":null}window.shaketv||(window.shaketv={}),shaketv.getUserTicket=function(){return a("yyytv_ticket")}}();
//预约
!function(){function a(a){if(a){var b;return(!window["_loadCss"]||window["_loadCss"].indexOf(a)<0)&&(b=document.createElement("link"),b.setAttribute("type","text/css"),b.setAttribute("rel","stylesheet"),b.setAttribute("href",a),b.setAttribute("id","loadCss"+Math.random()),document.getElementsByTagName("head")[0].appendChild(b),window["_loadCss"]?window["_loadCss"]+="|"+a:window["_loadCss"]="|"+a),!0}}function b(b,c){var e,f,g,h;return $(".ui-mask_201409011455").length&&$(".ui-mask_201409011455").remove(),$(".mod-layer_201409011455").length&&$(".mod-layer_201409011455").remove(),a("http://yaotv.qq.com/shake_tv/include/css/tip201409111455.css?t=201410241018"),e='<div class="ui-mask_201409011455"></div><div class="mod-layer_201409011455"><div class="mod-layer__desc_201409011455">{#word#}</div><div><a class="mod-layer__confirm_201409011455">确定</a></div></div>',f=d(e,"{#word#}",b),g={},h=document.createElement("div"),h.innerHTML=f,g.show=function(){document.body.appendChild(h)},g.close=function(){document.body.removeChild(h)},g.show(),"function"==typeof c?$(".mod-layer__confirm_201409011455").click(function(){c()&&g.close()}):$(".mod-layer__confirm_201409011455").click(function(){g.close()}),g}function d(a,b,c){function e(b,c){var d=a.split(b);a=d.join(c)}if(void 0!=c)e(b,c);else for(var d in b)e(d,b[d]);return a}function e(a,b){function f(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||"function"==typeof b&&b()}var d,e,c=document.getElementsByTagName("script");for(d=0;d<c.length;d++)if(c[d].src==a)return c[d].onload=c[d].onreadystatechange=f,void 0;e=document.createElement("script"),e.type="text/javascript",e.src=a,document.getElementsByTagName("head")[0].appendChild(e),e.onload=e.onreadystatechange=f}window.shaketv||(window.shaketv={}),window.Zepto||e("http://yaotv.qq.com/shake_tv/include/js/lib/zepto.1.1.4.min.js"),shaketv.reserve=function(c,f,g){function k(){$.isFunction(g)&&g(h)}function l(){if($("#iframe_subscribe").length>0)return $("#iframe_subscribe").show(),void 0;var a='<iframe id="iframe_reserve" src="http://yao.qq.com/tv/page?id=2&reserveid={#rid#}&tvid={#tvid#}" style="border: 0px;height: 100%;width: 100%;position: fixed;top: 0%;left: 0%; z-index:10000;"></iframe>';a=d(a,{"{#rid#}":f,"{#tvid#}":c}),$("body").append(a),i=setTimeout(function(){m(),h.errorCode=-1001,h.errorMsg="确认预约窗口打开超时",k()},6e3)}function m(){$("#iframe_reserve").remove()}function n(){window.Iframe&&(window.Iframe.messager||Iframe.init(),Iframe.on("reserve_tip",function(a){a&&a.word&&b(a.word)}),Iframe.on("reserve_success",function(){setTimeout(m,2e3),h.errorCode=0,h.errorMsg="",k()}),Iframe.on("reserve_cancle",function(){m(),h.errorCode=-1002,h.errorMsg="用户取消",k()}),Iframe.on("reserve_show",function(){clearTimeout(i)}),Iframe.on("reserve_errorback",function(a){m(),a&&a.errorCode?(h.errorCode=a.errorCode,h.errorMsg=a.errorMsg):(h.errorCode=-1003,h.errorMsg="未知错误"),b("预约出错"+h.errorCode+":"+h.errorMsg),k()}))}var h={errorCode:0,errorMsg:""},i=null;a("http://yaotv.qq.com/shake_tv/include/css/subscribe.css?t=20140929"),window.Zepto?l():e("http://yaotv.qq.com/shake_tv/include/js/lib/zepto.1.1.4.min.js",l),window.Iframe?n():e("http://yaotv.qq.com/shake_tv/include/js/messager.js",n)}}();
//oauth
!function(){function a(a,b){function f(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||"function"==typeof b&&b()}var d,e,c=document.getElementsByTagName("script");for(d=0;d<c.length;d++)if(c[d].src==a)return c[d].onload=c[d].onreadystatechange=f,void 0;e=document.createElement("script"),e.type="text/javascript",e.src=a,document.getElementsByTagName("head")[0].appendChild(e),e.onload=e.onreadystatechange=f}function b(a,b,c){function e(b,c){var d=a.split(b);a=d.join(c)}if(void 0!=c)e(b,c);else for(var d in b)e(d,b[d]);return a}window.shaketv||(window.shaketv={}),window.Zepto||a("http://yaotv.qq.com/shake_tv/include/js/lib/zepto.1.1.4.min.js"),shaketv.authorize=function(c,d,e){function h(){$.isFunction(e)&&e(f)}function i(){if($("#iframe_authorize").length>0)return $("#iframe_authorize").show(),void 0;var a='<iframe id="iframe_authorize" src="http://yao.qq.com/tv/page?id=3&appid={#appid#}&scope={#scope#}" style="border: 0px;height:1px;width: 280px;position: fixed;top: 50%;left: 50%; margin-left: -140px;margin-top: -140px;z-index:10000;"></iframe>';a=b(a,{"{#appid#}":c,"{#scope#}":d}),$("body").append(a),g=setTimeout(function(){$("#iframe_authorize").remove(),f.errorCode=-1002,f.errorMsg="授权窗口打开超时",h()},6e3)}function j(){window.Iframe&&(Iframe.init(),Iframe.on("authorize_cancle",function(){$("#iframe_authorize").remove(),f.errorCode=-1001,f.errorMsg="用户取消",h()}),Iframe.on("authorize_success",function(a){$("#iframe_authorize").remove(),f.errorCode=0,f.code=a.code,f.errorMsg="",h()}),Iframe.on("authorize_errorback",function(a){$("#iframe_authorize").remove(),f.errorCode=a.errorCode,f.errorMsg=a.errorMsg,h()}),Iframe.on("authorize_height",function(a){$("#iframe_authorize").css("height",a.height+"px")}),Iframe.on("authorize_show",function(){clearTimeout(g)}))}var f={errorCode:0,errorMsg:"",code:""},g=null;window.Iframe?j():a("http://yaotv.qq.com/shake_tv/include/js/messager.js",j),window.Zepto?i():a("http://yaotv.qq.com/shake_tv/include/js/lib/zepto.1.1.4.min.js",i)}}();
