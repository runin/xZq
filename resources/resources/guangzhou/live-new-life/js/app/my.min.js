$(function(){var a={showPage:function(b,d,e){var c=$(".page");c.addClass("none");c.each(function(g,h){var f=$(h);if(f.attr("id")==b){f.removeClass("none");a.currentPage=f;if(d){d(f)}return false}})},loadData:function(g){var f=$.extend({url:"",type:"get",async:false,dataType:"jsonp",showload:true},g);if(f.showload){W.showLoading()}var c=0;var e="";var b=null;for(var d in g){c++;if(c==2){e=d;b=g[d];break}}$.ajax({type:f.type,data:g.data,async:f.async,url:f.url,dataType:f.dataType,jsonpCallback:e,success:function(h){W.hideLoading();b(h)},error:function(){if(g.error){g.error()}W.hideLoading()}})},loadImg:function(c){if(!this.images){this.images=[]}if(c&&!(c instanceof Array)){c.isLoad=false;this.images.push(c)}else{if((c instanceof Array)){for(var e=0;e<c.length;e++){c[e].isLoad=false;this.images.push(c[e])}}}for(var d=0;d<this.images.length;d++){var f=this;if(!this.images[d].isLoad){var b=new Image();b.src=this.images[d].src;this.images[d].isLoad=true;b.onload=function(){}}}},module:function(d,c,b){!a[d]&&(a[d]=new c());if(b){$(function(){b()})}}};a.module("my",function(){var c=function(){if(headimgurl){$("#my-img").find("img").attr("src",headimgurl+"/64")}else{$("#my-img").find("img").attr("src","images/avatar.jpg")}if(nickname){$(".my-head").find("p").text(nickname)}else{$(".my-head").find("p").text("匿名")}};var b={tf:false,number:0,pal:10,th:0,listHtml:function(){if(b.tf==true){return}a.loadData({url:domain_url+"api/lottery/record",callbackLotteryRecordHandler:function(g){if(g.result==true){var f=simpleTpl();var h=g.rl;var d=h.length;$(".my-l-box").removeClass("none");if(d<=10){for(var e=0;e<d;e++){f._("<li>");f._("<i></i>");f._("<h2>"+h[e].lt+"</h2>");f._('<div class="my-card">');f._('<h3 class="card-title">您在拉阔新生活节目中赢得'+h[e].pn+"</h3>");f._('<p class="card-p">奖品名称：'+h[e].pn+"</p>");if(h[e].cc){f._('<p class="card-p">兑奖码：'+h[e].cc+"</p>")}f._("</div>");f._("</li>")}b.tf=true}else{if(d>b.pal){for(var e=b.number;e<b.pal;e++){f._("<li>");f._("<i></i>");f._("<h2>"+h[e].lt+"</h2>");f._('<div class="my-card">');f._('<h3 class="card-title">您在拉阔新生活节目中赢得'+h[e].pn+"</h3>");f._('<p class="card-p">奖品名称：'+h[e].pn+"</p>");if(h[e].cc){f._('<p class="card-p">兑奖码：'+h[e].cc+"</p>")}f._("</div>");f._("</li>")}b.number+=10;b.pal+=(d-b.pal)}else{for(var e=b.number;e<b.pal;e++){f._("<li>");f._("<i></i>");f._("<h2>"+h[e].lt+"</h2>");f._('<div class="my-card">');f._('<h3 class="card-title">您在拉阔新生活节目中赢得'+h[e].pn+"</h3>");f._('<p class="card-p">奖品名称：'+h[e].pn+"</p>");if(h[e].cc){f._('<p class="card-p">兑奖码：'+h[e].cc+"</p>")}f._("</div>");f._("</li>")}b.tf=true}}$("#myrecord").append(f.toString());b.th=$(".my-l-box").height()}else{$(".list-none").removeClass("none")}},data:{oi:openid,pt:"1,5,7"}})},sclFn:function(){var d=$(".my-list");var e=d.height();$(".my-list").scroll(function(h){var f=d.get(0).scrollHeight;var g=d.scrollTop();if(g+e>b.th){b.listHtml()}})},myBtn:function(){$(".my-btn").click(function(){window.location.href="main.html"})}};this.init=function(){c();b.listHtml();b.myBtn();b.sclFn()};this.init()})});