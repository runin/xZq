!function(a,b){function c(){if(this.hasDeviceMotion="ondevicemotion"in a,this.threshold=7,this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,"function"==typeof b.CustomEvent)this.event=new b.CustomEvent("shake",{bubbles:!0,cancelable:!0});else{if("function"!=typeof b.createEvent)return!1;this.event=b.createEvent("Event"),this.event.initEvent("shake",!0,!0)}}c.prototype.reset=function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null},c.prototype.start=function(){this.reset(),this.hasDeviceMotion&&a.addEventListener("devicemotion",this,!1)},c.prototype.stop=function(){this.hasDeviceMotion&&a.removeEventListener("devicemotion",this,!1),this.reset()},c.prototype.devicemotion=function(b){var c,d,e=b.accelerationIncludingGravity,f=0,g=0,h=0;return null===this.lastX&&null===this.lastY&&null===this.lastZ?(this.lastX=e.x,this.lastY=e.y,void(this.lastZ=e.z)):(f=Math.abs(this.lastX-e.x),g=Math.abs(this.lastY-e.y),h=Math.abs(this.lastZ-e.z),(f>this.threshold&&g>this.threshold||f>this.threshold&&h>this.threshold||g>this.threshold&&h>this.threshold)&&(c=new Date,d=c.getTime()-this.lastTime.getTime(),d>1e3&&(a.dispatchEvent(this.event),this.lastTime=new Date)),this.lastX=e.x,this.lastY=e.y,void(this.lastZ=e.z))},c.prototype.handleEvent=function(a){return"function"==typeof this[a.type]?this[a.type](a):void 0};var d=new c;d&&d.start()}(window,document);var hex_sha1=function(a){function b(a){return f(g(e(a),8*a.length))}function c(a){var b,c="";for(var d in a)b=a.charCodeAt(d),c+=(b>>4&15).toString(16)+(15&b).toString(16);return c}function d(b){for(var c,d,e="",f=-1;++f<b.length;)c=b.charCodeAt(f),d=f+1<b.length?b.charCodeAt(f+1):0,c>=55296&&56319>=c&&d>=56320&&57343>=d&&(c=65536+((1023&c)<<10)+(1023&d),f++),127>=c?e+=a(c):2047>=c?e+=a(192|c>>6&31,128|63&c):65535>=c?e+=a(224|c>>12&15,128|c>>6&63,128|63&c):2097151>=c&&(e+=a(240|c>>18&7,128|c>>12&63,128|c>>6&63,128|63&c));return e}function e(a){for(var b=[],c=0;c<8*a.length;c+=8)b[c>>5]|=(255&a.charCodeAt(c/8))<<24-c%32;return b}function f(b){for(var c="",d=0;d<32*b.length;d+=8)c+=a(b[d>>5]>>24-d%32&255);return c}function g(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var c=[],d=1732584193,e=-271733879,f=-1732584194,g=271733878,l=-1009589776,m=0;m<a.length;m+=16){for(var n=d,o=e,p=f,q=g,r=l,s=0;80>s;s++){16>s?c[s]=a[m+s]:c[s]=k(c[s-3]^c[s-8]^c[s-14]^c[s-16],1);var t=j(j(k(d,5),h(s,e,f,g)),j(j(l,c[s]),i(s)));l=g,g=f,f=k(e,30),e=d,d=t}d=j(d,n),e=j(e,o),f=j(f,p),g=j(g,q),l=j(l,r)}return[d,e,f,g,l]}function h(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function i(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function j(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function k(a,b){return a<<b|a>>>32-b}return a=String.fromCharCode,function(a){return c(b(d(a)))}}();!function(a){H.dialog={ci:null,ts:null,si:null,$container:a("body"),sau:"",lru:"",init:function(){var b=a(window).height(),c=a(window).width();a("body").css({width:c,height:b})},open:function(){var b=this;this.$dialog?this.$dialog.removeClass("none"):(this.$dialog=a(this.tpl()),H.dialog.$container.append(this.$dialog)),H.dialog.relocate(),this.$dialog.animate({opacity:"1"},500),this.$dialog.find(".dialog").addClass("bounceInDown"),setTimeout(function(){a(".btn-wheel").animate({"-webkit-transform":"rotate(360deg)"},300),b.$dialog.find(".dialog").removeClass("bounceInDown")},1e3)},relocate:function(){var b=a(window).height(),c=a(window).width();a(".modal").each(function(){a(this).css({width:c,height:b})}),a(".dialog").each(function(){a(this).css({width:.88*c,left:.06*c,top:.15*b})})},shiwuLottery:{$dialog:null,name:"",mobile:"",address:"",ru:"",open:function(a){H.lottery.isCanShake=!1,H.lottery.canJump=!1;var b=this,c=this.$dialog;H.dialog.open.call(this),c||this.event(),b.update(a)},close:function(){var a=this;this.$dialog.find(".dialog").removeClass("bounceInDown").addClass("bounceOutDown"),this.$dialog.animate({opacity:"0"},1e3),setTimeout(function(){H.lottery.isCanShake=!0,H.lottery.canJump=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},1e3)},event:function(){var b=this;this.$dialog.find(".btn-dialog-close").click(function(a){a.preventDefault(),b.close()}),this.$dialog.find("#btn-shiwuLottery-award").click(function(c){c.preventDefault(),b.check()&&(a("#btn-shiwuLottery-award").hasClass("flag")||(a("#btn-shiwuLottery-award").addClass("flag"),shownewLoading(),getResult("api/lottery/award",{oi:openid,nn:nickname?encodeURIComponent(a.fn.cookie(mpappid+"_nickname")):"",hi:headimgurl?headimgurl:"",rn:b.name?encodeURIComponent(b.name):"",ph:b.mobile?b.mobile:"",ad:b.address?encodeURIComponent(b.address):""},"callbackLotteryAwardHandler"),a("#shiwu-dialog").find(".info-name label").text(b.name),a("#shiwu-dialog").find(".info-phone label").text(b.mobile),a("#shiwu-dialog").find(".info-address label").text(b.address),showTips("领取成功"),shownewLoading(),setTimeout(function(){a("#shiwu-dialog").find(".before").addClass("none"),a("#shiwu-dialog").find(".after").removeClass("none"),a("#shiwu-dialog").find(".award-keyTips").addClass("none"),hidenewLoading()},200)))}),this.$dialog.find("#btn-shiwuLottery-close").click(function(a){a.preventDefault(),b.close()})},update:function(b){b.result&&(H.dialog.lru=b.ruid,a("#shiwu-dialog").find(".award-img").attr("src",b.pi).attr("onerror","$(this).addClass('none')"),a("#shiwu-dialog").find(".award-keyTips").html(b.tt||"请填写您的个人信息以便顺利领奖"),a("#shiwu-dialog").find(".name").val(b.rn?b.rn:""),a("#shiwu-dialog").find(".phone").val(b.ph?b.ph:""),a("#shiwu-dialog").find(".before").removeClass("none"),a("#shiwu-dialog").find(".after").addClass("none"))},check:function(){var b=this,c=a.trim(a(".name").val()),d=a.trim(a(".phone").val());return c.length>20||0==c.length?(showTips("请填写您的姓名，以便顺利领奖！"),!1):/^\d{11}$/.test(d)?(b.name=c,b.mobile=d,!0):(showTips("请填写正确手机号，以便顺利领奖！"),!1)},tpl:function(){var a=simpleTpl();return a._('<section class="modal modal-shiwu" id="shiwu-dialog">')._('<section class="dialog shiwu-dialog">')._('<section class="dialog-content">')._('<img class="award-img" src="./images/default-award.png">')._('<div class="info-content">')._('<p class="award-keyTips none"></p>')._('<section class="input-box before">')._('<input class="name" type="text" placeholder="姓名:">')._('<input class="phone" type="tel" placeholder="电话:">')._("</section>")._('<section class="info-box after">')._('<p class="info-name">姓名：<label></label></p>')._('<p class="info-phone">电话：<label></label></p>')._("</section>")._('<a href="javascript:void(0);" class="btn-lottery btn-shiwu-lottery-award before" id="btn-shiwuLottery-award" data-collect="true" data-collect-flag="dialog-shiwu-btn-shiwuLottery-award" data-collect-desc="弹层(实物奖)-领取按钮">领取</a>')._('<section class="btn-lottery-box after">')._('<a href="javascript:void(0);" class="btn-lottery btn-shiwu-lottery-close" id="btn-shiwuLottery-close" data-collect="true" data-collect-flag="dialog-shiwu-btn-shiwuLottery-close" data-collect-desc="弹层(实物奖)-确定按钮">确定</a>')._("</section>")._("</div>")._("</section>")._("</section>")._("</section>"),a.toString()}},thanksLottery:{$dialog:null,open:function(){H.lottery.isCanShake=!1,H.lottery.canJump=!1;var b=this,c=this.$dialog;H.dialog.open.call(this),c||this.event();var d=a(window).height(),e=a(window).width();a("#thanks-dialog").find(".dialog").css({width:.8*e,left:.1*e,top:.3*d}),setTimeout(function(){b.close()},1500)},close:function(){var a=this;this.$dialog.find(".dialog").removeClass("bounceInDown").addClass("bounceOutDown"),this.$dialog.animate({opacity:"0"},1e3),setTimeout(function(){H.lottery.isCanShake=!0,H.lottery.canJump=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},1e3)},event:function(){var a=this;this.$dialog.find("#btn-thanks-continue").click(function(b){b.preventDefault(),a.close()})},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="thanks-dialog">')._('<section class="dialog thanks-dialog">')._('<section class="dialog-content thanks-content">')._('<img class="thanks-tips" src="./images/thanks-tip.png">')._("</section>")._("</section>")._("</section>"),a.toString()}},wxcardLottery:{$dialog:null,ci:null,ts:null,si:null,pt:null,sto:null,name:null,mobile:null,open:function(b){var c=this,d=this.$dialog;H.lottery.isCanShake=!1,H.lottery.canJump=!1,H.dialog.open.call(this),d||this.event(),c.update(b),c.readyFunc();var e=a(window).height(),f=a(window).width();a("#wxcard-dialog").find(".dialog").css({width:.8*f,left:.1*f,top:.15*e})},close:function(){var a=this;this.$dialog.find(".dialog").removeClass("bounceInDown").addClass("bounceOutDown"),this.$dialog.animate({opacity:"0"},1e3),setTimeout(function(){a.$dialog&&a.$dialog.remove(),a.$dialog=null},1e3)},event:function(){var a=this;this.$dialog.find(".btn-dialog-close").click(function(b){b.preventDefault(),H.lottery.isCanShake=!0,H.lottery.canJump=!0,a.close()}),this.$dialog.find(".btn-close").click(function(b){b.preventDefault(),H.lottery.isCanShake=!0,H.lottery.canJump=!0,a.close()})},readyFunc:function(){var b=this;a("#btn-wxcardLottery-award,.award-img").click(function(c){c.preventDefault(),(a(".input-box").hasClass("none")||b.check())&&(H.lottery.isCanShake=!1,a("#btn-wxcardLottery-award").hasClass("flag")||(a("#btn-wxcardLottery-award").addClass("flag"),shownewLoading(),b.close(),b.sto=setTimeout(function(){H.lottery.isCanShake=!0,hidenewLoading()},15e3),a("#btn-wxcardLottery-award").text("领取中"),setTimeout(function(){b.wx_card()},800)))})},wx_card:function(){var b=this;wx.addCard({cardList:[{cardId:b.ci,cardExt:'{"timestamp":"'+b.ts+'","signature":"'+b.si+'"}'}],success:function(c){H.lottery.canJump=!0,H.lottery.isCanShake=!0,getResult("api/lottery/award",{nn:nickname?encodeURIComponent(a.fn.cookie(mpappid+"_nickname")):"",hi:headimgurl?headimgurl:"",oi:openid,rn:b.name?encodeURIComponent(b.name):"",ph:b.mobile?b.mobile:""},"callbackLotteryAwardHandler")},fail:function(a){H.lottery.isCanShake=!0,H.lottery.canJump=!0,hidenewLoading(),recordUserOperate(openid,a.errMsg,"card-fail")},complete:function(){b.sto&&clearTimeout(b.sto),H.lottery.isCanShake=!0,H.lottery.canJump=!0,hidenewLoading()},cancel:function(){H.lottery.isCanShake=!0,H.lottery.canJump=!0,hidenewLoading()}})},update:function(b){var c=this;b.result&&7==b.pt&&(H.dialog.lru=b.ruid,c.pt=b.pt,a("#wxcard-dialog").find(".award-img").attr("src",b.pi).attr("onerror","$(this).addClass('none')"),a("#wxcard-dialog").find(".award-keyTips").html(b.tt||""),a("#wxcard-dialog").find(".name").val(b.rn?b.rn:""),a("#wxcard-dialog").find(".phone").val(b.ph?b.ph:""),1==b.cu?(a(".wxcard-dialog").css({top:Math.ceil(.26*a(window).height())}),a(".input-box").removeClass("none")):(a(".wxcard-dialog").css({top:Math.ceil(.3*a(window).height())}),a(".input-box").addClass("none")),c.ci=b.ci,c.ts=b.ts,c.si=b.si)},check:function(){var b=this,c=a.trim(a(".name").val()),d=a.trim(a(".phone").val());return c.length>20||0==c.length?(showTips("请填写您的姓名，以便顺利领奖！"),!1):/^\d{11}$/.test(d)?(b.name=c,b.mobile=d,!0):(showTips("请填写正确手机号，以便顺利领奖!"),!1)},tpl:function(){var a=simpleTpl();return a._('<section class="modal modal-wxcard" id="wxcard-dialog">')._('<section class="dialog wxcard-dialog">')._('<section class="dialog-content">')._('<img class="award-img" src="./images/default-award.png">')._('<div class="info-content">')._('<section class="input-box none">')._('<p class="award-keyTips none"></p>')._('<input class="name" type="text" placeholder="姓名:">')._('<input class="phone" type="tel" placeholder="电话:">')._('<a href="javascript:void(0);" class="btn-lottery btn-wxcard-lottery-award" id="btn-wxcardLottery-award" data-collect="true" data-collect-flag="dialog-wxcard-btn-wxcardLottery-award" data-collect-desc="弹层(卡券)-领取按钮">领取</a>')._("</section>")._("</div>")._("</section>")._("</section>")._("</section>"),a.toString()}},linkLottery:{$dialog:null,pt:null,name:null,mobile:null,ru:null,open:function(b){var c=this,d=this.$dialog;H.lottery.isCanShake=!1,H.lottery.canJump=!1,H.dialog.open.call(this),d||this.event(),c.update(b);var e=a(window).height(),f=a(window).width();a("#link-dialog").find(".dialog").css({width:.8*f,left:.1*f,top:.15*e})},close:function(){var a=this;this.$dialog.find(".dialog").removeClass("bounceInDown").addClass("bounceOutDown"),this.$dialog.animate({opacity:"0"},1e3),setTimeout(function(){a.$dialog&&a.$dialog.remove(),a.$dialog=null},1e3)},event:function(){var b=this;this.$dialog.find(".btn-dialog-close").click(function(a){a.preventDefault(),H.lottery.isCanShake=!0,H.lottery.canJump=!0,b.close()}),a("#btn-linkLottery-award,.award-img").click(function(c){c.preventDefault(),(a(".input-box").hasClass("none")||b.check())&&(H.lottery.isCanShake=!1,a("#btn-linkLottery-award").hasClass("flag")||(a("#btn-linkLottery-award").addClass("flag"),shownewLoading(),b.close(),a("#btn-linkLottery-award").text("领取中"),getResult("api/lottery/award",{nn:nickname?encodeURIComponent(a.fn.cookie(mpappid+"_nickname")):"",hi:headimgurl?headimgurl:"",oi:openid,rn:b.name?encodeURIComponent(b.name):"",ph:b.mobile?b.mobile:""},"callbackLotteryAwardHandler"),setTimeout(function(){location.href=b.ru},500)))})},update:function(b){var c=this;b.result&&9==b.pt&&(H.dialog.lru=b.ruid,c.pt=b.pt,c.ru=b.ru,a("#link-dialog").find(".award-img").attr("src",b.pi).attr("onerror","$(this).addClass('none')"),a("#link-dialog").find(".award-keyTips").html(b.tt||""),a("#link-dialog").find(".name").val(b.rn?b.rn:""),a("#link-dialog").find(".phone").val(b.ph?b.ph:""),1==b.cu?(a(".link-dialog").css({top:Math.ceil(.26*a(window).height())}),a(".input-box").removeClass("none")):(a(".link-dialog").css({top:Math.ceil(.3*a(window).height())}),a(".input-box").addClass("none")))},check:function(){var b=this,c=a.trim(a(".name").val()),d=a.trim(a(".phone").val());return c.length>20||0==c.length?(showTips("请填写您的姓名，以便顺利领奖！"),!1):/^\d{11}$/.test(d)?(b.name=c,b.mobile=d,!0):(showTips("请填写正确手机号，以便顺利领奖!"),!1)},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="link-dialog">')._('<section class="dialog link-dialog">')._('<section class="dialog-content">')._('<img class="award-img" src="./images/default-award.png">')._('<div class="info-content">')._('<section class="input-box none">')._('<p class="award-keyTips none"></p>')._('<input class="name" type="text" placeholder="姓名:">')._('<input class="phone" type="tel" placeholder="电话:">')._('<a href="javascript:void(0);" class="btn-lottery btn-link-lottery-award" id="btn-linkLottery-award" data-collect="true" data-collect-flag="dialog-wxcard-btn-wxcardLottery-award" data-collect-desc="弹层(卡券)-领取按钮">领取</a>')._("</section>")._("</div>")._("</section>")._("</section>")._("</section>"),a.toString()}},redLottery:{$dialog:null,pt:null,name:null,mobile:null,rp:null,open:function(b){var c=this,d=this.$dialog;H.lottery.isCanShake=!1,H.lottery.canJump=!1,H.dialog.open.call(this),d||this.event();var e=a(window).height(),f=a(window).width();a(".red-dialog").each(function(){a(this).css({width:.8*f,left:.1*f,top:.1*e})}),c.update(b)},close:function(){var a=this;this.$dialog.find(".red-dialog").removeClass("bounceInDown").addClass("bounceOutDown"),this.$dialog.animate({opacity:"0"},1e3),setTimeout(function(){a.$dialog&&a.$dialog.remove(),a.$dialog=null},1e3)},event:function(){var b=this;a("#btn-redLottery-award,.award-img").click(function(c){c.preventDefault(),(a(".input-box").hasClass("none")||b.check())&&(H.lottery.isCanShake=!1,a("#btn-redLottery-award").hasClass("flag")||(a("#btn-redLottery-award").addClass("flag"),shownewLoading(),a("#btn-redLottery-award").text("领取中"),setTimeout(function(){location.href=b.rp},500)))})},update:function(b){var c=this;b.result&&4==b.pt&&(H.dialog.lru=b.ruid,c.pt=b.pt,c.rp=b.rp,a("#red-dialog").find(".award-img").attr("src",b.pi).attr("onerror","$(this).addClass('none')"),a("#red-dialog").find(".award-keyTips").html(b.pd||""),a("#red-dialog").find(".name").val(b.rn?b.rn:""),a("#red-dialog").find(".phone").val(b.ph?b.ph:""),1==b.cu?a(".input-box").removeClass("none"):a(".input-box").addClass("none"))},check:function(){var b=this,c=a.trim(a(".name").val()),d=a.trim(a(".phone").val());return c.length>20||0==c.length?(showTips("请填写您的姓名，以便顺利领奖！"),!1):/^\d{11}$/.test(d)?(b.name=c,b.mobile=d,!0):(showTips("请填写正确手机号，以便顺利领奖!"),!1)},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="red-dialog">')._('<section class="red-dialog">')._('<section class="dialog-content">')._('<img class="award-img" src="./images/default-award.png">')._('<section class="input-box none">')._('<p class="award-keyTips none"></p>')._('<input class="name" type="text" placeholder="姓名:">')._('<input class="phone" type="tel" placeholder="电话:">')._('<a href="javascript:void(0);" class="btn-lottery btn-wxcard-lottery-award" id="btn-redLottery-award" data-collect="true" data-collect-flag="dialog-wxcard-btn-redLottery-award" data-collect-desc="弹层(红包)-领取按钮">领取</a>')._("</section>")._("</section>")._("</section>")._("</section>"),a.toString()}}},W.callbackLotteryAwardHandler=function(a){},W.callbackRuleHandler=function(a){0==a.code&&H.dialog.rule.update(a.rule)}}(Zepto),$(function(){H.dialog.init()}),function(a){H.vote={pid:null,inforoudRepeat:!0,roundList:[],countDownType:0,index:0,countDownEnd:!0,userVoteNum:0,voteNumLimit:4,defaultSwiper:null,init:function(){var a=this;a.getVoteinfo(),a.event()},event:function(){var b=this;a("body").delegate(".vote-btn","click",function(b){if(b.preventDefault(),a(this).hasClass("before"))return void showTips("投票还未开始");if(a(this).hasClass("full"))return void showTips("您的投票次数已用完");if(a(this).hasClass("voted"))return void showTips("您已经投过票");if(a(this).hasClass("over"))return void showTips("投票已结束");var c=a(this).attr("data-guid"),d=a(this).attr("data-pid");a.ajax({type:"GET",async:!1,url:domain_url+"api/voteguess/guessplayer"+dev,data:{yoi:openid,guid:c,pluids:d},dataType:"jsonp",jsonpCallback:"callbackVoteguessGuessHandler",timeout:5e3,complete:function(){},success:function(a){},error:function(a,b){}}),a(this).addClass("voted"),H.vote.userVoteNum++,a.fn.cookie(openid+c,H.vote.userVoteNum,{expires:1});var e=window.localStorage,f=null==e.getItem(c+openid)?"0":e.getItem(c+openid);e.setItem(c+openid,f+","+d),a(".vote-left").find("span").text(H.vote.voteNumLimit-H.vote.userVoteNum),H.vote.userVoteNum>=H.vote.voteNumLimit&&a(".vote-btn").each(function(){a(this).hasClass("voted")||a(this).addClass("full")});var g=d+"-vote-num";a("#"+g).text(parseInt(a("#"+g).text())+1)}).delegate(".sp-img","click",function(c){c.preventDefault();var d=a(this).attr("data-index"),e=b.roundList[b.index].pitems[d];a("#detail").find(".detail-img").attr("src",e.im2),a("#detail").find(".detail-text").html(e["in"]),a("#detail").removeClass("none"),a("#detail").animate({opacity:"1"},500),setTimeout(function(){a("#detail").removeClass("none")},500)}),a(".detail-back").click(function(b){b.preventDefault(),a("#detail").animate({opacity:"0"},500),setTimeout(function(){a("#detail").addClass("none")},500)}),a(".icon-down").click(function(b){b.preventDefault(),a(this).hasClass("clicked")||(a(this).addClass("clicked"),toUrl("cjl.html?openid="+openid))}),a(".icon-jlf").click(function(b){b.preventDefault(),a(this).hasClass("clicked")||(a(this).addClass("clicked"),location.href="http://mp.weixin.qq.com/s?__biz=MjM5NDIwOTcyMA==&mid=402284095&idx=1&sn=3006d25a2f6cd513beabe7ccbd7e52ce#rd")})},getVoteinfo:function(){a.ajax({type:"GET",async:!1,url:domain_url+"api/voteguess/inforoud"+dev,data:{yoi:openid},dataType:"jsonp",jsonpCallback:"callbackVoteguessInfoHandler",timeout:11e3,complete:function(){},success:function(a){0!=a.code||1==a.flow?H.vote.inforoudRepeat?(H.vote.inforoudRepeat=!1,setTimeout(function(){H.vote.getVoteinfo()},2e3)):H.common.showOver():a.items&&a.items.length>0?H.vote.fillVoteinfo(a):H.common.showOver()},error:function(a,b){H.vote.inforoudRepeat?(H.vote.inforoudRepeat=!1,setTimeout(function(){H.vote.getVoteinfo()},2e3)):toUrl("yaoyiyao.html")}})},fillVoteinfo:function(a){var b=this;H.vote.pid=a.pid;var c=(new Date).getTime(),d=timeTransform(c-H.common.dec);if(comptime(a.pet,d)>=0)return void H.common.showOver();var e=a.items;if(H.vote.roundList=e,!e||0==e.length)return void H.common.showOver();if(comptime(d,e[e.length-1].get)<0)return void H.common.showLottery();for(var f=0;f<e.length;f++){var g=e[f].gst,h=e[f].get;if(comptime(d,g)<0&&comptime(d,h)>=0)return b.index=f,b.countDownType=0,void b.voteEndCD(e[f]);if(comptime(d,g)>0)return b.index=f,b.countDownType=1,void b.voteStartCD(e[f])}},voteStartCD:function(b){var c=this;c.countDownType=1,c.countDownEnd=!0;var d=b.gst,e=timestamp(d);e+=H.common.dec,a(".vote-countdown").attr("etime",e).empty(),a(".vote-tip").html("距投票开始还有"),c.count_down(),c.tplVoteInfo(b),a(".vote-countdown").removeClass("none"),a(".vote-cd").removeClass("none"),a("header").animate({opacity:"1"},500),hidenewLoading()},voteEndCD:function(b){var c=this;c.countDownType=0,c.countDownEnd=!0;var d=b.get,e=timestamp(d);e+=H.common.dec,a(".vote-countdown").attr("etime",e).empty(),a(".vote-tip").html("距投票结束还有"),c.count_down(),c.tplVoteInfo(b),a(".vote-countdown").removeClass("none"),a(".vote-cd").removeClass("none"),a("header").animate({opacity:"1"},500),hidenewLoading()},count_down:function(){var b=this;a(".vote-countdown").each(function(){a(this).countDown({etpl:"<label>%M%</label>:<label>%S%</label>",stpl:"<label>%M%</label>:<label>%S%</label>",sdtpl:"",otpl:"",otCallback:function(){if(b.countDownEnd)if(b.countDownEnd=!1,shownewLoading(null,"请稍候..."),a(".vote-tip").html("请稍候..."),a(".vote-countdown").addClass("none"),1==b.countDownType)a(".swiper-container").animate({opacity:"0"},500),setTimeout(function(){b.voteEndCD(b.roundList[b.index])},1e3);else{var c=b.roundList[b.index].guid,d=window.localStorage;d.removeItem(c+openid),H.common.showLottery(),b.index>=b.roundList.length-1?(a(".vote-tip").html("本期投票已结束，请下期再来"),a(".vote-countdown").html(""),a(".vote-btn").addClass("over"),hidenewLoading()):(a(".swiper-container").animate({opacity:"0"},500),b.index++,setTimeout(function(){b.voteStartCD(b.roundList[b.index])},1e3))}}})})},swiper:function(){var a=this;a.defaultSwiper=new Swiper(".swiper-container",{nextButton:".swiper-button-next-vote",prevButton:".swiper-button-prev-vote",pagination:".swiper-pagination",paginationClickable:!0,preloadImages:!1,lazyLoading:!0,effect:"coverflow",slidesPerView:1,centeredSlides:!0,coverflow:{rotate:0,stretch:H.common.stretch,depth:80,modifier:2,slideShadows:!1}})},tplVoteInfo:function(b){var c=this;a("#mainContainer").empty();var d=simpleTpl(),e=b.pitems,f="";if(1==c.countDownType?(f="before",a(".vote-left").addClass("none"),a(".vote-tips").addClass("none")):(a(".vote-left").removeClass("none"),a(".vote-tips").removeClass("none")),e&&e.length>0){var g=a.fn.cookie(openid+b.guid);c.userVoteNum=g?parseInt(g):0;var h="";c.userVoteNum>=c.voteNumLimit&&(h="full"),d._('<div class="swiper-container" id="swiperContainer">')._('<div class="swiper-wrapper" id="vote-list">');for(var i=0;i<e.length;i++){var j=getRandomArbitrary(9157,21388);d._('<div class="swiper-slide swiper-back" id="'+e[i].pid+'">')._('<p class="card-num">'+(i+1)+"号门</p>")._('<div style="padding-top: 25%;"></div>')._('<div class="goods-img"><img src="./images/default-vote.png" data-src="'+e[i].im+'" class="swiper-lazy sp-img" data-index="'+i+'" data-collect="true" data-collect-flag="vote-detail-btn" data-collect-desc="投票页-商品详情"></div>')._('<div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>')._('<table class="cont">')._("<tr>")._('<td rowspan="2" class="na"><span class="goods-na">'+e[i].na+"</span></td>")._('<td class="zan-btn"><a href="javascript:void(0);" id="like-'+e[i].pid+'" data-pid="'+e[i].pid+'" data-guid="'+b.guid+'" class="none vote-btn '+f+" "+h+'" data-collect="true" data-collect-flag="vote-vote-btn" data-collect-desc="投票页-投票按钮"></a></td>')._("</tr>")._("<tr>")._("<td>")._('<span class="vote-num none"><span id="'+e[i].pid+'-vote-num">'+j+"</span>票</span>")._("</td>")._("</tr>")._("</table>")._("</div>")}d._("</div>")._('<div class="swiper-button-prev swiper-button-prev-vote swiper-button-white" data-collect="true" data-collect-flag="vote-swiper-btn-prev" data-collect-desc="投票页-点击左箭头"><img src="./images/icon-arrow-left.png"></div>')._('<div class="swiper-button-next swiper-button-next-vote swiper-button-white" data-collect="true" data-collect-flag="vote-swiper-btn-next" data-collect-desc="投票页-点击右箭头"><img src="./images/icon-arrow-right.png"></div>')._("</div>"),a("#mainContainer").html(d.toString()),a("#vote").hasClass("none")||H.vote.swiper(),a(".main,.swiper-container").animate({opacity:"1"},500),0==c.countDownType&&c.isVote(b.guid),c.voteNum(b.guid)}},isVote:function(b){var c=window.localStorage,d=c.getItem(b+openid);if(d){for(var e=d.split(","),f=0;f<e.length;f++)a("#like-"+e[f])&&a("#like-"+e[f]).removeClass("full").addClass("voted");return a(".vote-left").find("span").text(H.vote.voteNumLimit-H.vote.userVoteNum),a(".vote-left").removeClass("none"),a(".vote-tips").removeClass("none"),void a(".vote-btn").removeClass("none")}a.ajax({type:"GET",async:!1,url:domain_url+"api/voteguess/isvote"+dev,data:{yoi:openid,guid:b},dataType:"jsonp",jsonpCallback:"callbackVoteguessIsvoteHandler",timeout:11e3,complete:function(){},success:function(c){if(0==c.code){var d=c.so;if(d){var e=d.split(",");H.vote.userVoteNum=e.length,a.fn.cookie(openid+b,H.vote.userVoteNum,{expires:1});for(var f=0;f<e.length;f++)a("#like-"+e[f]).removeClass("full").addClass("voted");a(".vote-left").find("span").text(H.vote.voteNumLimit-H.vote.userVoteNum),a(".vote-left").removeClass("none"),a(".vote-tips").removeClass("none")}else a(".vote-left").find("span").text(H.vote.voteNumLimit),a(".vote-left").removeClass("none"),a(".vote-tips").removeClass("none")}a(".vote-btn").removeClass("none")},error:function(b,c){a(".vote-btn").removeClass("none")}})},voteNum:function(b){a.ajax({type:"GET",async:!0,url:domain_url+"api/voteguess/groupplayertickets"+dev,data:{yoi:openid,groupUuid:b},dataType:"jsonp",jsonpCallback:"callbackVoteguessGroupplayerticketsHandler",timeout:11e3,complete:function(){},success:function(b){if(0==b.code)for(var c=b.items,d=0;d<c.length;d++)a("#"+c[d].puid+"-vote-num").text(c[d].cunt);a(".vote-num").removeClass("none")},error:function(a,b){}})}}}(Zepto),function(a){H.lottery={first:!0,type:2,index:0,times:0,endType:1,pal:null,nowTime:null,roundData:null,nextPrizeAct:null,canJump:!0,wxCheck:!1,isError:!1,lastRound:!1,isToLottey:!0,isCanShake:!1,isTimeOver:!1,repeat_load:!0,recordFirstload:!0,crossLotteryCanCallback:!1,lotteryImgList:[],lotteryTime:1,leftPrizeCountTime:Math.ceil(7e3*Math.random()+8e3),allRecordTime:Math.ceil(4e4*Math.random()+1e5),PVTime:Math.ceil(2e4*Math.random()+1e4),rp:getQueryString("rp"),init:function(){var a=this;a.current_time(),a.event(),a.shake(),a.rp&&setTimeout(function(){showTips("领取成功")},1300)},event:function(){var b=this;a("#test").click(function(a){a.preventDefault(),b.wxCheck=!0,b.lotteryTime=1,b.shake_listener()})},wxConfig:function(){a.ajax({type:"GET",async:!0,url:domain_url+"mp/jsapiticket"+dev,data:{appId:shaketv_appid},dataType:"jsonp",jsonpCallback:"callbackJsapiTicketHandler",timeout:15e3,complete:function(){},success:function(a){if(0==a.code){var b=window.location.href.split("#")[0],c="df51d5cc9bc24d5e86d4ff92a9507361",d=Math.round((new Date).getTime()/1e3),e=hex_sha1("jsapi_ticket="+a.ticket+"&noncestr="+c+"&timestamp="+d+"&url="+b);wx.config({debug:!1,appId:shaketv_appid,timestamp:d,nonceStr:c,signature:e,jsApiList:["addCard","checkJsApi"]})}},error:function(a,b){}})},current_time:function(){a.ajax({type:"GET",async:!1,url:domain_url+"api/lottery/round"+dev,data:{},dataType:"jsonp",jsonpCallback:"callbackLotteryRoundHandler",timeout:11e3,complete:function(){},success:function(a){if(a.result&&1!=a.flow){H.lottery.nowTime=timeTransform(a.sctm);var b=(new Date).getTime();H.common.dec=b-a.sctm,H.lottery.roundData=a,H.lottery.currentPrizeAct(a)}else H.lottery.repeat_load?(H.lottery.repeat_load=!1,setTimeout(function(){H.lottery.current_time()},500)):H.common.showOver()},error:function(a,b){H.lottery.repeat_load?(H.lottery.repeat_load=!1,setTimeout(function(){H.lottery.current_time()},500)):toUrl("yaoyiyao.html")}})},currentPrizeAct:function(a){var b=this,c=this.nowTime,d=a.la,e=0;if(b.pal=d,e=d.length,d.length>0){if(comptime(d[e-1].pd+" "+d[e-1].et,c)>=0)return b.type=3,b.endType=3,void H.common.showOver();b.wxConfig(),H.vote.init(),setInterval(function(){H.common.ping()},1e4);for(var f=0;f<d.length;f++){var g=d[f].pd+" "+d[f].st,h=d[f].pd+" "+d[f].et;if(b.index=f,hidenewLoading(),comptime(c,g)<0&&comptime(c,h)>=0){if(H.common.isLottery=!0,f<d.length-1){var i=d[f+1].pd+" "+d[f+1].st;comptime(h,i)<=0?(b.endType=2,b.lastRound=!1,b.nextPrizeAct=d[f+1]):b.endType=1}else b.endType=3,b.lastRound=!0;return b.nowCountdown(d[f]),b.initCount(),void H.common.showLottery()}if(comptime(c,g)>0)return b.beforeCountdown(d[f]),void(0==f?H.common.showLottery():H.common.showVote())}}else H.common.showOver()},initCount:function(){setTimeout(function(){H.lottery.account_num()},this.PVTime);var a=Math.ceil(15e3*Math.random()+2e4);setTimeout(function(){H.lottery.red_record()},a),setInterval(function(){H.lottery.red_record()},this.allRecordTime),setInterval(function(){H.lottery.leftPrizeCount()},this.leftPrizeCountTime)},beforeCountdown:function(b){var c=this;c.isCanShake=!1,c.type=1;var d=b.pd+" "+b.st,e=timestamp(d);e+=H.common.dec,a(".lottery-countdown").attr("etime",e).empty(),a(".lottery-tip").html("距本轮摇奖开始"),c.count_down(),a(".lottery-countdown").removeClass("none"),a(".lottery-cd").removeClass("none"),b.bi.length>0&&(c.lotteryImgList=b.bi.split(",")),c.downloadImg(),hidenewLoading()},nowCountdown:function(b){var c=this;c.isCanShake=!0,c.type=2;var d=b.pd+" "+b.et,e=timestamp(d);e+=H.common.dec,a(".lottery-countdown").attr("etime",e).empty(),a(".lottery-tip").html("距本轮摇奖结束"),c.count_down(),a(".lottery-countdown").removeClass("none"),a(".lottery-cd").removeClass("none"),c.index++,c.canJump=!0,b.bi.length>0&&(c.lotteryImgList=b.bi.split(",")),c.downloadImg(),hidenewLoading()},count_down:function(){var b=this;a(".lottery-countdown").each(function(){a(this).countDown({etpl:"<label>%M%</label>:<label>%S%</label>",stpl:"<label>%M%</label>:<label>%S%</label>",sdtpl:"",otpl:"",otCallback:function(){if(b.canJump)if(1==b.type)b.isTimeOver||(b.isTimeOver=!0,a(".lottery-tip").html("请稍后"),shownewLoading(null,"请稍后..."),a(".lottery-countdown").addClass("none"),setTimeout(function(){b.nowCountdown(b.pal[b.index])},1e3));else if(2==b.type){if(!b.isTimeOver){if(b.isTimeOver=!0,b.index>=b.pal.length)return a(".lottery-countdown").addClass("none"),b.type=3,H.common.isLottery=!1,void H.common.showOver();a(".lottery-tip").html("请稍后"),shownewLoading(null,"请稍后..."),a(".lottery-countdown").addClass("none");var c=b.index-1;if(c<b.pal.length-1){var d=b.pal[c].pd+" "+b.pal[c].et,e=b.pal[c+1].pd+" "+b.pal[c+1].st;comptime(d,e)<=0?b.endType=2:(b.endType=1,H.common.showVote())}setTimeout(function(){2==b.endType?b.nowCountdown(b.pal[b.index]):1==b.endType&&b.beforeCountdown(b.pal[b.index])},1e3)}}else b.isCanShake=!1},sdCallback:function(){b.isTimeOver=!1}})})},downloadImg:function(){var b=this,c=simpleTpl();a(".preImg")&&a(".preImg").remove();for(var d=0;d<b.lotteryImgList.length;d++)c._('<img class="preload preImg" src="'+b.lotteryImgList[d]+'">');a("body").append(c.toString())},shake:function(){W.addEventListener("shake",H.lottery.shake_listener,!1)},shake_listener:function(){if(H.lottery.isCanShake&&(H.lottery.isCanShake=!1,H.lottery.canJump=!1,2==H.lottery.type)){if(H.lottery.times++,H.lottery.times%H.lottery.lotteryTime!=0&&(H.lottery.isToLottey=!1),a(".home-box").hasClass("yao")||(a("#audio-a").get(0).play(),a(".m-t-b").css({"-webkit-transition":"-webkit-transform .2s ease","-webkit-transform":"translate3d(0,-100px,0)"}),a(".m-f-b").css({"-webkit-transition":"-webkit-transform .2s ease","-webkit-transform":"translate3d(0,100px,0)"}),setTimeout(function(){a(".m-t-b").css({
"-webkit-transform":"translate3d(0,0,0)","-webkit-transition":"-webkit-transform .5s ease"}),a(".m-f-b").css({"-webkit-transform":"translate3d(0,0,0)","-webkit-transition":"-webkit-transform .5s ease"})},1e3),a(".home-box").addClass("yao")),recordUserOperate(openid,"摇奖","shakeLottery"),openid&&"null"!=openid&&0!=H.lottery.isToLottey){if(!H.lottery.wxCheck)return void setTimeout(function(){H.lottery.fill(null)},800);shownewLoading(null,"抽奖中，请稍后..."),H.lottery.drawlottery()}else setTimeout(function(){H.lottery.fill(null)},800);H.lottery.isToLottey=!0}},drawlottery:function(){var b=this,c=(new Date).getTime()+"";shownewLoading(),b.lotteryTime=1,b.times=0,a.ajax({type:"GET",async:!1,url:domain_url+"api/lottery/luck"+dev,data:{oi:openid,sn:c},dataType:"jsonp",jsonpCallback:"callbackLotteryLuckHandler",timeout:11e3,complete:function(){hidenewLoading()},success:function(a){return a.flow&&1==a.flow?(b.lotteryTime=getRandomArbitrary(3,6),b.times=0,c=(new Date).getTime()+"",void H.lottery.lottery_point(null)):void(a.result?a.sn==c&&(c=(new Date).getTime()+"",H.lottery.lottery_point(a)):(c=(new Date).getTime()+"",H.lottery.lottery_point(null)))},error:function(){c=(new Date).getTime()+"",H.lottery.lottery_point(null)}})},fill:function(b){return hidenewLoading(),setTimeout(function(){a(".home-box").removeClass("yao"),H.lottery.imgMath()},300),null==b||0==b.result||0==b.pt?void H.dialog.thanksLottery.open():(a("#audio-b").get(0).play(),void(7==b.pt?H.dialog.wxcardLottery.open(b):9==b.pt?H.dialog.linkLottery.open(b):4==b.pt?H.dialog.redLottery.open(b):(5==b.pt||1==b.pt)&&H.dialog.shiwuLottery.open(b)))},lottery_point:function(a){setTimeout(function(){H.lottery.fill(a)},1e3)},account_num:function(){getResult("api/common/servicepv",{},"commonApiSPVHander")},red_record:function(){getResult("api/lottery/allrecord",{},"callbackLotteryAllRecordHandler")},leftPrizeCount:function(){getResult("api/lottery/leftDayCountLimitPrize",{},"callbackLeftDayCountLimitPrizeHandler")},imgMath:function(){var b=this;if(b.lotteryImgList.length>0){var c=Math.floor(Math.random()*b.lotteryImgList.length);a("#lottery").css("background","url('"+b.lotteryImgList[c]+"') no-repeat center center"),a("#lottery").css("background-size","100% auto")}},scroll:function(b){a(".marquee").each(function(b){var c=this,d=[],e=1e3,f=a(c).find("li").length,g=a(c).find("ul");0==f?a(c).addClass("none"):a(c).removeClass("none"),f>1&&(d[b]=setInterval(function(){a(c).find("ul").animate({"margin-top":"-20px"},e,function(){a(c).find("ul li:first").appendTo(g),a(c).find("ul").css({"margin-top":"0"})})},3e3))})}},W.commonApiSPVHander=function(b){0==b.code&&(a(".count label").html(b.c),a(".count").removeClass("hidden"),setInterval(function(){var b=getRandomArbitrary(33,99);b=1*a(".count label").html()+b,a(".count label").html(b)},3e3))},W.callbackLotteryAllRecordHandler=function(b){if(b.result){var c=b.rl;if(c&&c.length>0){for(var d="",e=0;e<c.length;e++)d+="<li>"+(c[e].ni||"匿名用户")+"中了"+c[e].pn+"</li>";var f=a(".marquee").find("li").length;f>=500?a(".marquee").find("ul").html(d):a(".marquee").find("ul").append(d),H.lottery.first&&(H.lottery.first=!1,H.lottery.scroll()),a(".marquee").removeClass("none")}}},W.callbackLeftDayCountLimitPrizeHandler=function(b){if(b.result){var c=a(".rednum").find("span").text();(1*c>=b.lc||1*c==0)&&(a(".rednum").find("span").text(b.lc),0==b.lc?a(".rednum").css("opacity","0"):a(".rednum").css("opacity","1"))}},wx.ready(function(){wx.checkJsApi({jsApiList:["addCard"],success:function(a){var b=a.checkResult.addCard;b&&!H.lottery.isError&&(H.lottery.wxCheck=!0)}})}),wx.error(function(a){H.lottery.isError=!0})}(Zepto),function(a){H.over={even:function(){a("#ddtj").click(function(b){if(b.preventDefault(),!a(this).hasClass("clicked")){a(this).addClass("clicked"),shownewLoading("请稍候...",null);var c=a(this).attr("data-href");setTimeout(function(){location.href=c},800)}})},nextPrize:function(){getResult("api/linesdiy/info",{},"callbackLinesDiyInfoHandler",!0),this.ddtj(),this.even()},ddtj:function(){a("#ddtj").addClass("none"),getResult("api/common/promotion",{oi:openid},"commonApiPromotionHandler")},swiperOver:function(){new Swiper(".swiper-container-over",{nextButton:".swiper-button-next-over",prevButton:".swiper-button-prev-over",pagination:".swiper-pagination",paginationClickable:!0,preloadImages:!1,lazyLoading:!0,effect:"coverflow",slidesPerView:1,centeredSlides:!0,coverflow:{rotate:0,stretch:H.common.overStretch,depth:80,modifier:2,slideShadows:!0}})}},W.callbackLinesDiyInfoHandler=function(b){if(0==b.code){var c=simpleTpl(),d=b.gitems;if(d&&d.length>0){c._('<div class="swiper-container-over">')._('<div class="swiper-wrapper">');for(var e=0;e<d.length;e++)c._('<div class="swiper-slide">')._('<img src="./images/load-swiper.png" data-src="'+d[e].ib+'" class="swiper-lazy over-img">')._('<div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>')._("</div>");c._("</div>")._('<div class="swiper-button-prev swiper-button-prev-over swiper-button-white" data-collect="true" data-collect-flag="over-swiper-btn-prev" data-collect-desc="结束页-点击左箭头"><img src="./images/icon-arrow-left.png"></div>')._('<div class="swiper-button-next swiper-button-next-over swiper-button-white" data-collect="true" data-collect-flag="over-swiper-btn-next" data-collect-desc="结束页-点击右箭头"><img src="./images/icon-arrow-right.png"></div>')._("</div>"),a("#over-swiper").empty().html(c.toString()),H.over.swiperOver(),a(".swiper-container-over").animate({opacity:"1"},500)}}},W.commonApiPromotionHandler=function(b){0==b.code&&b.desc&&b.url?a("#ddtj").attr("data-href",b.url||"").removeClass("none"):a("#ddtj").remove()}}(Zepto),function(a){H.common={dec:0,isLottery:!1,stretch:93,overStretch:70,init:function(){var b=this;b.event(),H.lottery.init(),a(window).width()<=320&&a(window).height()<=480?(b.stretch=60,b.overStretch=60):360==a(window).width()&&(b.stretch=80)},event:function(){a(".icon-surprise").click(function(b){b.preventDefault(),a(this).hasClass("clicked")||(a(this).addClass("clicked"),shownewLoading(null,"请稍后..."),setTimeout(function(){location.href="http://surprise-question.app.uiwork.com/home/wapIndex"},800))}),a(".lottery-zz").attr("src",support_list[getRandomArbitrary(0,2)])},showOver:function(){var b=this;b.isLottery||(H.common.showPage(a("#over")),setTimeout(function(){H.over.nextPrize()},600))},showLottery:function(){var b=this;b.showPage(a("#lottery"))},showVote:function(){var b=this;b.showPage(a("#vote")),setTimeout(function(){H.vote.swiper()},550)},showPage:function(b){a(".page").animate({opacity:"0"},500),setTimeout(function(){a(".page").addClass("none"),a(b).removeClass("none"),a(b).animate({opacity:"1"},500),hidenewLoading()},500)},ping:function(){a.ajax({type:"GET",async:!0,url:domain_url+"api/common/time"+dev,data:{},dataType:"jsonp",jsonpCallback:"commonApiTimeHandler",timeout:1e4,complete:function(){},success:function(a){if(a.t){var b=(new Date).getTime();H.common.dec=b-1*a.t}}})}}}(Zepto),$(function(){shownewLoading(),H.common.init()});