if(typeof Zepto==="undefined"){throw new Error("Parallax.js's script requires Zepto")}!function(g){var y,q,u,h,x,m,w,k,b,a,c,f,p=false,e=true;window.curPage=0;g.fn.parallax=function(z){f=g.extend({},g.fn.parallax.defaults,z);return this.each(function(){b=g(this);a=b.find(".page");r()})};g.fn.parallax.defaults={direction:"vertical",swipeAnim:"default",drag:true,loading:false,indicator:false,arrow:false,onchange:function(){},orientationchange:function(){}};function r(){if(f.loading){g(".wrapper").append('<div class="parallax-loading"><i class="ui-loading ui-loading-white"></i></div>')}else{e=false}x="stay";m=a.length;w=g(window).width();k=g(window).height();c=g("[data-animation]");for(var z=0;z<m;z++){g(a[z]).attr("data-id",z+1)}b.addClass(f.direction).addClass(f.swipeAnim);a.css({width:w+"px",height:k+"px"});f.direction==="horizontal"?b.css("width",w*a.length):b.css("height",k*a.length);if(f.swipeAnim==="cover"){b.css({width:w,height:k});a[0].style.display="block"}if(!f.loading){g(a[curPage]).addClass("current");f.onchange(curPage,a[curPage],x);d()}if(f.arrow){a.append('<span class="parallax-arrow"></span>');g(a[m-1]).find(".parallax-arrow").remove()}}function t(z){if(e===true){event.preventDefault();return false}p=true;f.direction==="horizontal"?y=z.pageX:y=z.pageY;if(f.swipeAnim==="default"){b.addClass("drag");h=b.css("-webkit-transform").replace("matrix(","").replace(")","").split(",");f.direction==="horizontal"?h=parseInt(h[4]):h=parseInt(h[5])}if((f.swipeAnim==="cover"&&f.drag)){a.addClass("drag")}u=1}function j(z){if(e===true||p===false){event.preventDefault();return false}event.preventDefault();f.direction==="horizontal"?q=z.pageX:q=z.pageY;s();if(f.drag&&!n()){o()}else{if(n()){b.css("-webkit-transform","matrix(1, 0, 0, 1, "+h+", 0)")}}u=2}function i(z){if(e===true||u!==2){}else{p=false;f.direction==="horizontal"?q=z.pageX:q=z.pageY;if(f.swipeAnim==="default"&&!n()){b.removeClass("drag");if(Math.abs(q-y)<=50){l(curPage);x="stay"}else{if(q>=y){l(curPage-1);x="backward"}else{if(q<y){l(curPage+1);x="forward"}}}}else{if(f.swipeAnim==="cover"&&!n()){if(Math.abs(q-y)<=50&&q>=y&&f.drag){l(curPage,"keep-backward");x="stay"}else{if(Math.abs(q-y)<=50&&q<y&&f.drag){l(curPage,"keep-forward");x="stay"}else{if(Math.abs(q-y)>50&&q>=y&&f.drag){l(curPage-1,"backward");x="backward"}else{if(Math.abs(q-y)>50&&q<y&&f.drag){l(curPage+1,"forward");x="forward"}else{if(Math.abs(q-y)>50&&q>=y&&!f.drag){l(curPage-1,"backward");x="backward"}else{if(Math.abs(q-y)>50&&q<y&&!f.drag){l(curPage+1,"forward");x="forward"}}}}}}}}if(f.indicator){g(g(".parallax-h-indicator ul li, .parallax-v-indicator ul li").removeClass("current").get(curPage)).addClass("current")}u=3}}function o(){if(f.swipeAnim==="default"){var A=h+q-y;f.direction==="horizontal"?b.css("-webkit-transform","matrix(1, 0, 0, 1, "+A+", 0)"):b.css("-webkit-transform","matrix(1, 0, 0, 1, 0, "+A+")")}else{if(f.swipeAnim==="cover"){var A=q-y,z=g(a[curPage-1]),B=g(a[curPage+1]);g(a).css({"z-index":0});if(f.direction==="horizontal"&&q>=y){z.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(A-w)+"px)"})}else{if(f.direction==="horizontal"&&q<y){B.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(w+A)+"px)"})}else{if(f.direction==="vertical"&&q>=y){z.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(A-k)+"px)"})}else{if(f.direction==="vertical"&&q<y){B.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(k+A)+"px)"})}}}}}}}function l(z,A){curPage=z;if(f.swipeAnim==="default"){var B=0;f.direction==="horizontal"?B=z*(-w):B=z*(-k);f.direction==="horizontal"?b.css({"-webkit-transform":"matrix(1, 0, 0, 1, "+B+", 0)"}):b.css({"-webkit-transform":"matrix(1, 0, 0, 1, 0, "+B+")"})}else{if(f.swipeAnim==="cover"){if(A==="keep-backward"&&f.drag){a.removeClass("drag");f.direction==="horizontal"?g(a[curPage-1]).css({"-webkit-transform":"translateX(-100%)"}):g(a[curPage-1]).css({"-webkit-transform":"translateY(-100%)"})}else{if(A==="keep-forward"&&f.drag){a.removeClass("drag");f.direction==="horizontal"?g(a[curPage+1]).css({"-webkit-transform":"translateX(100%)"}):g(a[curPage+1]).css({"-webkit-transform":"translateY(100%)"})}else{if(A==="forward"&&f.drag){a.removeClass("drag");g(a[curPage-1]).addClass("back");a[curPage].style.webkitTransform="translate(0, 0)"}else{if(A==="backward"&&f.drag){a.removeClass("drag");g(a[curPage+1]).addClass("back");a[curPage].style.webkitTransform="translate(0, 0)"}else{if(A==="forward"&&!f.drag){b.addClass("animate");g(a[curPage-1]).addClass("back");g(a[curPage]).addClass("front").show()}else{if(A==="backward"&&!f.drag){b.addClass("animate");g(a[curPage+1]).addClass("back");g(a[curPage]).addClass("front").show()}}}}}}}}e=true;setTimeout(function(){e=false},300)}function s(){if(f.direction==="horizontal"){if(q>=y){b.removeClass("forward").addClass("backward")}else{if(q<y){b.removeClass("backward").addClass("forward")}}}else{if(q>=y){b.removeClass("forward").addClass("backward")}else{if(q<y){b.removeClass("backward").addClass("forward")}}}}function n(){var z=g(".page").index(g(".page").not(function(){return g(this).hasClass("none")}).last());if(f.direction==="horizontal"){if((q>=y&&curPage===0)||(q<=y&&curPage===z)){return true}}else{if((q>=y&&curPage===0)||(q<=y&&curPage===z)){return true}}return false}function v(){return a.parent().hasClass("disabled")}function d(){c.css({"-webkit-animation":"none",display:"none"});g(".current [data-animation]").each(function(C,F){var A=g(F),E=A.attr("data-animation"),D=A.attr("data-duration")||500,B=A.attr("data-timing-function")||"ease",z=A.attr("data-delay")?A.attr("data-delay"):0;if(E==="followSlide"){if(f.direction==="horizontal"&&x==="forward"){E="followSlideToLeft"}else{if(f.direction==="horizontal"&&x==="backward"){E="followSlideToRight"}else{if(f.direction==="vertical"&&x==="forward"){E="followSlideToTop"}else{if(f.direction==="vertical"&&x==="backward"){E="followSlideToBottom"}}}}}A.css({display:"block","-webkit-animation-name":E,"-webkit-animation-duration":D+"ms","-webkit-animation-timing-function":"ease","-webkit-animation-timing-function":B,"-webkit-animation-delay":z+"ms","-webkit-animation-fill-mode":"both"})})}g(document).on("touchstart",".page",function(z){if(!v()){t(z.changedTouches[0])}}).on("touchmove",".page",function(z){if(!v()){j(z.changedTouches[0])}}).on("touchend",".page",function(z){if(!v()){i(z.changedTouches[0])}}).on("webkitAnimationEnd webkitTransitionEnd",".pages",function(){if(x!=="stay"){setTimeout(function(){g(".back").hide().removeClass("back");g(".front").show().removeClass("front");b.removeClass("forward backward animate")},10);a.length>0&&g(a.removeClass("current").get(curPage)).addClass("current");f.onchange(curPage,a[curPage],x);d()}});g(".page *").on("webkitAnimationEnd",function(){event.stopPropagation()});window.addEventListener("onorientationchange" in window?"orientationchange":"resize",function(){if(window.orientation===180||window.orientation===0){f.orientationchange("portrait")}if(window.orientation===90||window.orientation===-90){f.orientationchange("landscape")}},false)}(Zepto);(function(c,a){function d(){this.hasDeviceMotion="ondevicemotion" in c;this.threshold=15;this.lastTime=new Date();this.lastX=null;this.lastY=null;this.lastZ=null;if(typeof a.CustomEvent==="function"){this.event=new a.CustomEvent("shake",{bubbles:true,cancelable:true})}else{if(typeof a.createEvent==="function"){this.event=a.createEvent("Event");this.event.initEvent("shake",true,true)}else{return false}}}d.prototype.reset=function(){this.lastTime=new Date();this.lastX=null;this.lastY=null;this.lastZ=null};d.prototype.start=function(){this.reset();if(this.hasDeviceMotion){c.addEventListener("devicemotion",this,false)}};d.prototype.stop=function(){if(this.hasDeviceMotion){c.removeEventListener("devicemotion",this,false)}this.reset()};d.prototype.devicemotion=function(k){var j=k.accelerationIncludingGravity,i,h,g=0,f=0,l=0;if((this.lastX===null)&&(this.lastY===null)&&(this.lastZ===null)){this.lastX=j.x;this.lastY=j.y;this.lastZ=j.z;return}g=Math.abs(this.lastX-j.x);f=Math.abs(this.lastY-j.y);l=Math.abs(this.lastZ-j.z);if(((g>this.threshold)&&(f>this.threshold))||((g>this.threshold)&&(l>this.threshold))||((f>this.threshold)&&(l>this.threshold))){i=new Date();h=i.getTime()-this.lastTime.getTime();if(h>1000){c.dispatchEvent(this.event);this.lastTime=new Date()}}this.lastX=j.x;this.lastY=j.y;this.lastZ=j.z};d.prototype.handleEvent=function(f){if(typeof(this[f.type])==="function"){return this[f.type](f)}};var b=new d();b&&b.start()}(window,document));(function(d,a,c){var f=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||d.oRequestAnimationFrame||d.msRequestAnimationFrame||function(g){d.setTimeout(g,1000/60)};var b=(function(){var k={};var l=a.createElement("div").style;var i=(function(){var p=["t","webkitT","MozT","msT","OT"],n,o=0,m=p.length;for(;o<m;o++){n=p[o]+"ransform";if(n in l){return p[o].substr(0,p[o].length-1)}}return false})();function j(m){if(i===false){return false}if(i===""){return m}return i+m.charAt(0).toUpperCase()+m.substr(1)}k.getTime=Date.now||function g(){return new Date().getTime()};k.extend=function(o,n){for(var m in n){o[m]=n[m]}};k.addEvent=function(p,o,n,m){p.addEventListener(o,n,!!m)};k.removeEvent=function(p,o,n,m){p.removeEventListener(o,n,!!m)};k.prefixPointerEvent=function(m){return d.MSPointerEvent?"MSPointer"+m.charAt(9).toUpperCase()+m.substr(10):m};k.momentum=function(s,o,p,m,t,u){var n=s-o,q=c.abs(n)/p,v,r;u=u===undefined?0.0006:u;v=s+(q*q)/(2*u)*(n<0?-1:1);r=q/u;if(v<m){v=t?m-(t/2.5*(q/8)):m;n=c.abs(v-s);r=n/q}else{if(v>0){v=t?t/2.5*(q/8):0;n=c.abs(s)+v;r=n/q}}return{destination:c.round(v),duration:r}};var h=j("transform");k.extend(k,{hasTransform:h!==false,hasPerspective:j("perspective") in l,hasTouch:"ontouchstart" in d,hasPointer:d.PointerEvent||d.MSPointerEvent,hasTransition:j("transition") in l});k.isBadAndroid=/Android /.test(d.navigator.appVersion)&&!(/Chrome\/\d/.test(d.navigator.appVersion));k.extend(k.style={},{transform:h,transitionTimingFunction:j("transitionTimingFunction"),transitionDuration:j("transitionDuration"),transitionDelay:j("transitionDelay"),transformOrigin:j("transformOrigin")});k.hasClass=function(n,o){var m=new RegExp("(^|\\s)"+o+"(\\s|$)");return m.test(n.className)};k.addClass=function(n,o){if(k.hasClass(n,o)){return}var m=n.className.split(" ");m.push(o);n.className=m.join(" ")};k.removeClass=function(n,o){if(!k.hasClass(n,o)){return}var m=new RegExp("(^|\\s)"+o+"(\\s|$)","g");n.className=n.className.replace(m," ")};k.offset=function(m){var o=-m.offsetLeft,n=-m.offsetTop;while(m=m.offsetParent){o-=m.offsetLeft;n-=m.offsetTop}return{left:o,top:n}};k.preventDefaultException=function(o,n){for(var m in n){if(n[m].test(o[m])){return true}}return false};k.extend(k.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});k.extend(k.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(m){return m*(2-m)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(m){return c.sqrt(1-(--m*m))}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(n){var m=4;return(n=n-1)*n*((m+1)*n+m)+1}},bounce:{style:"",fn:function(m){if((m/=1)<(1/2.75)){return 7.5625*m*m}else{if(m<(2/2.75)){return 7.5625*(m-=(1.5/2.75))*m+0.75}else{if(m<(2.5/2.75)){return 7.5625*(m-=(2.25/2.75))*m+0.9375}else{return 7.5625*(m-=(2.625/2.75))*m+0.984375}}}}},elastic:{style:"",fn:function(m){var n=0.22,o=0.4;if(m===0){return 0}if(m==1){return 1}return(o*c.pow(2,-10*m)*c.sin((m-n/4)*(2*c.PI)/n)+1)}}});k.tap=function(o,m){var n=a.createEvent("Event");n.initEvent(m,true,true);n.pageX=o.pageX;n.pageY=o.pageY;o.target.dispatchEvent(n)};k.click=function(o){var n=o.target,m;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(n.tagName)){m=a.createEvent("MouseEvents");m.initMouseEvent("click",true,true,o.view,1,n.screenX,n.screenY,n.clientX,n.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,0,null);m._constructed=true;n.dispatchEvent(m)}};return k})();function e(j,g){this.wrapper=typeof j=="string"?a.querySelector(j):j;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var h in g){this.options[h]=g[h]}this.translateZ=this.options.HWCompositing&&b.hasPerspective?" translateZ(0)":"";this.options.useTransition=b.hasTransition&&this.options.useTransition;this.options.useTransform=b.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?b.ease[this.options.bounceEasing]||b.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}e.prototype={version:"5.1.3",_init:function(){this._initEvents()},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(g){if(g.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(h){if(b.eventType[h.type]!=1){if(h.button!==0){return}}if(!this.enabled||(this.initiated&&b.eventType[h.type]!==this.initiated)){return}if(this.options.preventDefault&&!b.isBadAndroid&&!b.preventDefaultException(h.target,this.options.preventDefaultException)){h.preventDefault()}var g=h.touches?h.touches[0]:h,i;this.initiated=b.eventType[h.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=b.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;i=this.getComputedPosition();this._translate(c.round(i.x),c.round(i.y));this._execEvent("scrollEnd")}else{if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=g.pageX;this.pointY=g.pageY;this._execEvent("beforeScrollStart")},_move:function(l){if(!this.enabled||b.eventType[l.type]!==this.initiated){return}if(this.options.preventDefault){l.preventDefault()}var n=l.touches?l.touches[0]:l,i=n.pageX-this.pointX,h=n.pageY-this.pointY,m=b.getTime(),g,o,k,j;this.pointX=n.pageX;this.pointY=n.pageY;this.distX+=i;this.distY+=h;k=c.abs(this.distX);j=c.abs(this.distY);if(m-this.endTime>300&&(k<10&&j<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(k>j+this.options.directionLockThreshold){this.directionLocked="h"}else{if(j>=k+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){l.preventDefault()}else{if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}}h=0}else{if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){l.preventDefault()}else{if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}}i=0}}i=this.hasHorizontalScroll?i:0;h=this.hasVerticalScroll?h:0;g=this.x+i;o=this.y+h;if(g>0||g<this.maxScrollX){g=this.options.bounce?this.x+i/3:g>0?0:this.maxScrollX}if(o>0||o<this.maxScrollY){o=this.options.bounce?this.y+h/3:o>0?0:this.maxScrollY}this.directionX=i>0?-1:i<0?1:0;this.directionY=h>0?-1:h<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(g,o);if(m-this.startTime>300){this.startTime=m;this.startX=this.x;this.startY=this.y}},_end:function(l){if(!this.enabled||b.eventType[l.type]!==this.initiated){return}if(this.options.preventDefault&&!b.preventDefaultException(l.target,this.options.preventDefaultException)){l.preventDefault()}var n=l.changedTouches?l.changedTouches[0]:l,i,h,k=b.getTime()-this.startTime,g=c.round(this.x),q=c.round(this.y),p=c.abs(g-this.startX),o=c.abs(q-this.startY),j=0,m="";this.isInTransition=0;this.initiated=0;this.endTime=b.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(g,q);if(!this.moved){if(this.options.tap){b.tap(l,this.options.tap)}if(this.options.click){b.click(l)}this._execEvent("scrollCancel");return}if(this._events.flick&&k<200&&p<100&&o<100){this._execEvent("flick");return}if(this.options.momentum&&k<300){i=this.hasHorizontalScroll?b.momentum(this.x,this.startX,k,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:g,duration:0};h=this.hasVerticalScroll?b.momentum(this.y,this.startY,k,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:q,duration:0};g=i.destination;q=h.destination;j=c.max(i.duration,h.duration);this.isInTransition=1}if(g!=this.x||q!=this.y){if(g>0||g<this.maxScrollX||q>0||q<this.maxScrollY){m=b.ease.quadratic}this.scrollTo(g,q,j,m);return}this._execEvent("scrollEnd")},_resize:function(){var g=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){g.refresh()},this.options.resizePolling)},resetPosition:function(h){var g=this.x,i=this.y;h=h||0;if(!this.hasHorizontalScroll||this.x>0){g=0}else{if(this.x<this.maxScrollX){g=this.maxScrollX}}if(!this.hasVerticalScroll||this.y>0){i=0}else{if(this.y<this.maxScrollY){i=this.maxScrollY}}if(g==this.x&&i==this.y){return false}this.scrollTo(g,i,h,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var g=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=b.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(h,g){if(!this._events[h]){this._events[h]=[]}this._events[h].push(g)},off:function(i,h){if(!this._events[i]){return}var g=this._events[i].indexOf(h);if(g>-1){this._events[i].splice(g,1)}},_execEvent:function(j){if(!this._events[j]){return}var h=0,g=this._events[j].length;if(!g){return}for(;h<g;h++){this._events[j][h].apply(this,[].slice.call(arguments,1))}},scrollBy:function(g,j,h,i){g=this.x+g;j=this.y+j;h=h||0;this.scrollTo(g,j,h,i)},scrollTo:function(g,j,h,i){i=i||b.ease.circular;this.isInTransition=this.options.useTransition&&h>0;if(!h||(this.options.useTransition&&i.style)){this._transitionTimingFunction(i.style);this._transitionTime(h);this._translate(g,j)}else{this._animate(g,j,h,i.fn)}},scrollToElement:function(h,i,g,l,k){h=h.nodeType?h:this.scroller.querySelector(h);if(!h){return}var j=b.offset(h);j.left-=this.wrapperOffset.left;j.top-=this.wrapperOffset.top;if(g===true){g=c.round(h.offsetWidth/2-this.wrapper.offsetWidth/2)}if(l===true){l=c.round(h.offsetHeight/2-this.wrapper.offsetHeight/2)}j.left-=g||0;j.top-=l||0;j.left=j.left>0?0:j.left<this.maxScrollX?this.maxScrollX:j.left;j.top=j.top>0?0:j.top<this.maxScrollY?this.maxScrollY:j.top;i=i===undefined||i===null||i==="auto"?c.max(c.abs(this.x-j.left),c.abs(this.y-j.top)):i;this.scrollTo(j.left,j.top,i,k)},_transitionTime:function(g){g=g||0;this.scrollerStyle[b.style.transitionDuration]=g+"ms";if(!g&&b.isBadAndroid){this.scrollerStyle[b.style.transitionDuration]="0.001s"}},_transitionTimingFunction:function(g){this.scrollerStyle[b.style.transitionTimingFunction]=g},_translate:function(g,h){if(this.options.useTransform){this.scrollerStyle[b.style.transform]="translate("+g+"px,"+h+"px)"+this.translateZ}else{g=c.round(g);h=c.round(h);this.scrollerStyle.left=g+"px";this.scrollerStyle.top=h+"px"}this.x=g;this.y=h},_initEvents:function(g){var h=g?b.removeEvent:b.addEvent,i=this.options.bindToWrapper?this.wrapper:d;h(d,"orientationchange",this);h(d,"resize",this);if(this.options.click){h(this.wrapper,"click",this,true)}if(!this.options.disableMouse){h(this.wrapper,"mousedown",this);h(i,"mousemove",this);h(i,"mousecancel",this);h(i,"mouseup",this)}if(b.hasPointer&&!this.options.disablePointer){h(this.wrapper,b.prefixPointerEvent("pointerdown"),this);h(i,b.prefixPointerEvent("pointermove"),this);h(i,b.prefixPointerEvent("pointercancel"),this);h(i,b.prefixPointerEvent("pointerup"),this)}if(b.hasTouch&&!this.options.disableTouch){h(this.wrapper,"touchstart",this);h(i,"touchmove",this);h(i,"touchcancel",this);h(i,"touchend",this)}h(this.scroller,"transitionend",this);h(this.scroller,"webkitTransitionEnd",this);h(this.scroller,"oTransitionEnd",this);h(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var h=d.getComputedStyle(this.scroller,null),g,i;if(this.options.useTransform){h=h[b.style.transform].split(")")[0].split(", ");g=+(h[12]||h[4]);i=+(h[13]||h[5])}else{g=+h.left.replace(/[^-\d.]/g,"");i=+h.top.replace(/[^-\d.]/g,"")}return{x:g,y:i}},_animate:function(p,o,j,g){var m=this,l=this.x,k=this.y,h=b.getTime(),n=h+j;function i(){var q=b.getTime(),s,r,t;if(q>=n){m.isAnimating=false;m._translate(p,o);if(!m.resetPosition(m.options.bounceTime)){m._execEvent("scrollEnd")}return}q=(q-h)/j;t=g(q);s=(p-l)*t+l;r=(o-k)*t+k;m._translate(s,r);if(m.isAnimating){f(i)}}this.isAnimating=true;i()},handleEvent:function(g){switch(g.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(g);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(g);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(g);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(g);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(g);break;case"keydown":this._key(g);break;case"click":if(!g._constructed){g.preventDefault();g.stopPropagation()}break}}};e.utils=b;if(typeof module!="undefined"&&module.exports){module.exports=e}else{d.IScroll=e}})(window,document,Math);(function(a){H.dialog={puid:0,$container:a("#main"),REQUEST_CLS:"requesting",iscroll:null,init:function(){var b=this;this.$container.delegate(".btn-rule","click",function(c){c.preventDefault();H.dialog.rule.open()}).delegate(".btn-close","click",function(c){c.preventDefault();a(this).closest(".modal").addClass("none")}).delegate(".btn-lottery","click",function(c){c.preventDefault();H.dialog.lottery.open()}).delegate(".btn-comeon","click",function(c){c.preventDefault();H.dialog.guide.open()})},close:function(){a(".modal").addClass("none")},open:function(){H.dialog.close();if(this.$dialog){this.$dialog.removeClass("none")}else{this.$dialog=a(this.tpl());H.dialog.$container.append(this.$dialog)}H.dialog.relocate()},relocate:function(){var b=a(window).height(),c=a(window).width();a(".modal").css({width:c,height:b}).find(".btn-close").css({right:c*0.06-15,bottom:b*0.06-15});a(".dialog").each(function(){if(a(this).hasClass("relocated")){return}a(this).css({width:c*0.88,height:b*0.94,left:c*0.06,right:c*0.06,top:0,bottom:b*0.06});var d=a(this).find(".box");if(d.length>0){d.css("height",b*0.38)}})},rule:{$dialog:null,open:function(){H.dialog.open.call(this);this.event();getResult("common/activtyRule/"+serviceNo,{},"callbackRuleHandler",true,this.$dialog)},close:function(){this.$dialog&&this.$dialog.addClass("none")},event:function(){var b=this;this.$dialog.find(".btn-close").click(function(c){c.preventDefault();b.close()})},update:function(b){this.$dialog.find(".rule").html(b).closest(".content").removeClass("none")},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="rule-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="ah-ruledialog-closebtn" data-collect-desc="规则弹层-关闭按钮"></a>')._('<div class="dialog rule-dialog">')._("<h2></h2>")._('<div class="content border none">')._('<div class="rule"></div>')._("</div>")._('<p class="dialog-copyright">最终解释权归《家庭幽默大赛》所有</p>')._("</div>")._("</section>");return b.toString()}},lottery:{$dialog:null,BROKEN_CLS:"broken",ANIMATED_CLS:"animated",LOTTERIED_CLS:"lotteried",open:function(){var b=this,c=this.$dialog;H.dialog.open.call(this);if(!c){this.event()}this.reset();this.$dialog.removeClass("none");var d=this.$dialog.find(".btn-hammer").addClass(this.ANIMATED_CLS);setTimeout(function(){d.removeClass(b.ANIMATED_CLS)},800);getResult("humor/querylc",{tsuid:stationUuid,yp:openid},"callbackHumorQuerylc",true)},shake:function(){W.addEventListener("shake",H.dialog.lottery.shake_listener,false)},unshake:function(){W.removeEventListener("shake",H.dialog.lottery.shake_listener,false)},shake_listener:function(){var b=H.dialog.lottery.$dialog;if(b.hasClass("none")){return}b.find(".btn-hammer").trigger("click")},event:function(){var b=this;this.$dialog.find(".btn-hammer").click(function(d){var c=a(this);d.preventDefault();if(b.$dialog.hasClass(b.LOTTERIED_CLS)){return false}b.$dialog.addClass(b.LOTTERIED_CLS);c.addClass(b.ANIMATED_CLS);setTimeout(function(){b.$dialog.addClass(b.BROKEN_CLS)},400);setTimeout(function(){c.removeClass(b.ANIMATED_CLS)},800);getResult("humor/lottery",{tsuid:stationUuid,tcuid:channelUuid,serviceNo:serviceNo,yp:openid},"callbackHumorLottery",this.$dialog)});this.shake()},animate:function(c){var b=this;setTimeout(function(){b.$dialog.addClass(b.ANIMATED_CLS)},400);setTimeout(function(){H.dialog.award.open(c)},1100)},update:function(b){W.lc=b;a(".s-lc").text(b)},reset:function(){this.$dialog.removeClass(this.BROKEN_CLS).removeClass(this.ANIMATED_CLS).removeClass(this.LOTTERIED_CLS)},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="lottery-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="ah-lotterydialog-closebtn" data-collect-desc="抽奖弹层-关闭按钮"></a>')._('<div class="dialog lottery-dialog">')._('<div class="hammer">')._("<p>举起你的双手，让我们一起摇摆吧！</p>")._('<a href="#" class="btn-hammer" data-collect="true" data-collect-flag="ah-lotterydialog-hammerbtn" data-collect-desc="抽奖弹层-锤子砸奖"></a>')._("</div>")._('<div class="ctrl">')._('<p>你还有<strong class="s-lc"></strong>次抽奖机会</p>')._("</div>")._('<div class="light"></div>')._('<p class="dialog-copyright">最终解释权归《家庭幽默大赛》所有</p>')._("</div>")._("</section>");return b.toString()}},award:{puid:0,pt:0,$dialog:null,SUCCESS_CLS:"award-succ-dialog",REQUEST_CLS:"requesting",open:function(c){var b=this.$dialog;H.dialog.open.call(this);if(!b){this.event()}this.scroll_enable();this.pt=c.pt;this.puid=c.puid;this.$dialog.find(".s-award").text(" "+c.pn+" "+(c.pt==2?"":(c.co+c.pu)));this.$dialog.find(".prize").html('<img src="'+c.pi+'" />').addClass("p"+c.pt);this.$dialog.find(".mobile").val(c.ph||"");this.$dialog.find(".name").val(c.rn||"");var d=this.$dialog.find(".address").val(c.ad||"");if(c.pt==2){d.addClass("none")}else{d.removeClass("none")}this.$dialog.removeClass(this.SUCCESS_CLS)},scroll_enable:function(){if(this.iscroll){this.iscroll.scrollTo(0,0);this.iscroll.enable()}},scroll_disable:function(){if(this.iscroll){this.iscroll.scrollTo(0,0);this.iscroll.disable()}},enable:function(){this.$dialog.find(".btn-award").removeClass(this.REQUEST_CLS)},disable:function(){this.$dialog.find(".btn-award").addClass(this.REQUEST_CLS)},succ:function(){this.scroll_disable();H.dialog.lottery.update(W.lc);this.$dialog.addClass(this.SUCCESS_CLS);if(W.lc<=0){this.$dialog.find(".btn-again").addClass("none")}else{this.$dialog.find(".btn-again").removeClass("none")}},check:function(){var f=this,e=f.$dialog.find(".mobile"),d=a.trim(e.val()),h=f.$dialog.find(".name"),c=a.trim(h.val()),g=f.$dialog.find(".address"),b=a.trim(g.val());if(!c){H.dialog.confirm.open(h);return false}else{if(!d){H.dialog.confirm.open(e);return false}else{if(f.pt==1&&!b){H.dialog.confirm.open(g);return false}}}if(c.length>20){alert("姓名太太太长了！");h.focus();return false}if(!/^\d{11}$/.test(d)){alert("这手机号，可打不通...");e.focus();return false}if(f.pt==1&&(b.length<5||b.length>60)){alert("地址长度为5~60个字符");g.focus();return false}return true},event:function(){var b=this;this.$dialog.find(".btn-award").click(function(g){g.preventDefault();if(!b.check()){return false}var f=a.trim(b.$dialog.find(".mobile").val()),d=a.trim(b.$dialog.find(".name").val()),c=a.trim(b.$dialog.find(".address").val());b.disable();getResult("humor/award/",{puid:b.puid,ph:f,rn:encodeURIComponent(d),ad:b.pt==1?encodeURIComponent(c):"",yp:openid},"callbackHumorAward",this.$dialog)});this.$dialog.find(".btn-again").click(function(c){c.preventDefault();b.$dialog.removeClass(b.SUCCESS_CLS);H.dialog.lottery.open()});this.$dialog.find(".btn-close").click(function(c){c.preventDefault();if(!b.check()){return false}});if(is_android()){this.iscroll=new IScroll(this.$dialog.find(".dialog")[0],{mouseWheel:true,preventDefaultException:{tagName:/^(A|INPUT|TEXTAREA|BUTTON|SELECT)$/},});this.$dialog.find(".dialog-inner").css("padding-bottom","70%");this.$dialog.find("input").focus(function(){if(b.iscroll){b.iscroll.refresh();b.iscroll.scrollToElement(a(this)[0])}})}},tpl:function(){var b=simpleTpl();b._('<section class="modal iscroll" id="award-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="ah-awarddialog-closebtn" data-collect-desc="领奖弹层-关闭按钮"></a>')._('<div class="dialog award-dialog">')._('<div class="dialog-inner">')._('<div class="box">')._('<div class="prize"></div>')._("</div>")._('<div class="ctrl">')._('<h2>运气太好了，您获得<strong class="s-award"></strong></h2>')._('<div class="content">')._("<p>请填写您的姓名及联系方式，以便顺利领奖</p>")._('<input type="text" class="name" placeholder="姓名" />')._('<input type="number" class="mobile" placeholder="手机号码" />')._('<input type="text" class="address" placeholder="地址" />')._("</div>")._('<a href="#" class="btn btn-award" data-collect="true" data-collect-flag="ah-awarddialog-awardbtn" data-collect-desc="领奖弹层-领奖按钮">确定</a>')._("</div>")._('<div class="ctrl award-succ">')._("<h2>实物奖品将会由工作人员联系您进行发放。</h2>")._('<h3>您还有<strong class="s-lc"></strong>次抽奖机会</h3>')._('<a href="#" class="btn btn-again" data-collect="true" data-collect-flag="ah-awarddialog-againbtn" data-collect-desc="领奖弹层-再来一次">再来一次</a>')._("</div>")._("</div>")._('<p class="dialog-copyright">最终解释权归《家庭幽默大赛》所有</p>')._("</div>")._("</section>");return b.toString()}},confirm:{$dialog:null,$focus_obj:null,open:function(b){this.$focus_obj=b;if(this.$dialog){this.$dialog.removeClass("none")}else{this.$dialog=a(this.tpl());H.dialog.$container.append(this.$dialog)}H.dialog.relocate();this.event()},close:function(){this.$dialog&&this.$dialog.addClass("none")},event:function(){var b=this;this.$dialog.find(".btn-confirm").click(function(c){c.preventDefault();b.close()})},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="confirm-dialog">')._('<div class="dialog confirm-dialog relocated">')._('<div class="content">资料填写不全，将被视为自愿放弃奖品。</div>')._('<div class="ctrl">')._('<a href="#" class="btn btn-confirm">返回填写</a>')._("</div>")._("</div>")._("</section>");return b.toString()}},tip:{$dialog:null,open:function(){H.dialog.open.call(this)},close:function(){this.$dialog&&this.$dialog.remove()},tpl:function(){var b=simpleTpl();b._('<section class="modal" id="tip-dialog">')._('<div class="dialog tip-dialog relocated">')._("<h2></h2>")._('<a href="#" class="btn btn-close">确定</a>')._("</div>")._("</section>");return b.toString()}}};W.callbackHumorAward=function(b){H.dialog.award.enable();if(b.code==0){H.dialog.award.succ();return}alert(b.message)};W.callbackHumorLottery=function(b){if(b.code==0){H.dialog.lottery.update(b.lc);H.dialog.lottery.animate(b)}else{H.dialog.lottery.update(b.lc);setTimeout(function(){alert(b.message);H.dialog.lottery.reset()},400)}};W.callbackHumorQuerylc=function(b){if(b.code==0){W.jo=b.jo;W.gc=b.gc;W.hc=b.hc;W.lc=b.lc;H.dialog.lottery.update(b.lc)}};W.callbackRuleHandler=function(b){if(b.code==0&&b.rule){H.dialog.rule.update(b.rule)}}})(Zepto);H.dialog.init();(function(a){H.index={$pages:a("#pages"),from:getQueryString("from"),$ctrl_wrapper:a(".ctrl-wrapper"),$ttips:a(".ttips"),$pv_tips:a("#pv-tips"),$pv_num:a("#pv-num"),$next_tips:a("#next-tips"),$next_num:a("#next-num"),$share:a("#ui-share"),init:function(){if(openid){this.$pages.removeClass("disabled")}else{this.$pages.addClass("disabled");return}var b=this;getResult("humor/index",{tsuid:stationUuid,yp:openid,serviceNo:serviceNo},"callbackHumorIndex",true);getResult("humor/querylc",{tsuid:stationUuid,yp:openid},"callbackHumorQuerylc");this.update_pv();setTimeout(function(){b.$share.removeClass("none")},1000)},update_pv:function(){getResult("log/servicepv/"+serviceNo,{},"callbackCountServicePvHander");setInterval(function(){getResult("log/servicepv/"+serviceNo,{},"callbackCountServicePvHander")},5000)},show_pvtip:function(){this.$ttips.addClass("none");this.$pv_tips.removeClass("none")},show_nexttip:function(){this.$ttips.addClass("none");this.$next_tips.removeClass("none")}};H.page={parallax:null,puid:0,$pages:a("#pages"),$arrows:a("#ui-arrows"),$top_outer:a("#ui-outer-top"),$top_inner:a("#ui-inner-top"),s_type:0,TURNED_CLS:"turned",STARTING_CLS:"starting",ENDED_CLS:"ended",timeout:true,time:500,init:function(d){var c=this;this.$pages.append(this.tpl(d));if(this.$pages.find(".page").length<=1){return}this.parallax=c.$pages.parallax({direction:"horizontal",swipeAnim:"default",drag:true,loading:false,indicator:false,arrow:false,onchange:function(e,f,h){c.update_arrow(e,f);if(e>0){var g=h=="forward"?"右翻":(h=="backward"?"左翻":"");recordUserOperate(openid,g+"查看第"+e+"组选手","ah-pagechange-"+e)}}});this.update_flower();var b=a(window).height();a(".xs-wrapper").css("height",b*0.48).css("marginTop",b*0.2).find("img").css("maxHeight",b*0.4);a(".ctrl-wrapper").css("height",b*0.32);c.event_handler();c.progress();this.get_rate();setInterval(function(){c.get_rate()},5000)},update_arrow:function(b,c){if(a(c).next(".page").length==0){this.$arrows.addClass("left")}else{this.$arrows.removeClass("left")}},to:function(d){if(!this.parallax||this.$pages.hasClass("disabled")){return}var e=a(window).width(),f=this.$pages.find(".page"),c=f.index('[data-guid="'+(d||0)+'"]');c=c>-1?c:1;var b=a(".page").eq(c);if(c==0||b.hasClass("none")){return}f.removeClass("current");b.addClass("current");this.$pages.css("-webkit-transform","matrix(1, 0, 0, 1, -"+(c*e)+", 0)");window.curPage=c;this.update_arrow(c,b)},progress:function(){var b=this;a(".page-round").each(function(f){var e=a(this),d=e.attr("data-guid"),g=e.prev(),c=e.attr("data-rs");e.progress({index:f,callback:function(k){var h=a(".page-round").not(function(){return a(this).hasClass(b.ENDED_CLS)}).first();if(b.timeout&&h.length==0){h=a(".page-round").eq(0)}if(!h.hasClass(b.TURNED_CLS)){var j=h.attr("data-state");if(!j){return}h.addClass(b.TURNED_CLS);if(j==3&&h.next().length==0){var i=a(".page-round").eq(0);if(b.timeout){b.timeout=false;setTimeout(function(){b.to(i.length>0?i.attr("data-guid"):0)},b.time)}else{b.to(i.length>0?i.attr("data-guid"):0)}}else{if(b.timeout){b.timeout=false;setTimeout(function(){b.to(h.attr("data-guid"))},b.time)}else{b.to(h.attr("data-guid"))}}}},stCallback:function(h){e.addClass(b.STARTING_CLS).removeClass("none")},sdCallback:function(h){e.removeClass(b.STARTING_CLS).removeClass("none")},otCallback:function(h){e.addClass(b.ENDED_CLS)}})})},get_rate:function(b){var c=this;if(b){getResult("humor/group/"+b,{},"callbackHumorGroup")}else{a.each(W.pages_info,function(d,e){c.get_rate(e.guid)})}},update_rate:function(c){var b=a("#flower-"+c.guid);if(b){b.text(c.pc||0);b.closest(".flower-tip").removeClass("none")}},event_handler:function(){var b=this;this.$pages.delegate(".btn-vote","click",function(f){f.preventDefault();if(a(this).find(".flower").hasClass("disabled")){alert("您的鲜花已经献完了！");if(W.lc>0){H.dialog.lottery.open()}return}var d=a(this).closest(".page"),c=d.attr("data-guid");getResult("humor/guess",{guid:c,yp:openid,rsl:1},"callbackHumorGuess",true)})},get_page:function(b){return a("#page-"+b)},update_flower:function(b){if(typeof b!=="undefined"){W.flower_lt=b}var c=a(".flower");c.text(W.flower_lt);if(W.flower_lt<=0){c.addClass("disabled")}},update_server_time:function(){setInterval(function(){var c=new Date().getTime(),b=c-W.local_time;W.server_time=W.curr_time+b},100)},tpl:function(g){var f=simpleTpl(),d=g.items||[];W.curr_time=W.server_time=timestamp(g.cud);W.local_time=new Date().getTime();this.update_server_time();this.puid=g.puid;H.dialog.puid=this.puid;W.puid=g.puid;W.flower_lt=g.lt;H.index.$pv_num.text(g.pv).closest(".pv-tips").removeClass("none");for(var e=0,b=d.length;e<b;e++){var c=d[e].ij;W.pages_info=W.pages_info||{};W.pages_info[e]={guid:d[e].guid};W.pages_info.length=b;f._('<div class="page page-round" id="page-'+d[e].guid+'" data-guid="'+d[e].guid+'" data-title="'+(d[e].t||"")+'" data-datestr="'+d[e].da+'" data-etime="'+timestamp(d[e].set)+'" data-stime="'+timestamp(d[e].sst)+'">');f._('<p class="flower-tip none">选手共得<strong id="flower-'+d[e].guid+'"></strong>朵花</p>');f._('<div class="xs-wrapper">')._('<img src="'+d[e].pi+'" />')._("</div>")._('<div class="ctrl-wrapper">');f._('<div class="cwc-item cw-vote">')._('<div class="cw-btns">')._('<a href="#" class="btn-vote btn-jinji" data-collect="true" data-collect-flag="cctv1-index-votejj" data-collect-desc="家庭幽默-献花按钮"><i></i><span>还剩<strong class="flower"></strong>朵鲜花</span></a>')._("</div>")._("</div>");f._('<div class="cwr-ctrl ctrl">')._('<p class="tips"><a href="#" class="btn-rule" data-collect="true" data-collect-flag="cctv1-index-rulebtn" data-collect-desc="家庭幽默-规则弹层按钮">查看规则</a></p>')._("</div>");f._("</div>")._("</div>")}return f.toString()}};W.callbackHumorIndex=function(b){if(b.code!=0){return}H.page.init(b)};W.callbackHumorGuess=function(c){if(c.code!=0){alert(c.message);return}H.page.update_flower(c.lt);var b=H.page.get_page(c.guid).find(".btn-vote");b.addClass("animated");setTimeout(function(){b.removeClass("animated");H.dialog.lottery.open()},3000)};W.callbackCountServicePvHander=function(b){if(b.c){H.index.$pv_num.text(b.c)}};W.callbackHumorGroup=function(b){H.page.update_rate(b)}})(Zepto);$(function(){H.index.init()});