!function(a){H.dialog={$container:a("body"),wa:"",init:function(){var b=a(window).height(),c=a(window).width();a("body").css({width:c,height:b})},open:function(){var b=this;this.$dialog?this.$dialog.removeClass("none"):(this.$dialog=a(this.tpl()),H.dialog.$container.append(this.$dialog)),H.dialog.relocate(),this.$dialog.find(".dialog").addClass("bounceInDown"),setTimeout(function(){b.$dialog.find(".dialog").removeClass("bounceInDown")},1e3)},relocate:function(){var b=a(window).height(),c=a(window).width();a(".modal, .dialog").each(function(){a(this).css({width:c,height:b,left:0,top:0})})},btn_animate:function(a){a.addClass("flipInY"),setTimeout(function(){a.removeClass("flipInY")},150)},rule:{$dialog:null,ruleData:"",open:function(){H.dialog.open.call(this),this.event(),this.ruleData?this.$dialog.find(".rule").html(this.ruleData).removeClass("none"):getResult({url:"api/common/rule",loading:!0,jsonpCallback:"commonApiRuleHandler",success:function(a){0==a.code&&a.rule&&H.dialog.rule.update(a.rule)}}),this.pre_dom()},pre_dom:function(){var b=a(window).width(),c=a(window).height();a(".dialog").css({width:"280px",height:"343px",left:Math.round((b-280)/2)+"px",top:Math.round((c-343)/2)+"px"})},close:function(){var a=this;this.$dialog.find(".dialog").addClass("bounceOutUp"),setTimeout(function(){a.$dialog&&a.$dialog.remove(),a.$dialog=null},800)},event:function(){var b=this;a(".btn-close").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()}),a(".rule-colse").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()})},update:function(a){var b=H.dialog.rule;this.$dialog.find(".rule").html(a).removeClass("none"),b.ruleData=a},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="rule-dialog">')._('<div class="dialog rule-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="index-closebtn" data-collect-desc="规则弹层-关闭按钮"></a>')._('<h2 class="rule-t">活动规则</h2>')._('<div class="content border">')._('<div class="rule none"></div>')._("</div>")._("</div>")._("</section>"),a.toString()}},kjLottery:{$dialog:null,AWARDED_CLS:"lottery-awarded",ci:null,ts:null,si:null,url:null,sto:null,open:function(a){H.yao.canJump=!1;var b=this.$dialog;H.dialog.open.call(this),this.pre_dom(),this.update(a),b||this.event()},pre_dom:function(){var b=a(window).width(),c=a(window).height();a(".dialog").css({width:"295px",height:"240px",left:Math.round((b-295)/2)+"px",top:Math.round((c-240)/2)+"px"})},close:function(){var a=this;this.$dialog.find(".dialog").addClass("bounceOutUp"),setTimeout(function(){H.yao.isCanShake=!0,H.yao.canJump=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},800)},event:function(){var b=this;a(".btn-qd").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()}),a(".btn-close").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()}),this.$dialog.find(".btn-award").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),H.yao.isCanShake=!1,a(this).hasClass("flag")||(a(this).addClass("flag"),shownewLoading(),b.close(),b.sto=setTimeout(function(){H.yao.isCanShake=!0,hidenewLoading()},15e3),a(this).text("领取中"),setTimeout(function(){b.wx_card()},1e3))})},wx_card:function(){var a=this;wx.addCard({cardList:[{cardId:a.ci,cardExt:'{"timestamp":"'+a.ts+'","signature":"'+a.si+'"}'}],success:function(a){H.yao.isCanShake=!0,getResult({url:"api/lottery/award",data:{oi:openid,hi:headimgurl,nn:nickname},loading:!0,jsonpCallback:"callbackLotteryAwardHandler",success:function(a){}})},fail:function(a){recordUserOperate(openid,a.errMsg,"cctv7-world-card-fail"),H.yao.isCanShake=!0,hidenewLoading()},complete:function(){a.sto&&clearTimeout(a.sto),H.yao.isCanShake=!0,hidenewLoading()},cancel:function(){H.yao.isCanShake=!0,hidenewLoading()}})},update:function(a){var b=this;a&&a.result&&(this.$dialog.find("h2.tt").text(a.tt||""),this.$dialog.find("img.pi").attr("src",a.pi||"").attr("onerror","$(this).addClass('none')"),this.$dialog.find(".award-win").removeClass("none"),b.ci=a.ci,b.ts=a.ts,b.si=a.si)},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="lottery-dialog">')._('<div class="dialog lottery-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="life-yao-lotterydialog-closebtn" data-collect-desc="卡劵抽奖弹层-关闭按钮"></a>')._('<div class="dialog-inner">')._('<div class="award-win none">')._('<h2 class="tt"></h2>')._('<img class="pi" src="" />')._('<img class="wai" src="images/red-wai.png" />')._('<div class="contact">')._('<a href="#" class="btn btn-award" data-collect="true" data-collect-flag="life-yao-lotterydialog-combtn" data-collect-desc="卡劵抽奖弹层-抽奖确认按钮">立即领取</a>')._("</div>")._('<img class="bottom" src="images/red-bottom.png" />')._("</div>")._("</div>")._("</div>")._("</section>"),a.toString()}},swLottery:{$dialog:null,AWARDED_CLS:"lottery-awarded",isFocus:!1,open:function(a){H.yao.canJump=!1;var b=this.$dialog;H.dialog.open.call(this),this.pre_dom(),this.update(a),b||this.event(),this.checkFocus()},pre_dom:function(){var b=a(window).width(),c=a(window).height();a(".dialog").css({width:"295px",height:"350px",left:Math.round((b-295)/2)+"px",top:Math.round((c-350)/2)+"px"})},close:function(){var a=this;this.$dialog.find(".dialog").addClass("bounceOutUp"),setTimeout(function(){H.yao.isCanShake=!0,H.yao.canJump=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},800)},event:function(){var b=this;a(".btn-qd").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close(),b.isFocus&&!is_android()&&toUrl("yao.html")}),a(".btn-close").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close(),b.isFocus&&!is_android()&&toUrl("yao.html")}),this.$dialog.find(".btn-award").click(function(c){if(c.preventDefault(),H.dialog.btn_animate(a(this)),b.check()&&!a(this).hasClass("flag")){a(this).text("领取中"),a(this).addClass("flag"),H.yao.isCanShake=!1;var d=a.trim(b.$dialog.find(".mobile").val()),e=a.trim(b.$dialog.find(".name").val());getResult({url:"api/lottery/award",data:{oi:openid,rn:encodeURIComponent(e),ph:d},loading:!0,jsonpCallback:"callbackLotteryAwardHandler",success:function(a){}}),b.succ()}})},update:function(b){b&&b.result&&(this.$dialog.find("h2.tt").text(b.tt||""),this.$dialog.find("img.pi").attr("src",b.pi||"").attr("onerror","$(this).addClass('none')"),this.$dialog.find(".name").val(b.rn||""),this.$dialog.find(".mobile").val(b.ph||""),a(".rule-section img").attr("src",b.qc),this.$dialog.find(".award-win").removeClass("none"))},check:function(){var b=this,c=b.$dialog.find(".mobile"),d=a.trim(c.val()),e=b.$dialog.find(".name"),f=a.trim(e.val());if(!b.name||b.name!=f||!b.mobile||b.mobile!=phone)return f.length<2||f.length>30?(showTips("姓名长度为2~30个字符"),e.focus(),!1):/^\d{11}$/.test(d)?!0:(showTips("这手机号，可打不通哦..."),c.focus(),!1)},checkFocus:function(){var b=this;a("input").each(function(){a(this).focus(function(){b.isFocus=!0})})},succ:function(){this.$dialog.find(".mobile").attr("type","text");var a="姓名："+this.$dialog.find(".name").val(),b="电话："+this.$dialog.find(".mobile").val(),c="地址："+this.$dialog.find(".address").val();this.$dialog.addClass(this.AWARDED_CLS),this.$dialog.find(".share").removeClass("none"),this.$dialog.find(".name").val(a),this.$dialog.find(".mobile").val(b),this.$dialog.find(".address").val(c),this.$dialog.find("input").attr("disabled","disabled").addClass("disabled"),this.$dialog.find(".award-tip").text("提交成功，以下是您的联系方式。")},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="lottery-dialog">')._('<div class="dialog lottery-dialog sw-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="life-yao-swdialog-closebtn" data-collect-desc="实物抽奖弹层-关闭按钮"></a>')._('<div class="award-win none">')._('<h2 class="tt"></h2>')._('<img class="pi" src="" />')._('<img class="wai" src="images/red-wai.png" />')._('<div class="contact">')._('<h4 class="award-tip">请您填写您的真实信息以便领奖</h4>')._('<p><input type="text" class="name" placeholder="姓名"/></p>')._('<p><input type="tel" class="mobile" placeholder="电话"/></p>')._('<a href="#" class="btn btn-award" data-collect="true" data-collect-flag="life-yao-swdialog-combtn" data-collect-desc="实物抽奖弹层-抽奖确认按钮">立即领取</a>')._('<a href="#" class="btn btn-share btn-qd" data-collect="true" data-collect-flag="life-yao-swdialog-back-btn" data-collect-desc="实物抽奖弹层-返回按钮">返 回</a>')._("</div>")._('<img class="bottom" src="images/red-bottom.png" />')._("</div>")._("</div>")._("</section>"),a.toString()}},redLottery:{$dialog:null,AWARDED_CLS:"lottery-awarded",url:null,open:function(a){H.yao.canJump=!1;var b=this.$dialog;if(H.dialog.open.call(this),this.pre_dom(),this.update(a),!b){this.event()}},pre_dom:function(){var b=a(window).width(),c=a(window).height();a(".dialog").css({width:"295px",height:"240px",left:Math.round((b-295)/2)+"px",top:Math.round((c-240)/2)+"px"})},close:function(){var a=this;this.$dialog.find(".dialog").addClass("bounceOutUp"),setTimeout(function(){H.yao.isCanShake=!0,H.yao.canJump=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},800)},event:function(){var b=this;a(".btn-close").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()}),this.$dialog.find(".btn-award").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),a(this).hasClass("flag")||(a(this).addClass("flag"),H.yao.isCanShake=!1,location.href=b.url)})},update:function(a){var b=this;a&&a.result&&(this.$dialog.find("h2.tt").text(a.tt||""),this.$dialog.find("img.pi").attr("src",a.pi||"").attr("onerror","$(this).addClass('none')"),b.url=a.rp,this.$dialog.find(".award-win").removeClass("none"))},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="red-dialog">')._('<div class="dialog lottery-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="life-yao-reddialog-closebtn" data-collect-desc="红包抽奖弹层-关闭按钮"></a>')._('<div class="award-win none">')._('<h2 class="tt"></h2>')._('<img class="pi" src="" />')._('<img class="wai" src="images/red-wai.png" />')._('<div class="contact">')._('<a href="#" class="btn btn-award" data-collect="true" data-collect-flag="life-yao-lotterydialog-combtn" data-collect-desc="红包抽奖弹层-领取按钮">立即领取</a>')._("</div>")._('<img class="bottom" src="images/red-bottom.png" />')._("</div>")._("</div>")._("</section>"),a.toString()}},jfLottery:{$dialog:null,AWARDED_CLS:"lottery-awarded",open:function(a){H.yao.canJump=!1;var b=this.$dialog;H.dialog.open.call(this),this.pre_dom(),this.update(a),b||this.event()},pre_dom:function(){var b=a(window).width(),c=a(window).height();a(".dialog").css({width:"295px",height:"457px",left:Math.round((b-295)/2)+"px",top:Math.round((c-457)/2)+"px"})},close:function(){var a=this;this.$dialog.find(".dialog").addClass("bounceOutUp"),setTimeout(function(){H.yao.isCanShake=!0,H.yao.canJump=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},800)},event:function(){var b=this;a(".btn-qd").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()}),a(".btn-close").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()}),this.$dialog.find(".btn-award").click(function(c){if(c.preventDefault(),H.dialog.btn_animate(a(this)),b.check()&&!a(this).hasClass("flag")){a(this).text("领取中"),a(this).addClass("flag"),H.yao.isCanShake=!1;var d=a.trim(b.$dialog.find(".mobile").val()),e=a.trim(b.$dialog.find(".name").val()),f=a.trim(b.$dialog.find(".address").val());getResult({url:"api/lottery/award",data:{oi:openid,rn:encodeURIComponent(e),ph:d,ad:encodeURIComponent(f)},loading:!0,jsonpCallback:"callbackLotteryAwardHandler",success:function(a){}}),b.succ()}})},update:function(a){a&&a.result&&(this.$dialog.find("img.pi").attr("src",a.pi||"").attr("onerror","$(this).addClass('none')"),this.$dialog.find(".name").val(a.rn||""),this.$dialog.find(".mobile").val(a.ph||""),this.$dialog.find(".address").val(a.ad||""),this.$dialog.find(".award-win").removeClass("none"))},check:function(){var b=this,c=b.$dialog.find(".mobile"),d=a.trim(c.val()),e=b.$dialog.find(".name"),f=a.trim(e.val()),g=b.$dialog.find(".address"),h=a.trim(g.val());if(!(b.name&&b.name==f&&b.mobile&&b.mobile==phone&&b.address&&b.address==h))return f.length<2||f.length>30?(showTips("姓名长度为2~30个字符"),e.focus(),!1):/^\d{11}$/.test(d)?h.length<5||h.length>60?(showTips("地址长度为5~60个字符"),g.focus(),!1):!0:(showTips("这手机号，可打不通哦..."),c.focus(),!1)},succ:function(){var a=this.$dialog.find(".name").val(),b=this.$dialog.find(".mobile").val(),c=this.$dialog.find(".address").val();this.$dialog.addClass(this.AWARDED_CLS),this.$dialog.find(".name").val(a),this.$dialog.find(".mobile").val(b),this.$dialog.find(".address").val(c),this.$dialog.find("input").attr("disabled","disabled").addClass("disabled")},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="lottery-dialog">')._('<div class="dialog lottery-dialog jf-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="yao-jfdialog-closebtn" data-collect-desc="积分抽奖弹层-关闭按钮"></a>')._('<div class="content">')._('<div class="back">')._('<img class="jf-top" src="images/jf-top.png" />')._('<div class="award-win none">')._('<img class="pi" src="" />')._('<div class="contact">')._('<p><label>姓名:</label><input type="text" class="name"/></p>')._('<p><label>电话:</label><input type="tel" class="mobile" /></p>')._('<p><label>地址:</label><input type="text" class="address" /></p>')._('<a href="#" class="btn btn-award" data-collect="true" data-collect-flag="yao-jfdialog-combtn" data-collect-desc="积分抽奖弹层-提交按钮">提 交</a>')._('<a href="#" class="btn btn-share btn-qd" data-collect="true" data-collect-flag="yao-jfdialog-qd-btn" data-collect-desc="积分抽奖弹层-打开关注二维码按钮">确定</a>')._("</div>")._("</div>")._("</div>")._("</div>")._("</div>")._("</section>"),a.toString()}},wlLottery:{$dialog:null,AWARDED_CLS:"lottery-awarded",url:null,open:function(a){H.yao.canJump=!1;var b=this.$dialog;if(H.dialog.open.call(this),this.pre_dom(),this.update(a),!b){this.event()}},pre_dom:function(){var b=a(window).width(),c=a(window).height();a(".dialog").css({width:"295px",height:"240px",left:Math.round((b-295)/2)+"px",top:Math.round((c-240)/2)+"px"})},close:function(){var a=this;this.$dialog.find(".dialog").addClass("bounceOutUp"),setTimeout(function(){H.yao.isCanShake=!0,H.yao.canJump=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},800)},event:function(){var b=this;a(".btn-qd").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()}),a(".btn-close").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()}),this.$dialog.find(".btn-award").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),a(this).hasClass("flag")||(a(this).addClass("flag"),H.yao.isCanShake=!1,getResult({url:"api/lottery/award",data:{oi:openid,hi:headimgurl,nn:nickname},loading:!0,jsonpCallback:"callbackLotteryAwardHandler",success:function(a){}}),location.href=b.url)})},update:function(a){var b=this;b.pt=a.pt,a&&a.result&&(this.$dialog.find("h2.tt").text(a.tt||""),this.$dialog.find("img.pi").attr("src",a.pi||"").attr("onerror","$(this).addClass('none')"),b.url=a.ru,this.$dialog.find(".award-win").removeClass("none"))},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="red-dialog">')._('<div class="dialog lottery-dialog">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="life-yao-wldialog-closebtn" data-collect-desc="外链抽奖弹层-关闭按钮"></a>')._('<div class="award-win none">')._('<h2 class="tt"></h2>')._('<img class="pi" src="" />')._('<img class="wai" src="images/red-wai.png" />')._('<div class="contact">')._('<a href="#" class="btn btn-award" data-collect="true" data-collect-life="gzj-yao-wldialog-combtn" data-collect-desc="外链抽奖弹层-抽奖确认按钮">立即领取</a>')._("</div>")._('<img class="bottom" src="images/red-bottom.png" />')._("</div>")._("</div>")._("</section>"),a.toString()}},thanks:{$dialog:null,open:function(a){H.yao.canJump=!1,H.dialog.open.call(this),this.event(a),this.pre_dom()},pre_dom:function(){var b=a(window).width(),c=a(window).height();480===W.screen.height?a(".dialog").css({width:"280px",height:"407px",left:Math.round((b-280)/2)+"px",top:Math.round((c-407)/2)+"px"}):a(".dialog").css({width:"295px",height:"429px",left:Math.round((b-295)/2)+"px",top:Math.round((c-429)/2)+"px"})},close:function(){var a=this;this.$dialog.find(".dialog").addClass("bounceOutUp"),setTimeout(function(){H.yao.canJump=!0,H.yao.isCanShake=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},800)},event:function(b){var c=this;a(".btn-close").click(function(b){b.preventDefault(),H.dialog.btn_animate(a(this)),c.close()}),a(".btn-qd").click(function(b){b.preventDefault(),H.dialog.btn_animate(a(this)),c.close()})},tpl:function(){var a=simpleTpl();return a._('<section class="modal modal-thanks" id="thanks-dialog">')._('<div class="dialog thanks-dialog">')._('<a href="#" class="btn-close animated" data-collect="true" data-collect-flag="gzj-yao-thanks-closebtn" data-collect-desc="谢谢参与弹层-关闭按钮"></a>')._('<img class="thanks-top" src="images/thanks-top.png">')._('<img class="thanks-img" src="images/thanks.jpg">')._('<a href="#" class="btn btn-qd" data-collect="true" data-collect-flag="gzj-yao-thanks-btn-award" data-collect-desc="谢谢参与弹层-返回按钮">返 回</a>')._("</div>")._("</section>"),a.toString()},update:function(b){b&&b.pi&&a(".thanks-dialog img").attr("src",b.pi||"./images/thanks.jpg")}},rank:{$dialog:null,open:function(){H.yao.isCanShake=!1,H.dialog.open.call(this),this.pre_dom(),this.event(),a(".dialog").removeClass("bounceOutUp"),setTimeout(function(){a(".dialog").removeClass("none").addClass("bounceInDown")},300),getResult({url:"api/lottery/integral/rank/self",data:{oi:openid,pu:H.dialog.uid},loading:!0,jsonpCallback:"callbackIntegralRankSelfRoundHandler",success:function(b){b.result&&(H.dialog.rank.selfupdate(b),a(".infor").text(H.dialog.wa))}})},pre_dom:function(){var b=a(window).width(),c=a(window).height();480===W.screen.height?a(".dialog").css({width:"230px",height:"377px",left:Math.round((b-230)/2)+"px",top:Math.round((c-377)/2)+"px"}):a(".dialog").css({width:"270px",height:"443px",left:Math.round((b-270)/2)+"px",top:Math.round((c-443)/2)+"px"})},close:function(){var a=this;this.$dialog.find(".dialog").addClass("bounceOutUp"),setTimeout(function(){H.yao.isCanShake=!0,a.$dialog&&a.$dialog.remove(),a.$dialog=null},800)},event:function(){var b=this;this.$dialog.find(".btn-close").click(function(c){c.preventDefault(),H.dialog.btn_animate(a(this)),b.close()})},selfupdate:function(a){this.$dialog.find(".jf").text(a["in"]||0),this.$dialog.find(".pm").text(a.rk||"暂无排名"),getResult({url:"api/lottery/integral/rank/top10",data:{pu:H.dialog.uid},loading:!0,jsonpCallback:"callbackIntegralRankTop10RoundHandler",success:function(a){a.result&&H.dialog.rank.update(a)}})},update:function(a){for(var b=simpleTpl(),c=a.top10||[],d=c.length,e=0;d>e;e++)b._("<li>")._('<span class="r-avatar"><img src="'+(c[e].hi?c[e].hi+"/0":"./images/avatar.png")+'" /></span>')._('<span class="r-nn">'+(c[e].nn||"匿名用户")+"</span>")._('<span class="r-rank"><span class="jf-num"><img src="images/money.png"></span>'+(c[e]["in"]||" ")+"</span>")._('<span class="r-name">第<span class="jf-num">'+(c[e].rk||"-")+"</span>名</span>")._("</li>");this.$dialog.find("ul").html(b.toString())},tpl:function(){var a=simpleTpl();return a._('<section class="modal" id="rank-dialog">')._('<div class="dialog rank-dialog animated none">')._('<a href="#" class="btn-close" data-collect="true" data-collect-flag="yao-rank-closebtn" data-collect-desc="积分排行榜弹层-关闭按钮"></a>')._('<div class="rank-top">')._('<img src="images/rank-t.png" />')._('<label class="infor">积分排行顶部文案</label>')._('<h3>我的积分：<span class="jf"></span> 排名：<span class="pm"></span></h3>')._("</div>")._('<div class="list border">')._('<div class="content">')._("<ul></ul>")._("</div>")._("</div>")._("</div>")._("</section>"),a.toString()}}}}(Zepto),$(function(){H.dialog.init()});